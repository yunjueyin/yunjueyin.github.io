<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="no">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>三格记录本</title>
    <!-- 引入本地html2canvas库用于将记录纸导出为图片 -->
    <script>/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */
!function(A,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(A="undefined"!=typeof globalThis?globalThis:A||self).html2canvas=e()}(this,function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var r=function(A,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,e){A.__proto__=e}||function(A,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(A[t]=e[t])})(A,e)};function A(A,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=A}r(A,e),A.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}var h=function(){return(h=Object.assign||function(A){for(var e,t=1,r=arguments.length;t<r;t++)for(var B in e=arguments[t])Object.prototype.hasOwnProperty.call(e,B)&&(A[B]=e[B]);return A}).apply(this,arguments)};function a(A,s,o,i){return new(o=o||Promise)(function(t,e){function r(A){try{n(i.next(A))}catch(A){e(A)}}function B(A){try{n(i.throw(A))}catch(A){e(A)}}function n(A){var e;A.done?t(A.value):((e=A.value)instanceof o?e:new o(function(A){A(e)})).then(r,B)}n((i=i.apply(A,s||[])).next())})}function H(t,r){var B,n,s,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},A={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(A[Symbol.iterator]=function(){return this}),A;function e(e){return function(A){return function(e){if(B)throw new TypeError("Generator is already executing.");for(;o;)try{if(B=1,n&&(s=2&e[0]?n.return:e[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,e[1])).done)return s;switch(n=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return o.label++,{value:e[1],done:!1};case 5:o.label++,n=e[1],e=[0];continue;case 7:e=o.ops.pop(),o.trys.pop();continue;default:if(!(s=0<(s=o.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){o=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){o.label=e[1];break}if(6===e[0]&&o.label<s[1]){o.label=s[1],s=e;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(e);break}s[2]&&o.ops.pop(),o.trys.pop();continue}e=r.call(t,o)}catch(A){e=[6,A],n=0}finally{B=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,A])}}}function t(A,e,t){if(t||2===arguments.length)for(var r,B=0,n=e.length;B<n;B++)!r&&B in e||((r=r||Array.prototype.slice.call(e,0,B))[B]=e[B]);return A.concat(r||e)}var d=(B.prototype.add=function(A,e,t,r){return new B(this.left+A,this.top+e,this.width+t,this.height+r)},B.fromClientRect=function(A,e){return new B(e.left+A.windowBounds.left,e.top+A.windowBounds.top,e.width,e.height)},B.fromDOMRectList=function(A,e){e=Array.from(e).find(function(A){return 0!==A.width});return e?new B(e.left+A.windowBounds.left,e.top+A.windowBounds.top,e.width,e.height):B.EMPTY},B.EMPTY=new B(0,0,0,0),B);function B(A,e,t,r){this.left=A,this.top=e,this.width=t,this.height=r}for(var f=function(A,e){return d.fromClientRect(A,e.getBoundingClientRect())},Q=function(A){for(var e=[],t=0,r=A.length;t<r;){var B,n=A.charCodeAt(t++);55296<=n&&n<=56319&&t<r?56320==(64512&(B=A.charCodeAt(t++)))?e.push(((1023&n)<<10)+(1023&B)+65536):(e.push(n),t--):e.push(n)}return e},g=function(){for(var A=[],e=0;e<arguments.length;e++)A[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,A);var t=A.length;if(!t)return"";for(var r=[],B=-1,n="";++B<t;){var s=A[B];s<=65535?r.push(s):(s-=65536,r.push(55296+(s>>10),s%1024+56320)),(B+1===t||16384<r.length)&&(n+=String.fromCharCode.apply(String,r),r.length=0)}return n},e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="undefined"==typeof Uint8Array?[]:new Uint8Array(256),s=0;s<e.length;s++)n[e.charCodeAt(s)]=s;for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i=0;i<o.length;i++)c[o.charCodeAt(i)]=i;function w(A,e,t){return A.slice?A.slice(e,t):new Uint16Array(Array.prototype.slice.call(A,e,t))}var U=(l.prototype.get=function(A){var e;if(0<=A){if(A<55296||56319<A&&A<=65535)return e=this.index[A>>5],this.data[e=(e<<2)+(31&A)];if(A<=65535)return e=this.index[2048+(A-55296>>5)],this.data[e=(e<<2)+(31&A)];if(A<this.highStart)return e=this.index[e=2080+(A>>11)],e=this.index[e+=A>>5&63],this.data[e=(e<<2)+(31&A)];if(A<=1114111)return this.data[this.highValueIndex]}return this.errorValue},l);function l(A,e,t,r,B,n){this.initialValue=A,this.errorValue=e,this.highStart=t,this.highValueIndex=r,this.index=B,this.data=n}for(var C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u="undefined"==typeof Uint8Array?[]:new Uint8Array(256),F=0;F<C.length;F++)u[C.charCodeAt(F)]=F;function p(A,e,t,r){var B=r[t];if(Array.isArray(A)?-1!==A.indexOf(B):A===B)for(var n=t;n<=r.length;){if((o=r[++n])===e)return 1;if(o!==D)break}if(B===D)for(n=t;0<n;){var s=r[--n];if(Array.isArray(A)?-1!==A.indexOf(s):A===s)for(var o,i=t;i<=r.length;){if((o=r[++i])===e)return 1;if(o!==D)break}if(s!==D)break}}function E(A,e){for(var t=A;0<=t;){var r=e[t];if(r!==D)return r;t--}return 0}function I(t,A){var e=(B=function(A,r){void 0===r&&(r="strict");var B=[],n=[],s=[];return A.forEach(function(A,e){var t=rA.get(A);if(50<t?(s.push(!0),t-=50):s.push(!1),-1!==["normal","auto","loose"].indexOf(r)&&-1!==[8208,8211,12316,12448].indexOf(A))return n.push(e),B.push(16);if(4!==t&&11!==t)return n.push(e),31===t?B.push("strict"===r?O:q):t===AA||29===t?B.push(J):43===t?131072<=A&&A<=196605||196608<=A&&A<=262141?B.push(q):B.push(J):void B.push(t);if(0===e)return n.push(e),B.push(J);t=B[e-1];return-1===iA.indexOf(t)?(n.push(n[e-1]),B.push(t)):(n.push(e),B.push(J))}),[n,B,s]}(t,(A=A||{lineBreak:"normal",wordBreak:"normal"}).lineBreak))[0],r=B[1],B=B[2];return[e,r="break-all"===A.wordBreak||"break-word"===A.wordBreak?r.map(function(A){return-1!==[R,J,AA].indexOf(A)?q:A}):r,"keep-all"===A.wordBreak?B.map(function(A,e){return A&&19968<=t[e]&&t[e]<=40959}):void 0]}var y,K,m,L,b,D=10,v=13,x=15,M=17,S=18,T=19,G=20,O=21,V=22,k=24,R=25,N=26,P=27,X=28,J=30,Y=32,W=33,Z=34,_=35,q=37,j=38,z=39,$=40,AA=42,eA=[9001,65288],tA="×",rA=(m=function(A){var e,t,r,B,n=.75*A.length,s=A.length,o=0;"="===A[A.length-1]&&(n--,"="===A[A.length-2]&&n--);for(var n=new("undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?ArrayBuffer:Array)(n),i=Array.isArray(n)?n:new Uint8Array(n),Q=0;Q<s;Q+=4)e=c[A.charCodeAt(Q)],t=c[A.charCodeAt(Q+1)],r=c[A.charCodeAt(Q+2)],B=c[A.charCodeAt(Q+3)],i[o++]=e<<2|t>>4,i[o++]=(15&t)<<4|r>>2,i[o++]=(3&r)<<6|63&B;return n}(y="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),L=Array.isArray(m)?function(A){for(var e=A.length,t=[],r=0;r<e;r+=4)t.push(A[r+3]<<24|A[r+2]<<16|A[r+1]<<8|A[r]);return t}(m):new Uint32Array(m),b=Array.isArray(m)?function(A){for(var e=A.length,t=[],r=0;r<e;r+=2)t.push(A[r+1]<<8|A[r]);return t}(m):new Uint16Array(m),y=w(b,12,L[4]/2),K=2===L[5]?w(b,(24+L[4])/2):(m=L,b=Math.ceil((24+L[4])/4),m.slice?m.slice(b,K):new Uint32Array(Array.prototype.slice.call(m,b,K))),new U(L[0],L[1],L[2],L[3],y,K)),BA=[J,36],nA=[1,2,3,5],sA=[D,8],oA=[P,N],iA=nA.concat(sA),QA=[j,z,$,Z,_],cA=[x,v],aA=(gA.prototype.slice=function(){return g.apply(void 0,this.codePoints.slice(this.start,this.end))},gA);function gA(A,e,t,r){this.codePoints=A,this.required="!"===e,this.start=t,this.end=r}function wA(A,e){var t=Q(A),r=(e=I(t,e))[0],B=e[1],n=e[2],s=t.length,o=0,i=0;return{next:function(){if(s<=i)return{done:!0,value:null};for(var A=tA;i<s&&(A=function(A,e,t,r,B){if(0===t[r])return tA;var n=r-1;if(Array.isArray(B)&&!0===B[n])return tA;var s=n-1,o=1+n,i=e[n],r=0<=s?e[s]:0,B=e[o];if(2===i&&3===B)return tA;if(-1!==nA.indexOf(i))return"!";if(-1!==nA.indexOf(B))return tA;if(-1!==sA.indexOf(B))return tA;if(8===E(n,e))return"÷";if(11===rA.get(A[n]))return tA;if((i===Y||i===W)&&11===rA.get(A[o]))return tA;if(7===i||7===B)return tA;if(9===i)return tA;if(-1===[D,v,x].indexOf(i)&&9===B)return tA;if(-1!==[M,S,T,k,X].indexOf(B))return tA;if(E(n,e)===V)return tA;if(p(23,V,n,e))return tA;if(p([M,S],O,n,e))return tA;if(p(12,12,n,e))return tA;if(i===D)return"÷";if(23===i||23===B)return tA;if(16===B||16===i)return"÷";if(-1!==[v,x,O].indexOf(B)||14===i)return tA;if(36===r&&-1!==cA.indexOf(i))return tA;if(i===X&&36===B)return tA;if(B===G)return tA;if(-1!==BA.indexOf(B)&&i===R||-1!==BA.indexOf(i)&&B===R)return tA;if(i===P&&-1!==[q,Y,W].indexOf(B)||-1!==[q,Y,W].indexOf(i)&&B===N)return tA;if(-1!==BA.indexOf(i)&&-1!==oA.indexOf(B)||-1!==oA.indexOf(i)&&-1!==BA.indexOf(B))return tA;if(-1!==[P,N].indexOf(i)&&(B===R||-1!==[V,x].indexOf(B)&&e[1+o]===R)||-1!==[V,x].indexOf(i)&&B===R||i===R&&-1!==[R,X,k].indexOf(B))return tA;if(-1!==[R,X,k,M,S].indexOf(B))for(var Q=n;0<=Q;){if((c=e[Q])===R)return tA;if(-1===[X,k].indexOf(c))break;Q--}if(-1!==[P,N].indexOf(B))for(var c,Q=-1!==[M,S].indexOf(i)?s:n;0<=Q;){if((c=e[Q])===R)return tA;if(-1===[X,k].indexOf(c))break;Q--}if(j===i&&-1!==[j,z,Z,_].indexOf(B)||-1!==[z,Z].indexOf(i)&&-1!==[z,$].indexOf(B)||-1!==[$,_].indexOf(i)&&B===$)return tA;if(-1!==QA.indexOf(i)&&-1!==[G,N].indexOf(B)||-1!==QA.indexOf(B)&&i===P)return tA;if(-1!==BA.indexOf(i)&&-1!==BA.indexOf(B))return tA;if(i===k&&-1!==BA.indexOf(B))return tA;if(-1!==BA.concat(R).indexOf(i)&&B===V&&-1===eA.indexOf(A[o])||-1!==BA.concat(R).indexOf(B)&&i===S)return tA;if(41===i&&41===B){for(var a=t[n],g=1;0<a&&41===e[--a];)g++;if(g%2!=0)return tA}return i===Y&&B===W?tA:"÷"}(t,B,r,++i,n))===tA;);if(A===tA&&i!==s)return{done:!0,value:null};var e=new aA(t,A,o,i);return o=i,{value:e,done:!1}}}}function UA(A){return 48<=A&&A<=57}function lA(A){return UA(A)||65<=A&&A<=70||97<=A&&A<=102}function CA(A){return 10===A||9===A||32===A}function uA(A){return 97<=(t=e=A)&&t<=122||65<=(e=e)&&e<=90||128<=A||95===A;var e,t}function FA(A){return uA(A)||UA(A)||45===A}function hA(A,e){return 92===A&&10!==e}function dA(A,e,t){return 45===A?uA(e)||hA(e,t):!!uA(A)||92===A&&10!==e}function fA(A,e,t){return 43===A||45===A?!!UA(e)||46===e&&UA(t):UA(46===A?e:A)}var HA={type:2},pA={type:3},EA={type:4},IA={type:13},yA={type:8},KA={type:21},mA={type:9},LA={type:10},bA={type:11},DA={type:12},vA={type:14},xA={type:23},MA={type:1},SA={type:25},TA={type:24},GA={type:26},OA={type:27},VA={type:28},kA={type:29},RA={type:31},NA={type:32},PA=(XA.prototype.write=function(A){this._value=this._value.concat(Q(A))},XA.prototype.read=function(){for(var A=[],e=this.consumeToken();e!==NA;)A.push(e),e=this.consumeToken();return A},XA.prototype.consumeToken=function(){var A=this.consumeCodePoint();switch(A){case 34:return this.consumeStringToken(34);case 35:var e=this.peekCodePoint(0),t=this.peekCodePoint(1),r=this.peekCodePoint(2);if(FA(e)||hA(t,r)){var B=dA(e,t,r)?2:1;return{type:5,value:this.consumeName(),flags:B}}break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),IA;break;case 39:return this.consumeStringToken(39);case 40:return HA;case 41:return pA;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),vA;break;case 43:if(fA(A,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(A),this.consumeNumericToken();break;case 44:return EA;case 45:var r=A,B=this.peekCodePoint(0),n=this.peekCodePoint(1);if(fA(r,B,n))return this.reconsumeCodePoint(A),this.consumeNumericToken();if(dA(r,B,n))return this.reconsumeCodePoint(A),this.consumeIdentLikeToken();if(45===B&&62===n)return this.consumeCodePoint(),this.consumeCodePoint(),TA;break;case 46:if(fA(A,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(A),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;){var s=this.consumeCodePoint();if(42===s&&47===(s=this.consumeCodePoint()))return this.consumeToken();if(-1===s)return this.consumeToken()}break;case 58:return GA;case 59:return OA;case 60:if(33===this.peekCodePoint(0)&&45===this.peekCodePoint(1)&&45===this.peekCodePoint(2))return this.consumeCodePoint(),this.consumeCodePoint(),SA;break;case 64:var n=this.peekCodePoint(0),o=this.peekCodePoint(1),i=this.peekCodePoint(2);if(dA(n,o,i))return{type:7,value:this.consumeName()};break;case 91:return VA;case 92:if(hA(A,this.peekCodePoint(0)))return this.reconsumeCodePoint(A),this.consumeIdentLikeToken();break;case 93:return kA;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),yA;break;case 123:return bA;case 125:return DA;case 117:case 85:o=this.peekCodePoint(0),i=this.peekCodePoint(1);return 43!==o||!lA(i)&&63!==i||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(A),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),mA;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),KA;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),LA;break;case-1:return NA}return CA(A)?(this.consumeWhiteSpace(),RA):UA(A)?(this.reconsumeCodePoint(A),this.consumeNumericToken()):uA(A)?(this.reconsumeCodePoint(A),this.consumeIdentLikeToken()):{type:6,value:g(A)}},XA.prototype.consumeCodePoint=function(){var A=this._value.shift();return void 0===A?-1:A},XA.prototype.reconsumeCodePoint=function(A){this._value.unshift(A)},XA.prototype.peekCodePoint=function(A){return A>=this._value.length?-1:this._value[A]},XA.prototype.consumeUnicodeRangeToken=function(){for(var A=[],e=this.consumeCodePoint();lA(e)&&A.length<6;)A.push(e),e=this.consumeCodePoint();for(var t=!1;63===e&&A.length<6;)A.push(e),e=this.consumeCodePoint(),t=!0;if(t)return{type:30,start:parseInt(g.apply(void 0,A.map(function(A){return 63===A?48:A})),16),end:parseInt(g.apply(void 0,A.map(function(A){return 63===A?70:A})),16)};var r=parseInt(g.apply(void 0,A),16);if(45===this.peekCodePoint(0)&&lA(this.peekCodePoint(1))){this.consumeCodePoint();for(var e=this.consumeCodePoint(),B=[];lA(e)&&B.length<6;)B.push(e),e=this.consumeCodePoint();return{type:30,start:r,end:parseInt(g.apply(void 0,B),16)}}return{type:30,start:r,end:r}},XA.prototype.consumeIdentLikeToken=function(){var A=this.consumeName();return"url"===A.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:19,value:A}):{type:20,value:A}},XA.prototype.consumeUrlToken=function(){var A=[];if(this.consumeWhiteSpace(),-1===this.peekCodePoint(0))return{type:22,value:""};var e,t=this.peekCodePoint(0);if(39===t||34===t){t=this.consumeStringToken(this.consumeCodePoint());return 0===t.type&&(this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:22,value:t.value}):(this.consumeBadUrlRemnants(),xA)}for(;;){var r=this.consumeCodePoint();if(-1===r||41===r)return{type:22,value:g.apply(void 0,A)};if(CA(r))return this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:22,value:g.apply(void 0,A)}):(this.consumeBadUrlRemnants(),xA);if(34===r||39===r||40===r||(0<=(e=r)&&e<=8||11===e||14<=e&&e<=31||127===e))return this.consumeBadUrlRemnants(),xA;if(92===r){if(!hA(r,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),xA;A.push(this.consumeEscapedCodePoint())}else A.push(r)}},XA.prototype.consumeWhiteSpace=function(){for(;CA(this.peekCodePoint(0));)this.consumeCodePoint()},XA.prototype.consumeBadUrlRemnants=function(){for(;;){var A=this.consumeCodePoint();if(41===A||-1===A)return;hA(A,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},XA.prototype.consumeStringSlice=function(A){for(var e="";0<A;){var t=Math.min(5e4,A);e+=g.apply(void 0,this._value.splice(0,t)),A-=t}return this._value.shift(),e},XA.prototype.consumeStringToken=function(A){for(var e="",t=0;;){var r,B=this._value[t];if(-1===B||void 0===B||B===A)return{type:0,value:e+=this.consumeStringSlice(t)};if(10===B)return this._value.splice(0,t),MA;92!==B||-1!==(r=this._value[t+1])&&void 0!==r&&(10===r?(e+=this.consumeStringSlice(t),t=-1,this._value.shift()):hA(B,r)&&(e+=this.consumeStringSlice(t),e+=g(this.consumeEscapedCodePoint()),t=-1)),t++}},XA.prototype.consumeNumber=function(){var A=[],e=4;for(43!==(t=this.peekCodePoint(0))&&45!==t||A.push(this.consumeCodePoint());UA(this.peekCodePoint(0));)A.push(this.consumeCodePoint());var t=this.peekCodePoint(0),r=this.peekCodePoint(1);if(46===t&&UA(r))for(A.push(this.consumeCodePoint(),this.consumeCodePoint()),e=8;UA(this.peekCodePoint(0));)A.push(this.consumeCodePoint());t=this.peekCodePoint(0);var r=this.peekCodePoint(1),B=this.peekCodePoint(2);if((69===t||101===t)&&((43===r||45===r)&&UA(B)||UA(r)))for(A.push(this.consumeCodePoint(),this.consumeCodePoint()),e=8;UA(this.peekCodePoint(0));)A.push(this.consumeCodePoint());return[function(A){var e=0,t=1;43!==A[e]&&45!==A[e]||(45===A[e]&&(t=-1),e++);for(var r=[];UA(A[e]);)r.push(A[e++]);var B=r.length?parseInt(g.apply(void 0,r),10):0;46===A[e]&&e++;for(var n=[];UA(A[e]);)n.push(A[e++]);var s=n.length,o=s?parseInt(g.apply(void 0,n),10):0;69!==A[e]&&101!==A[e]||e++;var i=1;43!==A[e]&&45!==A[e]||(45===A[e]&&(i=-1),e++);for(var Q=[];UA(A[e]);)Q.push(A[e++]);var c=Q.length?parseInt(g.apply(void 0,Q),10):0;return t*(B+o*Math.pow(10,-s))*Math.pow(10,i*c)}(A),e]},XA.prototype.consumeNumericToken=function(){var A=this.consumeNumber(),e=A[0],t=A[1],r=this.peekCodePoint(0),B=this.peekCodePoint(1),A=this.peekCodePoint(2);return dA(r,B,A)?{type:15,number:e,flags:t,unit:this.consumeName()}:37===r?(this.consumeCodePoint(),{type:16,number:e,flags:t}):{type:17,number:e,flags:t}},XA.prototype.consumeEscapedCodePoint=function(){var A,e=this.consumeCodePoint();if(lA(e)){for(var t=g(e);lA(this.peekCodePoint(0))&&t.length<6;)t+=g(this.consumeCodePoint());CA(this.peekCodePoint(0))&&this.consumeCodePoint();var r=parseInt(t,16);return 0===r||55296<=(A=r)&&A<=57343||1114111<r?65533:r}return-1===e?65533:e},XA.prototype.consumeName=function(){for(var A="";;){var e=this.consumeCodePoint();if(FA(e))A+=g(e);else{if(!hA(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),A;A+=g(this.consumeEscapedCodePoint())}}},XA);function XA(){this._value=[]}var JA=(YA.create=function(A){var e=new PA;return e.write(A),new YA(e.read())},YA.parseValue=function(A){return YA.create(A).parseComponentValue()},YA.parseValues=function(A){return YA.create(A).parseComponentValues()},YA.prototype.parseComponentValue=function(){for(var A=this.consumeToken();31===A.type;)A=this.consumeToken();if(32===A.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(A);for(var e=this.consumeComponentValue();31===(A=this.consumeToken()).type;);if(32===A.type)return e;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},YA.prototype.parseComponentValues=function(){for(var A=[];;){var e=this.consumeComponentValue();if(32===e.type)return A;A.push(e),A.push()}},YA.prototype.consumeComponentValue=function(){var A=this.consumeToken();switch(A.type){case 11:case 28:case 2:return this.consumeSimpleBlock(A.type);case 19:return this.consumeFunction(A)}return A},YA.prototype.consumeSimpleBlock=function(A){for(var e={type:A,values:[]},t=this.consumeToken();;){if(32===t.type||ce(t,A))return e;this.reconsumeToken(t),e.values.push(this.consumeComponentValue()),t=this.consumeToken()}},YA.prototype.consumeFunction=function(A){for(var e={name:A.value,values:[],type:18};;){var t=this.consumeToken();if(32===t.type||3===t.type)return e;this.reconsumeToken(t),e.values.push(this.consumeComponentValue())}},YA.prototype.consumeToken=function(){var A=this._tokens.shift();return void 0===A?NA:A},YA.prototype.reconsumeToken=function(A){this._tokens.unshift(A)},YA);function YA(A){this._tokens=A}function WA(A){return 15===A.type}function ZA(A){return 17===A.type}function _A(A){return 20===A.type}function qA(A){return 0===A.type}function jA(A,e){return _A(A)&&A.value===e}function zA(A){return 31!==A.type}function $A(A){return 31!==A.type&&4!==A.type}function Ae(A){var e=[],t=[];return A.forEach(function(A){if(4===A.type){if(0===t.length)throw new Error("Error parsing function args, zero tokens for arg");return e.push(t),void(t=[])}31!==A.type&&t.push(A)}),t.length&&e.push(t),e}function ee(A){return 17===A.type||15===A.type}function te(A){return 16===A.type||ee(A)}function re(A){return 1<A.length?[A[0],A[1]]:[A[0]]}function Be(A,e,t){var r=A[0],A=A[1];return[Ue(r,e),Ue(void 0!==A?A:r,t)]}function ne(A){return 15===A.type&&("deg"===A.unit||"grad"===A.unit||"rad"===A.unit||"turn"===A.unit)}function se(A){switch(A.filter(_A).map(function(A){return A.value}).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[ae,ae];case"to top":case"bottom":return Ce(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[ae,we];case"to right":case"left":return Ce(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[we,we];case"to bottom":case"top":return Ce(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[we,ae];case"to left":case"right":return Ce(270)}return 0}function oe(A){return 0==(255&A)}function ie(A){var e=255&A,t=255&A>>8,r=255&A>>16,A=255&A>>24;return e<255?"rgba("+A+","+r+","+t+","+e/255+")":"rgb("+A+","+r+","+t+")"}function Qe(A,e){if(17===A.type)return A.number;if(16!==A.type)return 0;var t=3===e?1:255;return 3===e?A.number/100*t:Math.round(A.number/100*t)}var ce=function(A,e){return 11===e&&12===A.type||(28===e&&29===A.type||2===e&&3===A.type)},ae={type:17,number:0,flags:4},ge={type:16,number:50,flags:4},we={type:16,number:100,flags:4},Ue=function(A,e){if(16===A.type)return A.number/100*e;if(WA(A))switch(A.unit){case"rem":case"em":return 16*A.number;default:return A.number}return A.number},le=function(A,e){if(15===e.type)switch(e.unit){case"deg":return Math.PI*e.number/180;case"grad":return Math.PI/200*e.number;case"rad":return e.number;case"turn":return 2*Math.PI*e.number}throw new Error("Unsupported angle type")},Ce=function(A){return Math.PI*A/180},ue=function(A,e){if(18===e.type){var t=me[e.name];if(void 0===t)throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return t(A,e.values)}if(5===e.type){if(3===e.value.length){var r=e.value.substring(0,1),B=e.value.substring(1,2),n=e.value.substring(2,3);return Fe(parseInt(r+r,16),parseInt(B+B,16),parseInt(n+n,16),1)}if(4===e.value.length){var r=e.value.substring(0,1),B=e.value.substring(1,2),n=e.value.substring(2,3),s=e.value.substring(3,4);return Fe(parseInt(r+r,16),parseInt(B+B,16),parseInt(n+n,16),parseInt(s+s,16)/255)}if(6===e.value.length){r=e.value.substring(0,2),B=e.value.substring(2,4),n=e.value.substring(4,6);return Fe(parseInt(r,16),parseInt(B,16),parseInt(n,16),1)}if(8===e.value.length){r=e.value.substring(0,2),B=e.value.substring(2,4),n=e.value.substring(4,6),s=e.value.substring(6,8);return Fe(parseInt(r,16),parseInt(B,16),parseInt(n,16),parseInt(s,16)/255)}}if(20===e.type){e=Le[e.value.toUpperCase()];if(void 0!==e)return e}return Le.TRANSPARENT},Fe=function(A,e,t,r){return(A<<24|e<<16|t<<8|Math.round(255*r)<<0)>>>0},he=function(A,e){e=e.filter($A);if(3===e.length){var t=e.map(Qe),r=t[0],B=t[1],t=t[2];return Fe(r,B,t,1)}if(4!==e.length)return 0;e=e.map(Qe),r=e[0],B=e[1],t=e[2],e=e[3];return Fe(r,B,t,e)};function de(A,e,t){return t<0&&(t+=1),1<=t&&--t,t<1/6?(e-A)*t*6+A:t<.5?e:t<2/3?6*(e-A)*(2/3-t)+A:A}function fe(A,e){return ue(A,JA.create(e).parseComponentValue())}function He(A,e){return A=ue(A,e[0]),(e=e[1])&&te(e)?{color:A,stop:e}:{color:A,stop:null}}function pe(A,t){var e=A[0],r=A[A.length-1];null===e.stop&&(e.stop=ae),null===r.stop&&(r.stop=we);for(var B=[],n=0,s=0;s<A.length;s++){var o=A[s].stop;null!==o?(n<(o=Ue(o,t))?B.push(o):B.push(n),n=o):B.push(null)}for(var i=null,s=0;s<B.length;s++){var Q=B[s];if(null===Q)null===i&&(i=s);else if(null!==i){for(var c=s-i,a=(Q-B[i-1])/(1+c),g=1;g<=c;g++)B[i+g-1]=a*g;i=null}}return A.map(function(A,e){return{color:A.color,stop:Math.max(Math.min(1,B[e]/t),0)}})}function Ee(A,e,t){var r="number"==typeof A?A:(s=e/2,r=(n=t)/2,s=Ue((B=A)[0],e)-s,n=r-Ue(B[1],n),(Math.atan2(n,s)+2*Math.PI)%(2*Math.PI)),B=Math.abs(e*Math.sin(r))+Math.abs(t*Math.cos(r)),n=e/2,s=t/2,e=B/2,t=Math.sin(r-Math.PI/2)*e,e=Math.cos(r-Math.PI/2)*e;return[B,n-e,n+e,s-t,s+t]}function Ie(A,e){return Math.sqrt(A*A+e*e)}function ye(A,e,B,n,s){return[[0,0],[0,e],[A,0],[A,e]].reduce(function(A,e){var t=e[0],r=e[1],r=Ie(B-t,n-r);return(s?r<A.optimumDistance:r>A.optimumDistance)?{optimumCorner:e,optimumDistance:r}:A},{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner}var Ke=function(A,e){var t=e.filter($A),r=t[0],B=t[1],n=t[2],e=t[3],t=(17===r.type?Ce(r.number):le(A,r))/(2*Math.PI),A=te(B)?B.number/100:0,r=te(n)?n.number/100:0,B=void 0!==e&&te(e)?Ue(e,1):1;if(0==A)return Fe(255*r,255*r,255*r,1);n=r<=.5?r*(1+A):r+A-r*A,e=2*r-n,A=de(e,n,t+1/3),r=de(e,n,t),t=de(e,n,t-1/3);return Fe(255*A,255*r,255*t,B)},me={hsl:Ke,hsla:Ke,rgb:he,rgba:he},Le={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},be={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(A,e){return e.map(function(A){if(_A(A))switch(A.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},De={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Ke=function(t,A){var r=Ce(180),B=[];return Ae(A).forEach(function(A,e){if(0===e){e=A[0];if(20===e.type&&-1!==["top","left","right","bottom"].indexOf(e.value))return void(r=se(A));if(ne(e))return void(r=(le(t,e)+Ce(270))%Ce(360))}A=He(t,A);B.push(A)}),{angle:r,stops:B,type:1}},ve="closest-side",xe="farthest-side",Me="closest-corner",Se="farthest-corner",Te="ellipse",Ge="contain",he=function(r,A){var B=0,n=3,s=[],o=[];return Ae(A).forEach(function(A,e){var t=!0;0===e?t=A.reduce(function(A,e){if(_A(e))switch(e.value){case"center":return o.push(ge),!1;case"top":case"left":return o.push(ae),!1;case"right":case"bottom":return o.push(we),!1}else if(te(e)||ee(e))return o.push(e),!1;return A},t):1===e&&(t=A.reduce(function(A,e){if(_A(e))switch(e.value){case"circle":return B=0,!1;case Te:return!(B=1);case Ge:case ve:return n=0,!1;case xe:return!(n=1);case Me:return!(n=2);case"cover":case Se:return!(n=3)}else if(ee(e)||te(e))return(n=!Array.isArray(n)?[]:n).push(e),!1;return A},t)),t&&(A=He(r,A),s.push(A))}),{size:n,shape:B,stops:s,position:o,type:2}},Oe=function(A,e){if(22===e.type){var t={url:e.value,type:0};return A.cache.addImage(e.value),t}if(18!==e.type)throw new Error("Unsupported image type "+e.type);t=ke[e.name];if(void 0===t)throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return t(A,e.values)};var Ve,ke={"linear-gradient":function(t,A){var r=Ce(180),B=[];return Ae(A).forEach(function(A,e){if(0===e){e=A[0];if(20===e.type&&"to"===e.value)return void(r=se(A));if(ne(e))return void(r=le(t,e))}A=He(t,A);B.push(A)}),{angle:r,stops:B,type:1}},"-moz-linear-gradient":Ke,"-ms-linear-gradient":Ke,"-o-linear-gradient":Ke,"-webkit-linear-gradient":Ke,"radial-gradient":function(B,A){var n=0,s=3,o=[],i=[];return Ae(A).forEach(function(A,e){var t,r=!0;0===e&&(t=!1,r=A.reduce(function(A,e){if(t)if(_A(e))switch(e.value){case"center":return i.push(ge),A;case"top":case"left":return i.push(ae),A;case"right":case"bottom":return i.push(we),A}else(te(e)||ee(e))&&i.push(e);else if(_A(e))switch(e.value){case"circle":return n=0,!1;case Te:return!(n=1);case"at":return!(t=!0);case ve:return s=0,!1;case"cover":case xe:return!(s=1);case Ge:case Me:return!(s=2);case Se:return!(s=3)}else if(ee(e)||te(e))return(s=!Array.isArray(s)?[]:s).push(e),!1;return A},r)),r&&(A=He(B,A),o.push(A))}),{size:s,shape:n,stops:o,position:i,type:2}},"-moz-radial-gradient":he,"-ms-radial-gradient":he,"-o-radial-gradient":he,"-webkit-radial-gradient":he,"-webkit-gradient":function(r,A){var e=Ce(180),B=[],n=1;return Ae(A).forEach(function(A,e){var t,A=A[0];if(0===e){if(_A(A)&&"linear"===A.value)return void(n=1);if(_A(A)&&"radial"===A.value)return void(n=2)}18===A.type&&("from"===A.name?(t=ue(r,A.values[0]),B.push({stop:ae,color:t})):"to"===A.name?(t=ue(r,A.values[0]),B.push({stop:we,color:t})):"color-stop"!==A.name||2===(A=A.values.filter($A)).length&&(t=ue(r,A[1]),A=A[0],ZA(A)&&B.push({stop:{type:16,number:100*A.number,flags:A.flags},color:t})))}),1===n?{angle:(e+Ce(180))%Ce(360),stops:B,type:n}:{size:3,shape:0,stops:B,position:[],type:n}}},Re={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,A){if(0===A.length)return[];var t=A[0];return 20===t.type&&"none"===t.value?[]:A.filter(function(A){return $A(A)&&!(20===(A=A).type&&"none"===A.value||18===A.type&&!ke[A.name])}).map(function(A){return Oe(e,A)})}},Ne={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(A,e){return e.map(function(A){if(_A(A))switch(A.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Pe={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(A,e){return Ae(e).map(function(A){return A.filter(te)}).map(re)}},Xe={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(A,e){return Ae(e).map(function(A){return A.filter(_A).map(function(A){return A.value}).join(" ")}).map(Je)}},Je=function(A){switch(A){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}};(he=Ve=Ve||{}).AUTO="auto",he.CONTAIN="contain";function Ye(A,e){return _A(A)&&"normal"===A.value?1.2*e:17===A.type?e*A.number:te(A)?Ue(A,e):e}var We,Ze,_e={name:"background-size",initialValue:"0",prefix:!(he.COVER="cover"),type:1,parse:function(A,e){return Ae(e).map(function(A){return A.filter(qe)})}},qe=function(A){return _A(A)||te(A)},he=function(A){return{name:"border-"+A+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},je=he("top"),ze=he("right"),$e=he("bottom"),At=he("left"),he=function(A){return{name:"border-radius-"+A,initialValue:"0 0",prefix:!1,type:1,parse:function(A,e){return re(e.filter(te))}}},et=he("top-left"),tt=he("top-right"),rt=he("bottom-right"),Bt=he("bottom-left"),he=function(A){return{name:"border-"+A+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(A,e){switch(e){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},nt=he("top"),st=he("right"),ot=he("bottom"),it=he("left"),he=function(A){return{name:"border-"+A+"-width",initialValue:"0",type:0,prefix:!1,parse:function(A,e){return WA(e)?e.number:0}}},Qt=he("top"),ct=he("right"),at=he("bottom"),gt=he("left"),wt={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Ut={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(A,e){return"rtl"!==e?0:1}},lt={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(A,e){return e.filter(_A).reduce(function(A,e){return A|Ct(e.value)},0)}},Ct=function(A){switch(A){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},ut={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(A,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Ft={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(A,e){return!(20===e.type&&"normal"===e.value||17!==e.type&&15!==e.type)?e.number:0}},ht={name:"line-break",initialValue:(he=We=We||{}).NORMAL="normal",prefix:!(he.STRICT="strict"),type:2,parse:function(A,e){return"strict"!==e?We.NORMAL:We.STRICT}},dt={name:"line-height",initialValue:"normal",prefix:!1,type:4},ft={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(A,e){return 20===e.type&&"none"===e.value?null:Oe(A,e)}},Ht={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(A,e){return"inside"!==e?1:0}},pt={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(A,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},he=function(A){return{name:"margin-"+A,initialValue:"0",prefix:!1,type:4}},Et=he("top"),It=he("right"),yt=he("bottom"),Kt=he("left"),mt={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(A,e){return e.filter(_A).map(function(A){switch(A.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}})}},Lt={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(A,e){return"break-word"!==e?"normal":"break-word"}},he=function(A){return{name:"padding-"+A,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},bt=he("top"),Dt=he("right"),vt=he("bottom"),xt=he("left"),Mt={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(A,e){switch(e){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},St={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(A,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Tt={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,A){return 1===A.length&&jA(A[0],"none")?[]:Ae(A).map(function(A){for(var e={color:Le.TRANSPARENT,offsetX:ae,offsetY:ae,blur:ae},t=0,r=0;r<A.length;r++){var B=A[r];ee(B)?(0===t?e.offsetX=B:1===t?e.offsetY=B:e.blur=B,t++):e.color=ue(n,B)}return e})}},Gt={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(A,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Ot={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(A,e){if(20===e.type&&"none"===e.value)return null;if(18!==e.type)return null;var t=Vt[e.name];if(void 0===t)throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return t(e.values)}},Vt={matrix:function(A){A=A.filter(function(A){return 17===A.type}).map(function(A){return A.number});return 6===A.length?A:null},matrix3d:function(A){var e=A.filter(function(A){return 17===A.type}).map(function(A){return A.number}),t=e[0],r=e[1];e[2],e[3];var B=e[4],n=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var s=e[12],A=e[13];return e[14],e[15],16===e.length?[t,r,B,n,s,A]:null}},he={type:16,number:50,flags:4},kt=[he,he],Rt={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(A,e){e=e.filter(te);return 2!==e.length?kt:[e[0],e[1]]}},Nt={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(A,e){switch(e){case"hidden":return 1;case"collapse":return 2;default:return 0}}};(he=Ze=Ze||{}).NORMAL="normal",he.BREAK_ALL="break-all";function Pt(A,e){return 0!=(A&e)}function Xt(A,e,t){return(A=A&&A[Math.min(e,A.length-1)])?t?A.open:A.close:""}var Jt={name:"word-break",initialValue:"normal",prefix:!(he.KEEP_ALL="keep-all"),type:2,parse:function(A,e){switch(e){case"break-all":return Ze.BREAK_ALL;case"keep-all":return Ze.KEEP_ALL;default:return Ze.NORMAL}}},Yt={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(A,e){if(20===e.type)return{auto:!0,order:0};if(ZA(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},Wt=function(A,e){if(15===e.type)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")},Zt={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(A,e){return ZA(e)?e.number:1}},_t={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},qt={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(A,e){return e.filter(_A).map(function(A){switch(A.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(A){return 0!==A})}},jt={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(A,e){var t=[],r=[];return e.forEach(function(A){switch(A.type){case 20:case 0:t.push(A.value);break;case 17:t.push(A.number.toString());break;case 4:r.push(t.join(" ")),t.length=0}}),t.length&&r.push(t.join(" ")),r.map(function(A){return-1===A.indexOf(" ")?A:"'"+A+"'"})}},zt={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},$t={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(A,e){return ZA(e)?e.number:!_A(e)||"bold"!==e.value?400:700}},Ar={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(A,e){return e.filter(_A).map(function(A){return A.value})}},er={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(A,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},tr={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(A,e){if(0===e.length)return[];var t=e[0];return 20===t.type&&"none"===t.value?[]:e}},rr={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(A,e){if(0===e.length)return null;var t=e[0];if(20===t.type&&"none"===t.value)return null;for(var r=[],B=e.filter(zA),n=0;n<B.length;n++){var s=B[n],o=B[n+1];20===s.type&&(o=o&&ZA(o)?o.number:1,r.push({counter:s.value,increment:o}))}return r}},Br={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(A,e){if(0===e.length)return[];for(var t=[],r=e.filter(zA),B=0;B<r.length;B++){var n=r[B],s=r[B+1];_A(n)&&"none"!==n.value&&(s=s&&ZA(s)?s.number:0,t.push({counter:n.value,reset:s}))}return t}},nr={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,A){return A.filter(WA).map(function(A){return Wt(e,A)})}},sr={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(A,e){if(0===e.length)return null;var t=e[0];if(20===t.type&&"none"===t.value)return null;var r=[],B=e.filter(qA);if(B.length%2!=0)return null;for(var n=0;n<B.length;n+=2){var s=B[n].value,o=B[n+1].value;r.push({open:s,close:o})}return r}},or={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,A){return 1===A.length&&jA(A[0],"none")?[]:Ae(A).map(function(A){for(var e={color:255,offsetX:ae,offsetY:ae,blur:ae,spread:ae,inset:!1},t=0,r=0;r<A.length;r++){var B=A[r];jA(B,"inset")?e.inset=!0:ee(B)?(0===t?e.offsetX=B:1===t?e.offsetY=B:2===t?e.blur=B:e.spread=B,t++):e.color=ue(n,B)}return e})}},ir={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(A,e){var t=[];return e.filter(_A).forEach(function(A){switch(A.value){case"stroke":t.push(1);break;case"fill":t.push(0);break;case"markers":t.push(2)}}),[0,1,2].forEach(function(A){-1===t.indexOf(A)&&t.push(A)}),t}},Qr={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},cr={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(A,e){return WA(e)?e.number:0}},ar=(gr.prototype.isVisible=function(){return 0<this.display&&0<this.opacity&&0===this.visibility},gr.prototype.isTransparent=function(){return oe(this.backgroundColor)},gr.prototype.isTransformed=function(){return null!==this.transform},gr.prototype.isPositioned=function(){return 0!==this.position},gr.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},gr.prototype.isFloating=function(){return 0!==this.float},gr.prototype.isInlineLevel=function(){return Pt(this.display,4)||Pt(this.display,33554432)||Pt(this.display,268435456)||Pt(this.display,536870912)||Pt(this.display,67108864)||Pt(this.display,134217728)},gr);function gr(A,e){this.animationDuration=lr(A,nr,e.animationDuration),this.backgroundClip=lr(A,be,e.backgroundClip),this.backgroundColor=lr(A,De,e.backgroundColor),this.backgroundImage=lr(A,Re,e.backgroundImage),this.backgroundOrigin=lr(A,Ne,e.backgroundOrigin),this.backgroundPosition=lr(A,Pe,e.backgroundPosition),this.backgroundRepeat=lr(A,Xe,e.backgroundRepeat),this.backgroundSize=lr(A,_e,e.backgroundSize),this.borderTopColor=lr(A,je,e.borderTopColor),this.borderRightColor=lr(A,ze,e.borderRightColor),this.borderBottomColor=lr(A,$e,e.borderBottomColor),this.borderLeftColor=lr(A,At,e.borderLeftColor),this.borderTopLeftRadius=lr(A,et,e.borderTopLeftRadius),this.borderTopRightRadius=lr(A,tt,e.borderTopRightRadius),this.borderBottomRightRadius=lr(A,rt,e.borderBottomRightRadius),this.borderBottomLeftRadius=lr(A,Bt,e.borderBottomLeftRadius),this.borderTopStyle=lr(A,nt,e.borderTopStyle),this.borderRightStyle=lr(A,st,e.borderRightStyle),this.borderBottomStyle=lr(A,ot,e.borderBottomStyle),this.borderLeftStyle=lr(A,it,e.borderLeftStyle),this.borderTopWidth=lr(A,Qt,e.borderTopWidth),this.borderRightWidth=lr(A,ct,e.borderRightWidth),this.borderBottomWidth=lr(A,at,e.borderBottomWidth),this.borderLeftWidth=lr(A,gt,e.borderLeftWidth),this.boxShadow=lr(A,or,e.boxShadow),this.color=lr(A,wt,e.color),this.direction=lr(A,Ut,e.direction),this.display=lr(A,lt,e.display),this.float=lr(A,ut,e.cssFloat),this.fontFamily=lr(A,jt,e.fontFamily),this.fontSize=lr(A,zt,e.fontSize),this.fontStyle=lr(A,er,e.fontStyle),this.fontVariant=lr(A,Ar,e.fontVariant),this.fontWeight=lr(A,$t,e.fontWeight),this.letterSpacing=lr(A,Ft,e.letterSpacing),this.lineBreak=lr(A,ht,e.lineBreak),this.lineHeight=lr(A,dt,e.lineHeight),this.listStyleImage=lr(A,ft,e.listStyleImage),this.listStylePosition=lr(A,Ht,e.listStylePosition),this.listStyleType=lr(A,pt,e.listStyleType),this.marginTop=lr(A,Et,e.marginTop),this.marginRight=lr(A,It,e.marginRight),this.marginBottom=lr(A,yt,e.marginBottom),this.marginLeft=lr(A,Kt,e.marginLeft),this.opacity=lr(A,Zt,e.opacity);var t=lr(A,mt,e.overflow);this.overflowX=t[0],this.overflowY=t[1<t.length?1:0],this.overflowWrap=lr(A,Lt,e.overflowWrap),this.paddingTop=lr(A,bt,e.paddingTop),this.paddingRight=lr(A,Dt,e.paddingRight),this.paddingBottom=lr(A,vt,e.paddingBottom),this.paddingLeft=lr(A,xt,e.paddingLeft),this.paintOrder=lr(A,ir,e.paintOrder),this.position=lr(A,St,e.position),this.textAlign=lr(A,Mt,e.textAlign),this.textDecorationColor=lr(A,_t,null!==(t=e.textDecorationColor)&&void 0!==t?t:e.color),this.textDecorationLine=lr(A,qt,null!==(t=e.textDecorationLine)&&void 0!==t?t:e.textDecoration),this.textShadow=lr(A,Tt,e.textShadow),this.textTransform=lr(A,Gt,e.textTransform),this.transform=lr(A,Ot,e.transform),this.transformOrigin=lr(A,Rt,e.transformOrigin),this.visibility=lr(A,Nt,e.visibility),this.webkitTextStrokeColor=lr(A,Qr,e.webkitTextStrokeColor),this.webkitTextStrokeWidth=lr(A,cr,e.webkitTextStrokeWidth),this.wordBreak=lr(A,Jt,e.wordBreak),this.zIndex=lr(A,Yt,e.zIndex)}for(var wr=function(A,e){this.content=lr(A,tr,e.content),this.quotes=lr(A,sr,e.quotes)},Ur=function(A,e){this.counterIncrement=lr(A,rr,e.counterIncrement),this.counterReset=lr(A,Br,e.counterReset)},lr=function(A,e,t){var r=new PA,t=null!=t?t.toString():e.initialValue;r.write(t);var B=new JA(r.read());switch(e.type){case 2:var n=B.parseComponentValue();return e.parse(A,_A(n)?n.value:e.initialValue);case 0:return e.parse(A,B.parseComponentValue());case 1:return e.parse(A,B.parseComponentValues());case 4:return B.parseComponentValue();case 3:switch(e.format){case"angle":return le(A,B.parseComponentValue());case"color":return ue(A,B.parseComponentValue());case"image":return Oe(A,B.parseComponentValue());case"length":var s=B.parseComponentValue();return ee(s)?s:ae;case"length-percentage":s=B.parseComponentValue();return te(s)?s:ae;case"time":return Wt(A,B.parseComponentValue())}}},Cr=function(A,e){A=function(A){switch(A.getAttribute("data-html2canvas-debug")){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}}(A);return 1===A||e===A},ur=function(A,e){this.context=A,this.textNodes=[],this.elements=[],this.flags=0,Cr(e,3),this.styles=new ar(A,window.getComputedStyle(e,null)),JB(e)&&(this.styles.animationDuration.some(function(A){return 0<A})&&(e.style.animationDuration="0s"),null!==this.styles.transform&&(e.style.transform="none")),this.bounds=f(this.context,e),Cr(e,4)&&(this.flags|=16)},Fr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hr="undefined"==typeof Uint8Array?[]:new Uint8Array(256),dr=0;dr<Fr.length;dr++)hr[Fr.charCodeAt(dr)]=dr;function fr(A,e,t){return A.slice?A.slice(e,t):new Uint16Array(Array.prototype.slice.call(A,e,t))}var Hr=(pr.prototype.get=function(A){var e;if(0<=A){if(A<55296||56319<A&&A<=65535)return e=this.index[A>>5],this.data[e=(e<<2)+(31&A)];if(A<=65535)return e=this.index[2048+(A-55296>>5)],this.data[e=(e<<2)+(31&A)];if(A<this.highStart)return e=this.index[e=2080+(A>>11)],e=this.index[e+=A>>5&63],this.data[e=(e<<2)+(31&A)];if(A<=1114111)return this.data[this.highValueIndex]}return this.errorValue},pr);function pr(A,e,t,r,B,n){this.initialValue=A,this.errorValue=e,this.highStart=t,this.highValueIndex=r,this.index=B,this.data=n}for(var Er="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ir="undefined"==typeof Uint8Array?[]:new Uint8Array(256),yr=0;yr<Er.length;yr++)Ir[Er.charCodeAt(yr)]=yr;function Kr(A){return kr.get(A)}function mr(A){var t=function(A){for(var e=[],t=0,r=A.length;t<r;){var B,n=A.charCodeAt(t++);55296<=n&&n<=56319&&t<r?56320==(64512&(B=A.charCodeAt(t++)))?e.push(((1023&n)<<10)+(1023&B)+65536):(e.push(n),t--):e.push(n)}return e}(A),r=t.length,B=0,n=0,s=t.map(Kr);return{next:function(){if(r<=B)return{done:!0,value:null};for(var A=Rr;B<r&&(A=function(A,e){var t=e-2,r=A[t],B=A[e-1],e=A[e];if(2===B&&3===e)return Rr;if(2===B||3===B||4===B)return"÷";if(2===e||3===e||4===e)return"÷";if(B===Tr&&-1!==[Tr,Gr,Or,Vr].indexOf(e))return Rr;if(!(B!==Or&&B!==Gr||e!==Gr&&10!==e))return Rr;if((B===Vr||10===B)&&10===e)return Rr;if(13===e||5===e)return Rr;if(7===e)return Rr;if(1===B)return Rr;if(13===B&&14===e){for(;5===r;)r=A[--t];if(14===r)return Rr}if(15===B&&15===e){for(var n=0;15===r;)n++,r=A[--t];if(n%2==0)return Rr}return"÷"}(s,++B))===Rr;);if(A===Rr&&B!==r)return{done:!0,value:null};var e=function(){for(var A=[],e=0;e<arguments.length;e++)A[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,A);var t=A.length;if(!t)return"";for(var r=[],B=-1,n="";++B<t;){var s=A[B];s<=65535?r.push(s):(s-=65536,r.push(55296+(s>>10),s%1024+56320)),(B+1===t||16384<r.length)&&(n+=String.fromCharCode.apply(String,r),r.length=0)}return n}.apply(null,t.slice(n,B));return n=B,{value:e,done:!1}}}}function Lr(A){return 0===A[0]&&255===A[1]&&0===A[2]&&255===A[3]}var br,Dr,vr,xr,Mr,Sr,Tr=8,Gr=9,Or=11,Vr=12,kr=(vr=function(A){var e,t,r,B,n=.75*A.length,s=A.length,o=0;"="===A[A.length-1]&&(n--,"="===A[A.length-2]&&n--);for(var n=new("undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?ArrayBuffer:Array)(n),i=Array.isArray(n)?n:new Uint8Array(n),Q=0;Q<s;Q+=4)e=hr[A.charCodeAt(Q)],t=hr[A.charCodeAt(Q+1)],r=hr[A.charCodeAt(Q+2)],B=hr[A.charCodeAt(Q+3)],i[o++]=e<<2|t>>4,i[o++]=(15&t)<<4|r>>2,i[o++]=(3&r)<<6|63&B;return n}(br="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA="),xr=Array.isArray(vr)?function(A){for(var e=A.length,t=[],r=0;r<e;r+=4)t.push(A[r+3]<<24|A[r+2]<<16|A[r+1]<<8|A[r]);return t}(vr):new Uint32Array(vr),Mr=Array.isArray(vr)?function(A){for(var e=A.length,t=[],r=0;r<e;r+=2)t.push(A[r+1]<<8|A[r]);return t}(vr):new Uint16Array(vr),br=fr(Mr,12,xr[4]/2),Dr=2===xr[5]?fr(Mr,(24+xr[4])/2):(vr=xr,Mr=Math.ceil((24+xr[4])/4),vr.slice?vr.slice(Mr,Dr):new Uint32Array(Array.prototype.slice.call(vr,Mr,Dr))),new Hr(xr[0],xr[1],xr[2],xr[3],br,Dr)),Rr="×",Nr=function(A,e,t,r,B){var n="http://www.w3.org/2000/svg",s=document.createElementNS(n,"svg"),n=document.createElementNS(n,"foreignObject");return s.setAttributeNS(null,"width",A.toString()),s.setAttributeNS(null,"height",e.toString()),n.setAttributeNS(null,"width","100%"),n.setAttributeNS(null,"height","100%"),n.setAttributeNS(null,"x",t.toString()),n.setAttributeNS(null,"y",r.toString()),n.setAttributeNS(null,"externalResourcesRequired","true"),s.appendChild(n),n.appendChild(B),s},Pr=function(r){return new Promise(function(A,e){var t=new Image;t.onload=function(){return A(t)},t.onerror=e,t.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(r))})},Xr={get SUPPORT_RANGE_BOUNDS(){var A=function(A){if(A.createRange){var e=A.createRange();if(e.getBoundingClientRect){var t=A.createElement("boundtest");t.style.height="123px",t.style.display="block",A.body.appendChild(t),e.selectNode(t);e=e.getBoundingClientRect(),e=Math.round(e.height);if(A.body.removeChild(t),123===e)return!0}}return!1}(document);return Object.defineProperty(Xr,"SUPPORT_RANGE_BOUNDS",{value:A}),A},get SUPPORT_WORD_BREAKING(){var A=Xr.SUPPORT_RANGE_BOUNDS&&function(A){var e=A.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",A.body.appendChild(e);var r=A.createRange();e.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var B=e.firstChild,t=Q(B.data).map(function(A){return g(A)}),n=0,s={},t=t.every(function(A,e){r.setStart(B,n),r.setEnd(B,n+A.length);var t=r.getBoundingClientRect();n+=A.length;A=t.x>s.x||t.y>s.y;return s=t,0===e||A});return A.body.removeChild(e),t}(document);return Object.defineProperty(Xr,"SUPPORT_WORD_BREAKING",{value:A}),A},get SUPPORT_SVG_DRAWING(){var A=function(A){var e=new Image,t=A.createElement("canvas"),A=t.getContext("2d");if(!A)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{A.drawImage(e,0,0),t.toDataURL()}catch(A){return!1}return!0}(document);return Object.defineProperty(Xr,"SUPPORT_SVG_DRAWING",{value:A}),A},get SUPPORT_FOREIGNOBJECT_DRAWING(){var A="function"==typeof Array.from&&"function"==typeof window.fetch?function(t){var A=t.createElement("canvas"),r=100;A.width=r,A.height=r;var B=A.getContext("2d");if(!B)return Promise.reject(!1);B.fillStyle="rgb(0, 255, 0)",B.fillRect(0,0,r,r);var e=new Image,n=A.toDataURL();e.src=n;e=Nr(r,r,0,0,e);return B.fillStyle="red",B.fillRect(0,0,r,r),Pr(e).then(function(A){B.drawImage(A,0,0);var e=B.getImageData(0,0,r,r).data;B.fillStyle="red",B.fillRect(0,0,r,r);A=t.createElement("div");return A.style.backgroundImage="url("+n+")",A.style.height="100px",Lr(e)?Pr(Nr(r,r,0,0,A)):Promise.reject(!1)}).then(function(A){return B.drawImage(A,0,0),Lr(B.getImageData(0,0,r,r).data)}).catch(function(){return!1})}(document):Promise.resolve(!1);return Object.defineProperty(Xr,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:A}),A},get SUPPORT_CORS_IMAGES(){var A=void 0!==(new Image).crossOrigin;return Object.defineProperty(Xr,"SUPPORT_CORS_IMAGES",{value:A}),A},get SUPPORT_RESPONSE_TYPE(){var A="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(Xr,"SUPPORT_RESPONSE_TYPE",{value:A}),A},get SUPPORT_CORS_XHR(){var A="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Xr,"SUPPORT_CORS_XHR",{value:A}),A},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var A=!("undefined"==typeof Intl||!Intl.Segmenter);return Object.defineProperty(Xr,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:A}),A}},Jr=function(A,e){this.text=A,this.bounds=e},Yr=function(A,e){var t=e.ownerDocument;if(t){var r=t.createElement("html2canvaswrapper");r.appendChild(e.cloneNode(!0));t=e.parentNode;if(t){t.replaceChild(r,e);A=f(A,r);return r.firstChild&&t.replaceChild(r.firstChild,r),A}}return d.EMPTY},Wr=function(A,e,t){var r=A.ownerDocument;if(!r)throw new Error("Node has no owner document");r=r.createRange();return r.setStart(A,e),r.setEnd(A,e+t),r},Zr=function(A){if(Xr.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(A)).map(function(A){return A.segment})}return function(A){for(var e,t=mr(A),r=[];!(e=t.next()).done;)e.value&&r.push(e.value.slice());return r}(A)},_r=function(A,e){return 0!==e.letterSpacing?Zr(A):function(A,e){if(Xr.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(t.segment(A)).map(function(A){return A.segment})}return jr(A,e)}(A,e)},qr=[32,160,4961,65792,65793,4153,4241],jr=function(A,e){for(var t,r=wA(A,{lineBreak:e.lineBreak,wordBreak:"break-word"===e.overflowWrap?"break-word":e.wordBreak}),B=[];!(t=r.next()).done;)!function(){var A,e;t.value&&(A=t.value.slice(),A=Q(A),e="",A.forEach(function(A){-1===qr.indexOf(A)?e+=g(A):(e.length&&B.push(e),B.push(g(A)),e="")}),e.length&&B.push(e))}();return B},zr=function(A,e,t){var B,n,s,o,i;this.text=$r(e.data,t.textTransform),this.textBounds=(B=A,A=this.text,s=e,A=_r(A,n=t),o=[],i=0,A.forEach(function(A){var e,t,r;n.textDecorationLine.length||0<A.trim().length?Xr.SUPPORT_RANGE_BOUNDS?1<(r=Wr(s,i,A.length).getClientRects()).length?(e=Zr(A),t=0,e.forEach(function(A){o.push(new Jr(A,d.fromDOMRectList(B,Wr(s,t+i,A.length).getClientRects()))),t+=A.length})):o.push(new Jr(A,d.fromDOMRectList(B,r))):(r=s.splitText(A.length),o.push(new Jr(A,Yr(B,s))),s=r):Xr.SUPPORT_RANGE_BOUNDS||(s=s.splitText(A.length)),i+=A.length}),o)},$r=function(A,e){switch(e){case 1:return A.toLowerCase();case 3:return A.replace(AB,eB);case 2:return A.toUpperCase();default:return A}},AB=/(^|\s|:|-|\(|\))([a-z])/g,eB=function(A,e,t){return 0<A.length?e+t.toUpperCase():A},tB=(A(rB,Sr=ur),rB);function rB(A,e){A=Sr.call(this,A,e)||this;return A.src=e.currentSrc||e.src,A.intrinsicWidth=e.naturalWidth,A.intrinsicHeight=e.naturalHeight,A.context.cache.addImage(A.src),A}var BB,nB=(A(sB,BB=ur),sB);function sB(A,e){A=BB.call(this,A,e)||this;return A.canvas=e,A.intrinsicWidth=e.width,A.intrinsicHeight=e.height,A}var oB,iB=(A(QB,oB=ur),QB);function QB(A,e){var t=oB.call(this,A,e)||this,r=new XMLSerializer,A=f(A,e);return e.setAttribute("width",A.width+"px"),e.setAttribute("height",A.height+"px"),t.svg="data:image/svg+xml,"+encodeURIComponent(r.serializeToString(e)),t.intrinsicWidth=e.width.baseVal.value,t.intrinsicHeight=e.height.baseVal.value,t.context.cache.addImage(t.svg),t}var cB,aB=(A(gB,cB=ur),gB);function gB(A,e){A=cB.call(this,A,e)||this;return A.value=e.value,A}var wB,UB=(A(lB,wB=ur),lB);function lB(A,e){A=wB.call(this,A,e)||this;return A.start=e.start,A.reversed="boolean"==typeof e.reversed&&!0===e.reversed,A}var CB,uB=[{type:15,flags:0,unit:"px",number:3}],FB=[{type:16,flags:0,number:50}],hB="checkbox",dB="radio",fB="password",HB=707406591,pB=(A(EB,CB=ur),EB);function EB(A,e){var t=CB.call(this,A,e)||this;switch(t.type=e.type.toLowerCase(),t.checked=e.checked,t.value=0===(e=(A=e).type===fB?new Array(A.value.length+1).join("•"):A.value).length?A.placeholder||"":e,t.type!==hB&&t.type!==dB||(t.styles.backgroundColor=3739148031,t.styles.borderTopColor=t.styles.borderRightColor=t.styles.borderBottomColor=t.styles.borderLeftColor=2779096575,t.styles.borderTopWidth=t.styles.borderRightWidth=t.styles.borderBottomWidth=t.styles.borderLeftWidth=1,t.styles.borderTopStyle=t.styles.borderRightStyle=t.styles.borderBottomStyle=t.styles.borderLeftStyle=1,t.styles.backgroundClip=[0],t.styles.backgroundOrigin=[0],t.bounds=(e=t.bounds).width>e.height?new d(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new d(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e),t.type){case hB:t.styles.borderTopRightRadius=t.styles.borderTopLeftRadius=t.styles.borderBottomRightRadius=t.styles.borderBottomLeftRadius=uB;break;case dB:t.styles.borderTopRightRadius=t.styles.borderTopLeftRadius=t.styles.borderBottomRightRadius=t.styles.borderBottomLeftRadius=FB}return t}var IB,yB=(A(KB,IB=ur),KB);function KB(A,e){A=IB.call(this,A,e)||this,e=e.options[e.selectedIndex||0];return A.value=e&&e.text||"",A}var mB,LB=(A(bB,mB=ur),bB);function bB(A,e){A=mB.call(this,A,e)||this;return A.value=e.value,A}var DB,vB=(A(xB,DB=ur),xB);function xB(A,e){var t,r,B=DB.call(this,A,e)||this;B.src=e.src,B.width=parseInt(e.width,10)||0,B.height=parseInt(e.height,10)||0,B.backgroundColor=B.styles.backgroundColor;try{e.contentWindow&&e.contentWindow.document&&e.contentWindow.document.documentElement&&(B.tree=kB(A,e.contentWindow.document.documentElement),t=e.contentWindow.document.documentElement?fe(A,getComputedStyle(e.contentWindow.document.documentElement).backgroundColor):Le.TRANSPARENT,r=e.contentWindow.document.body?fe(A,getComputedStyle(e.contentWindow.document.body).backgroundColor):Le.TRANSPARENT,B.backgroundColor=oe(t)?oe(r)?B.styles.backgroundColor:r:t)}catch(A){}return B}function MB(A){return"VIDEO"===A.tagName}function SB(A){return"STYLE"===A.tagName}function TB(A){return 0<A.tagName.indexOf("-")}var GB=["OL","UL","MENU"],OB=function(e,A,t,r){for(var B=A.firstChild;B;B=s){var n,s=B.nextSibling;PB(B)&&0<B.data.trim().length?t.textNodes.push(new zr(e,B,t.styles)):XB(B)&&(rn(B)&&B.assignedNodes?B.assignedNodes().forEach(function(A){return OB(e,A,t,r)}):(n=VB(e,B)).styles.isVisible()&&(RB(B,n,r)?n.flags|=4:NB(n.styles)&&(n.flags|=2),-1!==GB.indexOf(B.tagName)&&(n.flags|=8),t.elements.push(n),B.slot,B.shadowRoot?OB(e,B.shadowRoot,n,r):en(B)||qB(B)||tn(B)||OB(e,B,n,r)))}},VB=function(A,e){return new($B(e)?tB:zB(e)?nB:qB(e)?iB:WB(e)?aB:ZB(e)?UB:_B(e)?pB:tn(e)?yB:en(e)?LB:An(e)?vB:ur)(A,e)},kB=function(A,e){var t=VB(A,e);return t.flags|=4,OB(A,e,t,t),t},RB=function(A,e,t){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||jB(A)&&t.styles.isTransparent()},NB=function(A){return A.isPositioned()||A.isFloating()},PB=function(A){return A.nodeType===Node.TEXT_NODE},XB=function(A){return A.nodeType===Node.ELEMENT_NODE},JB=function(A){return XB(A)&&void 0!==A.style&&!YB(A)},YB=function(A){return"object"==typeof A.className},WB=function(A){return"LI"===A.tagName},ZB=function(A){return"OL"===A.tagName},_B=function(A){return"INPUT"===A.tagName},qB=function(A){return"svg"===A.tagName},jB=function(A){return"BODY"===A.tagName},zB=function(A){return"CANVAS"===A.tagName},$B=function(A){return"IMG"===A.tagName},An=function(A){return"IFRAME"===A.tagName},en=function(A){return"TEXTAREA"===A.tagName},tn=function(A){return"SELECT"===A.tagName},rn=function(A){return"SLOT"===A.tagName},Bn=(nn.prototype.getCounterValue=function(A){A=this.counters[A];return A&&A.length?A[A.length-1]:1},nn.prototype.getCounterValues=function(A){A=this.counters[A];return A||[]},nn.prototype.pop=function(A){var e=this;A.forEach(function(A){return e.counters[A].pop()})},nn.prototype.parse=function(A){var t=this,e=A.counterIncrement,A=A.counterReset,r=!0;null!==e&&e.forEach(function(A){var e=t.counters[A.counter];e&&0!==A.increment&&(r=!1,e.length||e.push(1),e[Math.max(0,e.length-1)]+=A.increment)});var B=[];return r&&A.forEach(function(A){var e=t.counters[A.counter];B.push(A.counter),(e=e||(t.counters[A.counter]=[])).push(A.reset)}),B},nn);function nn(){this.counters={}}function sn(r,A,e,B,t,n){return r<A||e<r?Fn(r,t,0<n.length):B.integers.reduce(function(A,e,t){for(;e<=r;)r-=e,A+=B.values[t];return A},"")+n}function on(A,e,t,r){for(var B="";t||A--,B=r(A)+B,e<=(A/=e)*e;);return B}function Qn(A,e,t,r,B){var n=t-e+1;return(A<0?"-":"")+(on(Math.abs(A),n,r,function(A){return g(Math.floor(A%n)+e)})+B)}function cn(A,e,t){void 0===t&&(t=". ");var r=e.length;return on(Math.abs(A),r,!1,function(A){return e[Math.floor(A%r)]})+t}function an(A,e,t,r,B,n){if(A<-9999||9999<A)return Fn(A,4,0<B.length);var s=Math.abs(A),o=B;if(0===s)return e[0]+o;for(var i=0;0<s&&i<=4;i++){var Q=s%10;0==Q&&Pt(n,1)&&""!==o?o=e[Q]+o:1<Q||1==Q&&0===i||1==Q&&1===i&&Pt(n,2)||1==Q&&1===i&&Pt(n,4)&&100<A||1==Q&&1<i&&Pt(n,8)?o=e[Q]+(0<i?t[i-1]:"")+o:1==Q&&0<i&&(o=t[i-1]+o),s=Math.floor(s/10)}return(A<0?r:"")+o}var gn,wn={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Un={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},ln={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},Cn={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},un="마이너스",Fn=function(A,e,t){var r=t?". ":"",B=t?"、":"",n=t?", ":"",s=t?" ":"";switch(e){case 0:return"•"+s;case 1:return"◦"+s;case 2:return"◾"+s;case 5:var o=Qn(A,48,57,!0,r);return o.length<4?"0"+o:o;case 4:return cn(A,"〇一二三四五六七八九",B);case 6:return sn(A,1,3999,wn,3,r).toLowerCase();case 7:return sn(A,1,3999,wn,3,r);case 8:return Qn(A,945,969,!1,r);case 9:return Qn(A,97,122,!1,r);case 10:return Qn(A,65,90,!1,r);case 11:return Qn(A,1632,1641,!0,r);case 12:case 49:return sn(A,1,9999,Un,3,r);case 35:return sn(A,1,9999,Un,3,r).toLowerCase();case 13:return Qn(A,2534,2543,!0,r);case 14:case 30:return Qn(A,6112,6121,!0,r);case 15:return cn(A,"子丑寅卯辰巳午未申酉戌亥",B);case 16:return cn(A,"甲乙丙丁戊己庚辛壬癸",B);case 17:case 48:return an(A,"零一二三四五六七八九","十百千萬","負",B,14);case 47:return an(A,"零壹貳參肆伍陸柒捌玖","拾佰仟萬","負",B,15);case 42:return an(A,"零一二三四五六七八九","十百千萬","负",B,14);case 41:return an(A,"零壹贰叁肆伍陆柒捌玖","拾佰仟萬","负",B,15);case 26:return an(A,"〇一二三四五六七八九","十百千万","マイナス",B,0);case 25:return an(A,"零壱弐参四伍六七八九","拾百千万","マイナス",B,7);case 31:return an(A,"영일이삼사오육칠팔구","십백천만",un,n,7);case 33:return an(A,"零一二三四五六七八九","十百千萬",un,n,0);case 32:return an(A,"零壹貳參四五六七八九","拾百千",un,n,7);case 18:return Qn(A,2406,2415,!0,r);case 20:return sn(A,1,19999,Cn,3,r);case 21:return Qn(A,2790,2799,!0,r);case 22:return Qn(A,2662,2671,!0,r);case 22:return sn(A,1,10999,ln,3,r);case 23:return cn(A,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return cn(A,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return Qn(A,3302,3311,!0,r);case 28:return cn(A,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",B);case 29:return cn(A,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",B);case 34:return Qn(A,3792,3801,!0,r);case 37:return Qn(A,6160,6169,!0,r);case 38:return Qn(A,4160,4169,!0,r);case 39:return Qn(A,2918,2927,!0,r);case 40:return Qn(A,1776,1785,!0,r);case 43:return Qn(A,3046,3055,!0,r);case 44:return Qn(A,3174,3183,!0,r);case 45:return Qn(A,3664,3673,!0,r);case 46:return Qn(A,3872,3881,!0,r);default:return Qn(A,48,57,!0,r)}},hn="data-html2canvas-ignore",dn=(fn.prototype.toIFrame=function(A,r){var e=this,B=pn(A,r);if(!B.contentWindow)return Promise.reject("Unable to find iframe window");var t=A.defaultView.pageXOffset,n=A.defaultView.pageYOffset,s=B.contentWindow,o=s.document,A=In(B).then(function(){return a(e,void 0,void 0,function(){var e,t;return H(this,function(A){switch(A.label){case 0:return this.scrolledElements.forEach(bn),s&&(s.scrollTo(r.left,r.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||s.scrollY===r.top&&s.scrollX===r.left||(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(s.scrollX-r.left,s.scrollY-r.top,0,0))),e=this.options.onclone,void 0===(t=this.clonedReferenceElement)?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:o.fonts&&o.fonts.ready?[4,o.fonts.ready]:[3,2];case 1:A.sent(),A.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,En(o)]:[3,4];case 3:A.sent(),A.label=4;case 4:return"function"==typeof e?[2,Promise.resolve().then(function(){return e(o,t)}).then(function(){return B})]:[2,B]}})})});return o.open(),o.write(mn(document.doctype)+"<html></html>"),Ln(this.referenceElement.ownerDocument,t,n),o.replaceChild(o.adoptNode(this.documentElement),o.documentElement),o.close(),A},fn.prototype.createElementClone=function(A){if(Cr(A,2),zB(A))return this.createCanvasClone(A);if(MB(A))return this.createVideoClone(A);if(SB(A))return this.createStyleClone(A);var e=A.cloneNode(!1);return $B(e)&&($B(A)&&A.currentSrc&&A.currentSrc!==A.src&&(e.src=A.currentSrc,e.srcset=""),"lazy"===e.loading&&(e.loading="eager")),TB(e)?this.createCustomElementClone(e):e},fn.prototype.createCustomElementClone=function(A){var e=document.createElement("html2canvascustomelement");return Kn(A.style,e),e},fn.prototype.createStyleClone=function(A){try{var e=A.sheet;if(e&&e.cssRules){var t=[].slice.call(e.cssRules,0).reduce(function(A,e){return e&&"string"==typeof e.cssText?A+e.cssText:A},""),r=A.cloneNode(!1);return r.textContent=t,r}}catch(A){if(this.context.logger.error("Unable to access cssRules property",A),"SecurityError"!==A.name)throw A}return A.cloneNode(!1)},fn.prototype.createCanvasClone=function(e){var A;if(this.options.inlineImages&&e.ownerDocument){var t=e.ownerDocument.createElement("img");try{return t.src=e.toDataURL(),t}catch(A){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}t=e.cloneNode(!1);try{t.width=e.width,t.height=e.height;var r,B,n=e.getContext("2d"),s=t.getContext("2d");return s&&(!this.options.allowTaint&&n?s.putImageData(n.getImageData(0,0,e.width,e.height),0,0):(!(r=null!==(A=e.getContext("webgl2"))&&void 0!==A?A:e.getContext("webgl"))||!1===(null==(B=r.getContextAttributes())?void 0:B.preserveDrawingBuffer)&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e),s.drawImage(e,0,0))),t}catch(A){this.context.logger.info("Unable to clone canvas as it is tainted",e)}return t},fn.prototype.createVideoClone=function(e){var A=e.ownerDocument.createElement("canvas");A.width=e.offsetWidth,A.height=e.offsetHeight;var t=A.getContext("2d");try{return t&&(t.drawImage(e,0,0,A.width,A.height),this.options.allowTaint||t.getImageData(0,0,A.width,A.height)),A}catch(A){this.context.logger.info("Unable to clone video as it is tainted",e)}A=e.ownerDocument.createElement("canvas");return A.width=e.offsetWidth,A.height=e.offsetHeight,A},fn.prototype.appendChildNode=function(A,e,t){XB(e)&&("SCRIPT"===e.tagName||e.hasAttribute(hn)||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(e))||this.options.copyStyles&&XB(e)&&SB(e)||A.appendChild(this.cloneNode(e,t))},fn.prototype.cloneChildNodes=function(A,e,t){for(var r,B=this,n=(A.shadowRoot||A).firstChild;n;n=n.nextSibling)XB(n)&&rn(n)&&"function"==typeof n.assignedNodes?(r=n.assignedNodes()).length&&r.forEach(function(A){return B.appendChildNode(e,A,t)}):this.appendChildNode(e,n,t)},fn.prototype.cloneNode=function(A,e){if(PB(A))return document.createTextNode(A.data);if(!A.ownerDocument)return A.cloneNode(!1);var t=A.ownerDocument.defaultView;if(t&&XB(A)&&(JB(A)||YB(A))){var r=this.createElementClone(A);r.style.transitionProperty="none";var B=t.getComputedStyle(A),n=t.getComputedStyle(A,":before"),s=t.getComputedStyle(A,":after");this.referenceElement===A&&JB(r)&&(this.clonedReferenceElement=r),jB(r)&&Mn(r);t=this.counters.parse(new Ur(this.context,B)),n=this.resolvePseudoContent(A,r,n,gn.BEFORE);TB(A)&&(e=!0),MB(A)||this.cloneChildNodes(A,r,e),n&&r.insertBefore(n,r.firstChild);s=this.resolvePseudoContent(A,r,s,gn.AFTER);return s&&r.appendChild(s),this.counters.pop(t),(B&&(this.options.copyStyles||YB(A))&&!An(A)||e)&&Kn(B,r),0===A.scrollTop&&0===A.scrollLeft||this.scrolledElements.push([r,A.scrollLeft,A.scrollTop]),(en(A)||tn(A))&&(en(r)||tn(r))&&(r.value=A.value),r}return A.cloneNode(!1)},fn.prototype.resolvePseudoContent=function(o,A,e,t){var i=this;if(e){var r=e.content,Q=A.ownerDocument;if(Q&&r&&"none"!==r&&"-moz-alt-content"!==r&&"none"!==e.display){this.counters.parse(new Ur(this.context,e));var c=new wr(this.context,e),a=Q.createElement("html2canvaspseudoelement");Kn(e,a),c.content.forEach(function(A){if(0===A.type)a.appendChild(Q.createTextNode(A.value));else if(22===A.type){var e=Q.createElement("img");e.src=A.value,e.style.opacity="1",a.appendChild(e)}else if(18===A.type){var t,r,B,n,s;"attr"===A.name?(e=A.values.filter(_A)).length&&a.appendChild(Q.createTextNode(o.getAttribute(e[0].value)||"")):"counter"===A.name?(B=(r=A.values.filter($A))[0],r=r[1],B&&_A(B)&&(t=i.counters.getCounterValue(B.value),s=r&&_A(r)?pt.parse(i.context,r.value):3,a.appendChild(Q.createTextNode(Fn(t,s,!1))))):"counters"===A.name&&(B=(t=A.values.filter($A))[0],s=t[1],r=t[2],B&&_A(B)&&(B=i.counters.getCounterValues(B.value),n=r&&_A(r)?pt.parse(i.context,r.value):3,s=s&&0===s.type?s.value:"",s=B.map(function(A){return Fn(A,n,!1)}).join(s),a.appendChild(Q.createTextNode(s))))}else if(20===A.type)switch(A.value){case"open-quote":a.appendChild(Q.createTextNode(Xt(c.quotes,i.quoteDepth++,!0)));break;case"close-quote":a.appendChild(Q.createTextNode(Xt(c.quotes,--i.quoteDepth,!1)));break;default:a.appendChild(Q.createTextNode(A.value))}}),a.className=Dn+" "+vn;t=t===gn.BEFORE?" "+Dn:" "+vn;return YB(A)?A.className.baseValue+=t:A.className+=t,a}}},fn.destroy=function(A){return!!A.parentNode&&(A.parentNode.removeChild(A),!0)},fn);function fn(A,e,t){if(this.context=A,this.options=t,this.scrolledElements=[],this.referenceElement=e,this.counters=new Bn,this.quoteDepth=0,!e.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(e.ownerDocument.documentElement,!1)}(he=gn=gn||{})[he.BEFORE=0]="BEFORE",he[he.AFTER=1]="AFTER";function Hn(e){return new Promise(function(A){!e.complete&&e.src?(e.onload=A,e.onerror=A):A()})}var pn=function(A,e){var t=A.createElement("iframe");return t.className="html2canvas-container",t.style.visibility="hidden",t.style.position="fixed",t.style.left="-10000px",t.style.top="0px",t.style.border="0",t.width=e.width.toString(),t.height=e.height.toString(),t.scrolling="no",t.setAttribute(hn,"true"),A.body.appendChild(t),t},En=function(A){return Promise.all([].slice.call(A.images,0).map(Hn))},In=function(B){return new Promise(function(e,A){var t=B.contentWindow;if(!t)return A("No window assigned for iframe");var r=t.document;t.onload=B.onload=function(){t.onload=B.onload=null;var A=setInterval(function(){0<r.body.childNodes.length&&"complete"===r.readyState&&(clearInterval(A),e(B))},50)}})},yn=["all","d","content"],Kn=function(A,e){for(var t=A.length-1;0<=t;t--){var r=A.item(t);-1===yn.indexOf(r)&&e.style.setProperty(r,A.getPropertyValue(r))}return e},mn=function(A){var e="";return A&&(e+="<!DOCTYPE ",A.name&&(e+=A.name),A.internalSubset&&(e+=A.internalSubset),A.publicId&&(e+='"'+A.publicId+'"'),A.systemId&&(e+='"'+A.systemId+'"'),e+=">"),e},Ln=function(A,e,t){A&&A.defaultView&&(e!==A.defaultView.pageXOffset||t!==A.defaultView.pageYOffset)&&A.defaultView.scrollTo(e,t)},bn=function(A){var e=A[0],t=A[1],A=A[2];e.scrollLeft=t,e.scrollTop=A},Dn="___html2canvas___pseudoelement_before",vn="___html2canvas___pseudoelement_after",xn='{\n    content: "" !important;\n    display: none !important;\n}',Mn=function(A){Sn(A,"."+Dn+":before"+xn+"\n         ."+vn+":after"+xn)},Sn=function(A,e){var t=A.ownerDocument;t&&((t=t.createElement("style")).textContent=e,A.appendChild(t))},Tn=(Gn.getOrigin=function(A){var e=Gn._link;return e?(e.href=A,e.href=e.href,e.protocol+e.hostname+e.port):"about:blank"},Gn.isSameOrigin=function(A){return Gn.getOrigin(A)===Gn._origin},Gn.setContext=function(A){Gn._link=A.document.createElement("a"),Gn._origin=Gn.getOrigin(A.location.href)},Gn._origin="about:blank",Gn);function Gn(){}var On=(Vn.prototype.addImage=function(A){var e=Promise.resolve();return this.has(A)||(Yn(A)||Pn(A))&&(this._cache[A]=this.loadImage(A)).catch(function(){}),e},Vn.prototype.match=function(A){return this._cache[A]},Vn.prototype.loadImage=function(s){return a(this,void 0,void 0,function(){var e,r,t,B,n=this;return H(this,function(A){switch(A.label){case 0:return(e=Tn.isSameOrigin(s),r=!Xn(s)&&!0===this._options.useCORS&&Xr.SUPPORT_CORS_IMAGES&&!e,t=!Xn(s)&&!e&&!Yn(s)&&"string"==typeof this._options.proxy&&Xr.SUPPORT_CORS_XHR&&!r,e||!1!==this._options.allowTaint||Xn(s)||Yn(s)||t||r)?(B=s,t?[4,this.proxy(B)]:[3,2]):[2];case 1:B=A.sent(),A.label=2;case 2:return this.context.logger.debug("Added image "+s.substring(0,256)),[4,new Promise(function(A,e){var t=new Image;t.onload=function(){return A(t)},t.onerror=e,(Jn(B)||r)&&(t.crossOrigin="anonymous"),t.src=B,!0===t.complete&&setTimeout(function(){return A(t)},500),0<n._options.imageTimeout&&setTimeout(function(){return e("Timed out ("+n._options.imageTimeout+"ms) loading image")},n._options.imageTimeout)})];case 3:return[2,A.sent()]}})})},Vn.prototype.has=function(A){return void 0!==this._cache[A]},Vn.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},Vn.prototype.proxy=function(s){var o=this,i=this._options.proxy;if(!i)throw new Error("No proxy defined");var Q=s.substring(0,256);return new Promise(function(e,t){var r=Xr.SUPPORT_RESPONSE_TYPE?"blob":"text",B=new XMLHttpRequest;B.onload=function(){var A;200===B.status?"text"==r?e(B.response):((A=new FileReader).addEventListener("load",function(){return e(A.result)},!1),A.addEventListener("error",function(A){return t(A)},!1),A.readAsDataURL(B.response)):t("Failed to proxy resource "+Q+" with status code "+B.status)},B.onerror=t;var A,n=-1<i.indexOf("?")?"&":"?";B.open("GET",i+n+"url="+encodeURIComponent(s)+"&responseType="+r),"text"!=r&&B instanceof XMLHttpRequest&&(B.responseType=r),o._options.imageTimeout&&(A=o._options.imageTimeout,B.timeout=A,B.ontimeout=function(){return t("Timed out ("+A+"ms) proxying "+Q)}),B.send()})},Vn);function Vn(A,e){this.context=A,this._options=e,this._cache={}}var kn=/^data:image\/svg\+xml/i,Rn=/^data:image\/.*;base64,/i,Nn=/^data:image\/.*/i,Pn=function(A){return Xr.SUPPORT_SVG_DRAWING||!Wn(A)},Xn=function(A){return Nn.test(A)},Jn=function(A){return Rn.test(A)},Yn=function(A){return"blob"===A.substr(0,4)},Wn=function(A){return"svg"===A.substr(-3).toLowerCase()||kn.test(A)},Zn=(_n.prototype.add=function(A,e){return new _n(this.x+A,this.y+e)},_n);function _n(A,e){this.type=0,this.x=A,this.y=e}function qn(A,e,t){return new Zn(A.x+(e.x-A.x)*t,A.y+(e.y-A.y)*t)}var jn=(zn.prototype.subdivide=function(A,e){var t=qn(this.start,this.startControl,A),r=qn(this.startControl,this.endControl,A),B=qn(this.endControl,this.end,A),n=qn(t,r,A),r=qn(r,B,A),A=qn(n,r,A);return e?new zn(this.start,t,n,A):new zn(A,r,B,this.end)},zn.prototype.add=function(A,e){return new zn(this.start.add(A,e),this.startControl.add(A,e),this.endControl.add(A,e),this.end.add(A,e))},zn.prototype.reverse=function(){return new zn(this.end,this.endControl,this.startControl,this.start)},zn);function zn(A,e,t,r){this.type=1,this.start=A,this.startControl=e,this.endControl=t,this.end=r}function $n(A){return 1===A.type}var As,es=function(A){var e=A.styles,t=A.bounds,r=(C=Be(e.borderTopLeftRadius,t.width,t.height))[0],B=C[1],n=(u=Be(e.borderTopRightRadius,t.width,t.height))[0],s=u[1],o=(F=Be(e.borderBottomRightRadius,t.width,t.height))[0],i=F[1],Q=(h=Be(e.borderBottomLeftRadius,t.width,t.height))[0],c=h[1];(d=[]).push((r+n)/t.width),d.push((Q+o)/t.width),d.push((B+c)/t.height),d.push((s+i)/t.height),1<(f=Math.max.apply(Math,d))&&(r/=f,B/=f,n/=f,s/=f,o/=f,i/=f,Q/=f,c/=f);var a=t.width-n,g=t.height-i,w=t.width-o,U=t.height-c,l=e.borderTopWidth,C=e.borderRightWidth,u=e.borderBottomWidth,F=e.borderLeftWidth,h=Ue(e.paddingTop,A.bounds.width),d=Ue(e.paddingRight,A.bounds.width),f=Ue(e.paddingBottom,A.bounds.width),A=Ue(e.paddingLeft,A.bounds.width);this.topLeftBorderDoubleOuterBox=0<r||0<B?ss(t.left+F/3,t.top+l/3,r-F/3,B-l/3,As.TOP_LEFT):new Zn(t.left+F/3,t.top+l/3),this.topRightBorderDoubleOuterBox=0<r||0<B?ss(t.left+a,t.top+l/3,n-C/3,s-l/3,As.TOP_RIGHT):new Zn(t.left+t.width-C/3,t.top+l/3),this.bottomRightBorderDoubleOuterBox=0<o||0<i?ss(t.left+w,t.top+g,o-C/3,i-u/3,As.BOTTOM_RIGHT):new Zn(t.left+t.width-C/3,t.top+t.height-u/3),this.bottomLeftBorderDoubleOuterBox=0<Q||0<c?ss(t.left+F/3,t.top+U,Q-F/3,c-u/3,As.BOTTOM_LEFT):new Zn(t.left+F/3,t.top+t.height-u/3),this.topLeftBorderDoubleInnerBox=0<r||0<B?ss(t.left+2*F/3,t.top+2*l/3,r-2*F/3,B-2*l/3,As.TOP_LEFT):new Zn(t.left+2*F/3,t.top+2*l/3),this.topRightBorderDoubleInnerBox=0<r||0<B?ss(t.left+a,t.top+2*l/3,n-2*C/3,s-2*l/3,As.TOP_RIGHT):new Zn(t.left+t.width-2*C/3,t.top+2*l/3),this.bottomRightBorderDoubleInnerBox=0<o||0<i?ss(t.left+w,t.top+g,o-2*C/3,i-2*u/3,As.BOTTOM_RIGHT):new Zn(t.left+t.width-2*C/3,t.top+t.height-2*u/3),this.bottomLeftBorderDoubleInnerBox=0<Q||0<c?ss(t.left+2*F/3,t.top+U,Q-2*F/3,c-2*u/3,As.BOTTOM_LEFT):new Zn(t.left+2*F/3,t.top+t.height-2*u/3),this.topLeftBorderStroke=0<r||0<B?ss(t.left+F/2,t.top+l/2,r-F/2,B-l/2,As.TOP_LEFT):new Zn(t.left+F/2,t.top+l/2),this.topRightBorderStroke=0<r||0<B?ss(t.left+a,t.top+l/2,n-C/2,s-l/2,As.TOP_RIGHT):new Zn(t.left+t.width-C/2,t.top+l/2),this.bottomRightBorderStroke=0<o||0<i?ss(t.left+w,t.top+g,o-C/2,i-u/2,As.BOTTOM_RIGHT):new Zn(t.left+t.width-C/2,t.top+t.height-u/2),this.bottomLeftBorderStroke=0<Q||0<c?ss(t.left+F/2,t.top+U,Q-F/2,c-u/2,As.BOTTOM_LEFT):new Zn(t.left+F/2,t.top+t.height-u/2),this.topLeftBorderBox=0<r||0<B?ss(t.left,t.top,r,B,As.TOP_LEFT):new Zn(t.left,t.top),this.topRightBorderBox=0<n||0<s?ss(t.left+a,t.top,n,s,As.TOP_RIGHT):new Zn(t.left+t.width,t.top),this.bottomRightBorderBox=0<o||0<i?ss(t.left+w,t.top+g,o,i,As.BOTTOM_RIGHT):new Zn(t.left+t.width,t.top+t.height),this.bottomLeftBorderBox=0<Q||0<c?ss(t.left,t.top+U,Q,c,As.BOTTOM_LEFT):new Zn(t.left,t.top+t.height),this.topLeftPaddingBox=0<r||0<B?ss(t.left+F,t.top+l,Math.max(0,r-F),Math.max(0,B-l),As.TOP_LEFT):new Zn(t.left+F,t.top+l),this.topRightPaddingBox=0<n||0<s?ss(t.left+Math.min(a,t.width-C),t.top+l,a>t.width+C?0:Math.max(0,n-C),Math.max(0,s-l),As.TOP_RIGHT):new Zn(t.left+t.width-C,t.top+l),this.bottomRightPaddingBox=0<o||0<i?ss(t.left+Math.min(w,t.width-F),t.top+Math.min(g,t.height-u),Math.max(0,o-C),Math.max(0,i-u),As.BOTTOM_RIGHT):new Zn(t.left+t.width-C,t.top+t.height-u),this.bottomLeftPaddingBox=0<Q||0<c?ss(t.left+F,t.top+Math.min(U,t.height-u),Math.max(0,Q-F),Math.max(0,c-u),As.BOTTOM_LEFT):new Zn(t.left+F,t.top+t.height-u),this.topLeftContentBox=0<r||0<B?ss(t.left+F+A,t.top+l+h,Math.max(0,r-(F+A)),Math.max(0,B-(l+h)),As.TOP_LEFT):new Zn(t.left+F+A,t.top+l+h),this.topRightContentBox=0<n||0<s?ss(t.left+Math.min(a,t.width+F+A),t.top+l+h,a>t.width+F+A?0:n-F+A,s-(l+h),As.TOP_RIGHT):new Zn(t.left+t.width-(C+d),t.top+l+h),this.bottomRightContentBox=0<o||0<i?ss(t.left+Math.min(w,t.width-(F+A)),t.top+Math.min(g,t.height+l+h),Math.max(0,o-(C+d)),i-(u+f),As.BOTTOM_RIGHT):new Zn(t.left+t.width-(C+d),t.top+t.height-(u+f)),this.bottomLeftContentBox=0<Q||0<c?ss(t.left+F+A,t.top+U,Math.max(0,Q-(F+A)),c-(u+f),As.BOTTOM_LEFT):new Zn(t.left+F+A,t.top+t.height-(u+f))};(he=As=As||{})[he.TOP_LEFT=0]="TOP_LEFT",he[he.TOP_RIGHT=1]="TOP_RIGHT",he[he.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",he[he.BOTTOM_LEFT=3]="BOTTOM_LEFT";function ts(A){return[A.topLeftBorderBox,A.topRightBorderBox,A.bottomRightBorderBox,A.bottomLeftBorderBox]}function rs(A){return[A.topLeftPaddingBox,A.topRightPaddingBox,A.bottomRightPaddingBox,A.bottomLeftPaddingBox]}function Bs(A){return 1===A.type}function ns(A,t){return A.length===t.length&&A.some(function(A,e){return A===t[e]})}var ss=function(A,e,t,r,B){var n=(Math.sqrt(2)-1)/3*4,s=t*n,o=r*n,i=A+t,Q=e+r;switch(B){case As.TOP_LEFT:return new jn(new Zn(A,Q),new Zn(A,Q-o),new Zn(i-s,e),new Zn(i,e));case As.TOP_RIGHT:return new jn(new Zn(A,e),new Zn(A+s,e),new Zn(i,Q-o),new Zn(i,Q));case As.BOTTOM_RIGHT:return new jn(new Zn(i,e),new Zn(i,e+o),new Zn(A+s,Q),new Zn(A,Q));default:As.BOTTOM_LEFT;return new jn(new Zn(i,Q),new Zn(i-s,Q),new Zn(A,e+o),new Zn(A,e))}},os=function(A,e,t){this.offsetX=A,this.offsetY=e,this.matrix=t,this.type=0,this.target=6},is=function(A,e){this.path=A,this.target=e,this.type=1},Qs=function(A){this.opacity=A,this.type=2,this.target=6},cs=function(A){this.element=A,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]},as=(gs.prototype.getEffects=function(e){for(var A=-1===[2,3].indexOf(this.container.styles.position),t=this.parent,r=this.effects.slice(0);t;){var B,n,s=t.effects.filter(function(A){return!Bs(A)});A||0!==t.container.styles.position||!t.parent?(r.unshift.apply(r,s),A=-1===[2,3].indexOf(t.container.styles.position),0!==t.container.styles.overflowX&&(B=ts(t.curves),n=rs(t.curves),ns(B,n)||r.unshift(new is(n,6)))):r.unshift.apply(r,s),t=t.parent}return r.filter(function(A){return Pt(A.target,e)})},gs);function gs(A,e){var t,r;this.container=A,this.parent=e,this.effects=[],this.curves=new es(this.container),this.container.styles.opacity<1&&this.effects.push(new Qs(this.container.styles.opacity)),null!==this.container.styles.transform&&(e=this.container.bounds.left+this.container.styles.transformOrigin[0].number,t=this.container.bounds.top+this.container.styles.transformOrigin[1].number,r=this.container.styles.transform,this.effects.push(new os(e,t,r))),0!==this.container.styles.overflowX&&(t=ts(this.curves),r=rs(this.curves),ns(t,r)?this.effects.push(new is(t,6)):(this.effects.push(new is(t,2)),this.effects.push(new is(r,4))))}function ws(A,e){switch(e){case 0:return Hs(A.topLeftBorderBox,A.topLeftPaddingBox,A.topRightBorderBox,A.topRightPaddingBox);case 1:return Hs(A.topRightBorderBox,A.topRightPaddingBox,A.bottomRightBorderBox,A.bottomRightPaddingBox);case 2:return Hs(A.bottomRightBorderBox,A.bottomRightPaddingBox,A.bottomLeftBorderBox,A.bottomLeftPaddingBox);default:return Hs(A.bottomLeftBorderBox,A.bottomLeftPaddingBox,A.topLeftBorderBox,A.topLeftPaddingBox)}}function Us(A){var e=A.bounds,A=A.styles;return e.add(A.borderLeftWidth,A.borderTopWidth,-(A.borderRightWidth+A.borderLeftWidth),-(A.borderTopWidth+A.borderBottomWidth))}function ls(A){var e=A.styles,t=A.bounds,r=Ue(e.paddingLeft,t.width),B=Ue(e.paddingRight,t.width),n=Ue(e.paddingTop,t.width),A=Ue(e.paddingBottom,t.width);return t.add(r+e.borderLeftWidth,n+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+r+B),-(e.borderTopWidth+e.borderBottomWidth+n+A))}function Cs(A,e,t){var r=(B=Es(A.styles.backgroundOrigin,e),n=A,0===B?n.bounds:(2===B?ls:Us)(n)),B=(s=Es(A.styles.backgroundClip,e),o=A,0===s?o.bounds:(2===s?ls:Us)(o)),n=ps(Es(A.styles.backgroundSize,e),t,r),s=n[0],o=n[1],t=Be(Es(A.styles.backgroundPosition,e),r.width-s,r.height-o);return[Is(Es(A.styles.backgroundRepeat,e),t,n,r,B),Math.round(r.left+t[0]),Math.round(r.top+t[1]),s,o]}function us(A){return _A(A)&&A.value===Ve.AUTO}function Fs(A){return"number"==typeof A}var hs=function(Q,c,a,g){Q.container.elements.forEach(function(A){var e=Pt(A.flags,4),t=Pt(A.flags,2),r=new as(A,Q);Pt(A.styles.display,2048)&&g.push(r);var B,n,s,o,i=Pt(A.flags,8)?[]:g;e||t?(B=e||A.styles.isPositioned()?a:c,t=new cs(r),A.styles.isPositioned()||A.styles.opacity<1||A.styles.isTransformed()?(n=A.styles.zIndex.order)<0?(s=0,B.negativeZIndex.some(function(A,e){return n>A.element.container.styles.zIndex.order?(s=e,!1):0<s}),B.negativeZIndex.splice(s,0,t)):0<n?(o=0,B.positiveZIndex.some(function(A,e){return n>=A.element.container.styles.zIndex.order?(o=e+1,!1):0<o}),B.positiveZIndex.splice(o,0,t)):B.zeroOrAutoZIndexOrTransformedOrOpacity.push(t):(A.styles.isFloating()?B.nonPositionedFloats:B.nonPositionedInlineLevel).push(t),hs(r,t,e?t:a,i)):((A.styles.isInlineLevel()?c.inlineLevel:c.nonInlineLevel).push(r),hs(r,c,a,i)),Pt(A.flags,8)&&ds(A,i)})},ds=function(A,e){for(var t=A instanceof UB?A.start:1,r=A instanceof UB&&A.reversed,B=0;B<e.length;B++){var n=e[B];n.container instanceof aB&&"number"==typeof n.container.value&&0!==n.container.value&&(t=n.container.value),n.listValue=Fn(t,n.container.styles.listStyleType,!0),t+=r?-1:1}},fs=function(A,e){var t=[];return $n(A)?t.push(A.subdivide(.5,!1)):t.push(A),$n(e)?t.push(e.subdivide(.5,!0)):t.push(e),t},Hs=function(A,e,t,r){var B=[];return $n(A)?B.push(A.subdivide(.5,!1)):B.push(A),$n(t)?B.push(t.subdivide(.5,!0)):B.push(t),$n(r)?B.push(r.subdivide(.5,!0).reverse()):B.push(r),$n(e)?B.push(e.subdivide(.5,!1).reverse()):B.push(e),B},ps=function(A,e,t){var r=e[0],B=e[1],n=e[2],s=A[0],o=A[1];if(!s)return[0,0];if(te(s)&&o&&te(o))return[Ue(s,t.width),Ue(o,t.height)];var i=Fs(n);if(_A(s)&&(s.value===Ve.CONTAIN||s.value===Ve.COVER))return Fs(n)?t.width/t.height<n!=(s.value===Ve.COVER)?[t.width,t.width/n]:[t.height*n,t.height]:[t.width,t.height];var Q=Fs(r),e=Fs(B),A=Q||e;if(us(s)&&(!o||us(o)))return Q&&e?[r,B]:i||A?A&&i?[Q?r:B*n,e?B:r/n]:[Q?r:t.width,e?B:t.height]:[t.width,t.height];if(i){var c=0,a=0;return te(s)?c=Ue(s,t.width):te(o)&&(a=Ue(o,t.height)),us(s)?c=a*n:o&&!us(o)||(a=c/n),[c,a]}c=null,a=null;if(te(s)?c=Ue(s,t.width):o&&te(o)&&(a=Ue(o,t.height)),null!==(c=null!==(a=null!==c&&(!o||us(o))?Q&&e?c/r*B:t.height:a)&&us(s)?Q&&e?a/B*r:t.width:c)&&null!==a)return[c,a];throw new Error("Unable to calculate background-size for element")},Es=function(A,e){e=A[e];return void 0===e?A[0]:e},Is=function(A,e,t,r,B){var n=e[0],s=e[1],o=t[0],i=t[1];switch(A){case 2:return[new Zn(Math.round(r.left),Math.round(r.top+s)),new Zn(Math.round(r.left+r.width),Math.round(r.top+s)),new Zn(Math.round(r.left+r.width),Math.round(i+r.top+s)),new Zn(Math.round(r.left),Math.round(i+r.top+s))];case 3:return[new Zn(Math.round(r.left+n),Math.round(r.top)),new Zn(Math.round(r.left+n+o),Math.round(r.top)),new Zn(Math.round(r.left+n+o),Math.round(r.height+r.top)),new Zn(Math.round(r.left+n),Math.round(r.height+r.top))];case 1:return[new Zn(Math.round(r.left+n),Math.round(r.top+s)),new Zn(Math.round(r.left+n+o),Math.round(r.top+s)),new Zn(Math.round(r.left+n+o),Math.round(r.top+s+i)),new Zn(Math.round(r.left+n),Math.round(r.top+s+i))];default:return[new Zn(Math.round(B.left),Math.round(B.top)),new Zn(Math.round(B.left+B.width),Math.round(B.top)),new Zn(Math.round(B.left+B.width),Math.round(B.height+B.top)),new Zn(Math.round(B.left),Math.round(B.height+B.top))]}},ys="Hidden Text",Ks=(ms.prototype.parseMetrics=function(A,e){var t=this._document.createElement("div"),r=this._document.createElement("img"),B=this._document.createElement("span"),n=this._document.body;t.style.visibility="hidden",t.style.fontFamily=A,t.style.fontSize=e,t.style.margin="0",t.style.padding="0",t.style.whiteSpace="nowrap",n.appendChild(t),r.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",r.width=1,r.height=1,r.style.margin="0",r.style.padding="0",r.style.verticalAlign="baseline",B.style.fontFamily=A,B.style.fontSize=e,B.style.margin="0",B.style.padding="0",B.appendChild(this._document.createTextNode(ys)),t.appendChild(B),t.appendChild(r);e=r.offsetTop-B.offsetTop+2;t.removeChild(B),t.appendChild(this._document.createTextNode(ys)),t.style.lineHeight="normal",r.style.verticalAlign="super";r=r.offsetTop-t.offsetTop+2;return n.removeChild(t),{baseline:e,middle:r}},ms.prototype.getMetrics=function(A,e){var t=A+" "+e;return void 0===this._data[t]&&(this._data[t]=this.parseMetrics(A,e)),this._data[t]},ms);function ms(A){this._data={},this._document=A}var Ls,he=function(A,e){this.context=A,this.options=e},bs=(A(Ds,Ls=he),Ds.prototype.applyEffects=function(A){for(var e=this;this._activeEffects.length;)this.popEffect();A.forEach(function(A){return e.applyEffect(A)})},Ds.prototype.applyEffect=function(A){this.ctx.save(),2===A.type&&(this.ctx.globalAlpha=A.opacity),0===A.type&&(this.ctx.translate(A.offsetX,A.offsetY),this.ctx.transform(A.matrix[0],A.matrix[1],A.matrix[2],A.matrix[3],A.matrix[4],A.matrix[5]),this.ctx.translate(-A.offsetX,-A.offsetY)),Bs(A)&&(this.path(A.path),this.ctx.clip()),this._activeEffects.push(A)},Ds.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},Ds.prototype.renderStack=function(e){return a(this,void 0,void 0,function(){return H(this,function(A){switch(A.label){case 0:return e.element.container.styles.isVisible()?[4,this.renderStackContent(e)]:[3,2];case 1:A.sent(),A.label=2;case 2:return[2]}})})},Ds.prototype.renderNode=function(e){return a(this,void 0,void 0,function(){return H(this,function(A){switch(A.label){case 0:return Pt(e.container.flags,16),e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return A.sent(),[4,this.renderNodeContent(e)];case 2:A.sent(),A.label=3;case 3:return[2]}})})},Ds.prototype.renderTextWithLetterSpacing=function(t,A,r){var B=this;0===A?this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+r):Zr(t.text).reduce(function(A,e){return B.ctx.fillText(e,A,t.bounds.top+r),A+B.ctx.measureText(e).width},t.bounds.left)},Ds.prototype.createFontStyle=function(A){var e=A.fontVariant.filter(function(A){return"normal"===A||"small-caps"===A}).join(""),t=Gs(A.fontFamily).join(", "),r=WA(A.fontSize)?""+A.fontSize.number+A.fontSize.unit:A.fontSize.number+"px";return[[A.fontStyle,e,A.fontWeight,r,t].join(" "),t,r]},Ds.prototype.renderTextNode=function(i,Q){return a(this,void 0,void 0,function(){var e,t,r,B,n,s,o=this;return H(this,function(A){return r=this.createFontStyle(Q),e=r[0],t=r[1],r=r[2],this.ctx.font=e,this.ctx.direction=1===Q.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",r=this.fontMetrics.getMetrics(t,r),B=r.baseline,n=r.middle,s=Q.paintOrder,i.textBounds.forEach(function(t){s.forEach(function(A){switch(A){case 0:o.ctx.fillStyle=ie(Q.color),o.renderTextWithLetterSpacing(t,Q.letterSpacing,B);var e=Q.textShadow;e.length&&t.text.trim().length&&(e.slice(0).reverse().forEach(function(A){o.ctx.shadowColor=ie(A.color),o.ctx.shadowOffsetX=A.offsetX.number*o.options.scale,o.ctx.shadowOffsetY=A.offsetY.number*o.options.scale,o.ctx.shadowBlur=A.blur.number,o.renderTextWithLetterSpacing(t,Q.letterSpacing,B)}),o.ctx.shadowColor="",o.ctx.shadowOffsetX=0,o.ctx.shadowOffsetY=0,o.ctx.shadowBlur=0),Q.textDecorationLine.length&&(o.ctx.fillStyle=ie(Q.textDecorationColor||Q.color),Q.textDecorationLine.forEach(function(A){switch(A){case 1:o.ctx.fillRect(t.bounds.left,Math.round(t.bounds.top+B),t.bounds.width,1);break;case 2:o.ctx.fillRect(t.bounds.left,Math.round(t.bounds.top),t.bounds.width,1);break;case 3:o.ctx.fillRect(t.bounds.left,Math.ceil(t.bounds.top+n),t.bounds.width,1)}}));break;case 1:Q.webkitTextStrokeWidth&&t.text.trim().length&&(o.ctx.strokeStyle=ie(Q.webkitTextStrokeColor),o.ctx.lineWidth=Q.webkitTextStrokeWidth,o.ctx.lineJoin=window.chrome?"miter":"round",o.ctx.strokeText(t.text,t.bounds.left,t.bounds.top+B)),o.ctx.strokeStyle="",o.ctx.lineWidth=0,o.ctx.lineJoin="miter"}})}),[2]})})},Ds.prototype.renderReplacedElement=function(A,e,t){var r;t&&0<A.intrinsicWidth&&0<A.intrinsicHeight&&(r=ls(A),e=rs(e),this.path(e),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(t,0,0,A.intrinsicWidth,A.intrinsicHeight,r.left,r.top,r.width,r.height),this.ctx.restore())},Ds.prototype.renderNodeContent=function(w){return a(this,void 0,void 0,function(){var e,t,r,B,n,s,o,i,Q,c,a,g;return H(this,function(A){switch(A.label){case 0:this.applyEffects(w.getEffects(4)),e=w.container,t=w.curves,r=e.styles,B=0,n=e.textNodes,A.label=1;case 1:return B<n.length?(s=n[B],[4,this.renderTextNode(s,r)]):[3,4];case 2:A.sent(),A.label=3;case 3:return B++,[3,1];case 4:if(!(e instanceof tB))return[3,8];A.label=5;case 5:return A.trys.push([5,7,,8]),[4,this.context.cache.match(e.src)];case 6:return Q=A.sent(),this.renderReplacedElement(e,t,Q),[3,8];case 7:return A.sent(),this.context.logger.error("Error loading image "+e.src),[3,8];case 8:if(e instanceof nB&&this.renderReplacedElement(e,t,e.canvas),!(e instanceof iB))return[3,12];A.label=9;case 9:return A.trys.push([9,11,,12]),[4,this.context.cache.match(e.svg)];case 10:return Q=A.sent(),this.renderReplacedElement(e,t,Q),[3,12];case 11:return A.sent(),this.context.logger.error("Error loading svg "+e.svg.substring(0,255)),[3,12];case 12:return e instanceof vB&&e.tree?[4,new Ds(this.context,{scale:this.options.scale,backgroundColor:e.backgroundColor,x:0,y:0,width:e.width,height:e.height}).render(e.tree)]:[3,14];case 13:s=A.sent(),e.width&&e.height&&this.ctx.drawImage(s,0,0,e.width,e.height,e.bounds.left,e.bounds.top,e.bounds.width,e.bounds.height),A.label=14;case 14:if(e instanceof pB&&(i=Math.min(e.bounds.width,e.bounds.height),e.type===hB?e.checked&&(this.ctx.save(),this.path([new Zn(e.bounds.left+.39363*i,e.bounds.top+.79*i),new Zn(e.bounds.left+.16*i,e.bounds.top+.5549*i),new Zn(e.bounds.left+.27347*i,e.bounds.top+.44071*i),new Zn(e.bounds.left+.39694*i,e.bounds.top+.5649*i),new Zn(e.bounds.left+.72983*i,e.bounds.top+.23*i),new Zn(e.bounds.left+.84*i,e.bounds.top+.34085*i),new Zn(e.bounds.left+.39363*i,e.bounds.top+.79*i)]),this.ctx.fillStyle=ie(HB),this.ctx.fill(),this.ctx.restore()):e.type===dB&&e.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(e.bounds.left+i/2,e.bounds.top+i/2,i/4,0,2*Math.PI,!0),this.ctx.fillStyle=ie(HB),this.ctx.fill(),this.ctx.restore())),xs(e)&&e.value.length){switch(c=this.createFontStyle(r),a=c[0],i=c[1],c=this.fontMetrics.getMetrics(a,i).baseline,this.ctx.font=a,this.ctx.fillStyle=ie(r.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Ss(e.styles.textAlign),g=ls(e),o=0,e.styles.textAlign){case 1:o+=g.width/2;break;case 2:o+=g.width}i=g.add(o,0,0,-g.height/2+1),this.ctx.save(),this.path([new Zn(g.left,g.top),new Zn(g.left+g.width,g.top),new Zn(g.left+g.width,g.top+g.height),new Zn(g.left,g.top+g.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Jr(e.value,i),r.letterSpacing,c),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Pt(e.styles.display,2048))return[3,20];if(null===e.styles.listStyleImage)return[3,19];if(0!==(c=e.styles.listStyleImage).type)return[3,18];Q=void 0,c=c.url,A.label=15;case 15:return A.trys.push([15,17,,18]),[4,this.context.cache.match(c)];case 16:return Q=A.sent(),this.ctx.drawImage(Q,e.bounds.left-(Q.width+10),e.bounds.top),[3,18];case 17:return A.sent(),this.context.logger.error("Error loading list-style-image "+c),[3,18];case 18:return[3,20];case 19:w.listValue&&-1!==e.styles.listStyleType&&(a=this.createFontStyle(r)[0],this.ctx.font=a,this.ctx.fillStyle=ie(r.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",g=new d(e.bounds.left,e.bounds.top+Ue(e.styles.paddingTop,e.bounds.width),e.bounds.width,Ye(r.lineHeight,r.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Jr(w.listValue,g),r.letterSpacing,Ye(r.lineHeight,r.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),A.label=20;case 20:return[2]}})})},Ds.prototype.renderStackContent=function(C){return a(this,void 0,void 0,function(){var e,t,r,B,n,s,o,i,Q,c,a,g,w,U,l;return H(this,function(A){switch(A.label){case 0:return Pt(C.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(C.element)];case 1:A.sent(),e=0,t=C.negativeZIndex,A.label=2;case 2:return e<t.length?(l=t[e],[4,this.renderStack(l)]):[3,5];case 3:A.sent(),A.label=4;case 4:return e++,[3,2];case 5:return[4,this.renderNodeContent(C.element)];case 6:A.sent(),r=0,B=C.nonInlineLevel,A.label=7;case 7:return r<B.length?(l=B[r],[4,this.renderNode(l)]):[3,10];case 8:A.sent(),A.label=9;case 9:return r++,[3,7];case 10:n=0,s=C.nonPositionedFloats,A.label=11;case 11:return n<s.length?(l=s[n],[4,this.renderStack(l)]):[3,14];case 12:A.sent(),A.label=13;case 13:return n++,[3,11];case 14:o=0,i=C.nonPositionedInlineLevel,A.label=15;case 15:return o<i.length?(l=i[o],[4,this.renderStack(l)]):[3,18];case 16:A.sent(),A.label=17;case 17:return o++,[3,15];case 18:Q=0,c=C.inlineLevel,A.label=19;case 19:return Q<c.length?(l=c[Q],[4,this.renderNode(l)]):[3,22];case 20:A.sent(),A.label=21;case 21:return Q++,[3,19];case 22:a=0,g=C.zeroOrAutoZIndexOrTransformedOrOpacity,A.label=23;case 23:return a<g.length?(l=g[a],[4,this.renderStack(l)]):[3,26];case 24:A.sent(),A.label=25;case 25:return a++,[3,23];case 26:w=0,U=C.positiveZIndex,A.label=27;case 27:return w<U.length?(l=U[w],[4,this.renderStack(l)]):[3,30];case 28:A.sent(),A.label=29;case 29:return w++,[3,27];case 30:return[2]}})})},Ds.prototype.mask=function(A){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(A.slice(0).reverse()),this.ctx.closePath()},Ds.prototype.path=function(A){this.ctx.beginPath(),this.formatPath(A),this.ctx.closePath()},Ds.prototype.formatPath=function(A){var r=this;A.forEach(function(A,e){var t=$n(A)?A.start:A;0===e?r.ctx.moveTo(t.x,t.y):r.ctx.lineTo(t.x,t.y),$n(A)&&r.ctx.bezierCurveTo(A.startControl.x,A.startControl.y,A.endControl.x,A.endControl.y,A.end.x,A.end.y)})},Ds.prototype.renderRepeat=function(A,e,t,r){this.path(A),this.ctx.fillStyle=e,this.ctx.translate(t,r),this.ctx.fill(),this.ctx.translate(-t,-r)},Ds.prototype.resizeImage=function(A,e,t){if(A.width===e&&A.height===t)return A;var r=(null!==(r=this.canvas.ownerDocument)&&void 0!==r?r:document).createElement("canvas");return r.width=Math.max(1,e),r.height=Math.max(1,t),r.getContext("2d").drawImage(A,0,0,A.width,A.height,0,0,e,t),r},Ds.prototype.renderBackgroundImage=function(f){return a(this,void 0,void 0,function(){var h,e,d,t,r,B;return H(this,function(A){switch(A.label){case 0:h=f.styles.backgroundImage.length-1,e=function(e){var t,r,B,n,s,o,i,Q,c,a,g,w,U,l,C,u,F;return H(this,function(A){switch(A.label){case 0:if(0!==e.type)return[3,5];t=void 0,r=e.url,A.label=1;case 1:return A.trys.push([1,3,,4]),[4,d.context.cache.match(r)];case 2:return t=A.sent(),[3,4];case 3:return A.sent(),d.context.logger.error("Error loading background-image "+r),[3,4];case 4:return t&&(B=Cs(f,h,[t.width,t.height,t.width/t.height]),o=B[0],g=B[1],w=B[2],c=B[3],a=B[4],s=d.ctx.createPattern(d.resizeImage(t,c,a),"repeat"),d.renderRepeat(o,s,g,w)),[3,6];case 5:1===e.type?(F=Cs(f,h,[null,null,null]),o=F[0],g=F[1],w=F[2],c=F[3],a=F[4],C=Ee(e.angle,c,a),l=C[0],B=C[1],i=C[2],u=C[3],Q=C[4],(F=document.createElement("canvas")).width=c,F.height=a,C=F.getContext("2d"),n=C.createLinearGradient(B,u,i,Q),pe(e.stops,l).forEach(function(A){return n.addColorStop(A.stop,ie(A.color))}),C.fillStyle=n,C.fillRect(0,0,c,a),0<c&&0<a&&(s=d.ctx.createPattern(F,"repeat"),d.renderRepeat(o,s,g,w))):2===e.type&&(u=Cs(f,h,[null,null,null]),o=u[0],i=u[1],Q=u[2],c=u[3],a=u[4],l=0===e.position.length?[ge]:e.position,g=Ue(l[0],c),w=Ue(l[l.length-1],a),C=function(A,e,t,r,B){var n,s,o,i,Q=0,c=0;switch(A.size){case 0:0===A.shape?Q=c=Math.min(Math.abs(e),Math.abs(e-r),Math.abs(t),Math.abs(t-B)):1===A.shape&&(Q=Math.min(Math.abs(e),Math.abs(e-r)),c=Math.min(Math.abs(t),Math.abs(t-B)));break;case 2:0===A.shape?Q=c=Math.min(Ie(e,t),Ie(e,t-B),Ie(e-r,t),Ie(e-r,t-B)):1===A.shape&&(n=Math.min(Math.abs(t),Math.abs(t-B))/Math.min(Math.abs(e),Math.abs(e-r)),o=(s=ye(r,B,e,t,!0))[0],i=s[1],c=n*(Q=Ie(o-e,(i-t)/n)));break;case 1:0===A.shape?Q=c=Math.max(Math.abs(e),Math.abs(e-r),Math.abs(t),Math.abs(t-B)):1===A.shape&&(Q=Math.max(Math.abs(e),Math.abs(e-r)),c=Math.max(Math.abs(t),Math.abs(t-B)));break;case 3:0===A.shape?Q=c=Math.max(Ie(e,t),Ie(e,t-B),Ie(e-r,t),Ie(e-r,t-B)):1===A.shape&&(n=Math.max(Math.abs(t),Math.abs(t-B))/Math.max(Math.abs(e),Math.abs(e-r)),o=(s=ye(r,B,e,t,!1))[0],i=s[1],c=n*(Q=Ie(o-e,(i-t)/n)))}return Array.isArray(A.size)&&(Q=Ue(A.size[0],r),c=2===A.size.length?Ue(A.size[1],B):Q),[Q,c]}(e,g,w,c,a),F=C[0],u=C[1],0<F&&0<u&&(U=d.ctx.createRadialGradient(i+g,Q+w,0,i+g,Q+w,F),pe(e.stops,2*F).forEach(function(A){return U.addColorStop(A.stop,ie(A.color))}),d.path(o),d.ctx.fillStyle=U,F!==u?(l=f.bounds.left+.5*f.bounds.width,C=f.bounds.top+.5*f.bounds.height,F=1/(u=u/F),d.ctx.save(),d.ctx.translate(l,C),d.ctx.transform(1,0,0,u,0,0),d.ctx.translate(-l,-C),d.ctx.fillRect(i,F*(Q-C)+C,c,a*F),d.ctx.restore()):d.ctx.fill())),A.label=6;case 6:return h--,[2]}})},d=this,t=0,r=f.styles.backgroundImage.slice(0).reverse(),A.label=1;case 1:return t<r.length?(B=r[t],[5,e(B)]):[3,4];case 2:A.sent(),A.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},Ds.prototype.renderSolidBorder=function(e,t,r){return a(this,void 0,void 0,function(){return H(this,function(A){return this.path(ws(r,t)),this.ctx.fillStyle=ie(e),this.ctx.fill(),[2]})})},Ds.prototype.renderDoubleBorder=function(t,r,B,n){return a(this,void 0,void 0,function(){var e;return H(this,function(A){switch(A.label){case 0:return r<3?[4,this.renderSolidBorder(t,B,n)]:[3,2];case 1:return A.sent(),[2];case 2:return e=function(A,e){switch(e){case 0:return Hs(A.topLeftBorderBox,A.topLeftBorderDoubleOuterBox,A.topRightBorderBox,A.topRightBorderDoubleOuterBox);case 1:return Hs(A.topRightBorderBox,A.topRightBorderDoubleOuterBox,A.bottomRightBorderBox,A.bottomRightBorderDoubleOuterBox);case 2:return Hs(A.bottomRightBorderBox,A.bottomRightBorderDoubleOuterBox,A.bottomLeftBorderBox,A.bottomLeftBorderDoubleOuterBox);default:return Hs(A.bottomLeftBorderBox,A.bottomLeftBorderDoubleOuterBox,A.topLeftBorderBox,A.topLeftBorderDoubleOuterBox)}}(n,B),this.path(e),this.ctx.fillStyle=ie(t),this.ctx.fill(),e=function(A,e){switch(e){case 0:return Hs(A.topLeftBorderDoubleInnerBox,A.topLeftPaddingBox,A.topRightBorderDoubleInnerBox,A.topRightPaddingBox);case 1:return Hs(A.topRightBorderDoubleInnerBox,A.topRightPaddingBox,A.bottomRightBorderDoubleInnerBox,A.bottomRightPaddingBox);case 2:return Hs(A.bottomRightBorderDoubleInnerBox,A.bottomRightPaddingBox,A.bottomLeftBorderDoubleInnerBox,A.bottomLeftPaddingBox);default:return Hs(A.bottomLeftBorderDoubleInnerBox,A.bottomLeftPaddingBox,A.topLeftBorderDoubleInnerBox,A.topLeftPaddingBox)}}(n,B),this.path(e),this.ctx.fill(),[2]}})})},Ds.prototype.renderNodeBackgroundAndBorders=function(c){return a(this,void 0,void 0,function(){var e,t,r,B,n,s,o,i,Q=this;return H(this,function(A){switch(A.label){case 0:return(this.applyEffects(c.getEffects(2)),e=c.container.styles,t=!oe(e.backgroundColor)||e.backgroundImage.length,r=[{style:e.borderTopStyle,color:e.borderTopColor,width:e.borderTopWidth},{style:e.borderRightStyle,color:e.borderRightColor,width:e.borderRightWidth},{style:e.borderBottomStyle,color:e.borderBottomColor,width:e.borderBottomWidth},{style:e.borderLeftStyle,color:e.borderLeftColor,width:e.borderLeftWidth}],B=Ms(Es(e.backgroundClip,0),c.curves),t||e.boxShadow.length)?(this.ctx.save(),this.path(B),this.ctx.clip(),oe(e.backgroundColor)||(this.ctx.fillStyle=ie(e.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(c.container)]):[3,2];case 1:A.sent(),this.ctx.restore(),e.boxShadow.slice(0).reverse().forEach(function(A){Q.ctx.save();var t,r,B,n,e=ts(c.curves),s=A.inset?0:1e4,o=(t=-s+(A.inset?1:-1)*A.spread.number,r=(A.inset?1:-1)*A.spread.number,B=A.spread.number*(A.inset?-2:2),n=A.spread.number*(A.inset?-2:2),e.map(function(A,e){switch(e){case 0:return A.add(t,r);case 1:return A.add(t+B,r);case 2:return A.add(t+B,r+n);case 3:return A.add(t,r+n)}return A}));A.inset?(Q.path(e),Q.ctx.clip(),Q.mask(o)):(Q.mask(e),Q.ctx.clip(),Q.path(o)),Q.ctx.shadowOffsetX=A.offsetX.number+s,Q.ctx.shadowOffsetY=A.offsetY.number,Q.ctx.shadowColor=ie(A.color),Q.ctx.shadowBlur=A.blur.number,Q.ctx.fillStyle=A.inset?ie(A.color):"rgba(0,0,0,1)",Q.ctx.fill(),Q.ctx.restore()}),A.label=2;case 2:s=n=0,o=r,A.label=3;case 3:return s<o.length?0!==(i=o[s]).style&&!oe(i.color)&&0<i.width?2!==i.style?[3,5]:[4,this.renderDashedDottedBorder(i.color,i.width,n,c.curves,2)]:[3,11]:[3,13];case 4:return A.sent(),[3,11];case 5:return 3!==i.style?[3,7]:[4,this.renderDashedDottedBorder(i.color,i.width,n,c.curves,3)];case 6:return A.sent(),[3,11];case 7:return 4!==i.style?[3,9]:[4,this.renderDoubleBorder(i.color,i.width,n,c.curves)];case 8:return A.sent(),[3,11];case 9:return[4,this.renderSolidBorder(i.color,n,c.curves)];case 10:A.sent(),A.label=11;case 11:n++,A.label=12;case 12:return s++,[3,3];case 13:return[2]}})})},Ds.prototype.renderDashedDottedBorder=function(g,w,U,l,C){return a(this,void 0,void 0,function(){var e,t,r,B,n,s,o,i,Q,c,a;return H(this,function(A){return this.ctx.save(),Q=function(A,e){switch(e){case 0:return fs(A.topLeftBorderStroke,A.topRightBorderStroke);case 1:return fs(A.topRightBorderStroke,A.bottomRightBorderStroke);case 2:return fs(A.bottomRightBorderStroke,A.bottomLeftBorderStroke);default:return fs(A.bottomLeftBorderStroke,A.topLeftBorderStroke)}}(l,U),e=ws(l,U),2===C&&(this.path(e),this.ctx.clip()),s=$n(e[0])?(t=e[0].start.x,e[0].start.y):(t=e[0].x,e[0].y),o=$n(e[1])?(r=e[1].end.x,e[1].end.y):(r=e[1].x,e[1].y),B=0===U||2===U?Math.abs(t-r):Math.abs(s-o),this.ctx.beginPath(),3===C?this.formatPath(Q):this.formatPath(e.slice(0,2)),n=w<3?3*w:2*w,s=w<3?2*w:w,3===C&&(s=n=w),o=!0,B<=2*n?o=!1:B<=2*n+s?(n*=i=B/(2*n+s),s*=i):(Q=Math.floor((B+s)/(n+s)),i=(B-Q*n)/(Q-1),s=(Q=(B-(Q+1)*n)/Q)<=0||Math.abs(s-i)<Math.abs(s-Q)?i:Q),o&&(3===C?this.ctx.setLineDash([0,n+s]):this.ctx.setLineDash([n,s])),3===C?(this.ctx.lineCap="round",this.ctx.lineWidth=w):this.ctx.lineWidth=2*w+1.1,this.ctx.strokeStyle=ie(g),this.ctx.stroke(),this.ctx.setLineDash([]),2===C&&($n(e[0])&&(c=e[3],a=e[0],this.ctx.beginPath(),this.formatPath([new Zn(c.end.x,c.end.y),new Zn(a.start.x,a.start.y)]),this.ctx.stroke()),$n(e[1])&&(c=e[1],a=e[2],this.ctx.beginPath(),this.formatPath([new Zn(c.end.x,c.end.y),new Zn(a.start.x,a.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},Ds.prototype.render=function(B){return a(this,void 0,void 0,function(){return H(this,function(A){switch(A.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=ie(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),t=new as(e=B,null),r=new cs(t),hs(t,r,r,e=[]),ds(t.container,e),[4,this.renderStack(r)];case 1:return A.sent(),this.applyEffects([]),[2,this.canvas]}var e,t,r})})},Ds);function Ds(A,e){A=Ls.call(this,A,e)||this;return A._activeEffects=[],A.canvas=e.canvas||document.createElement("canvas"),A.ctx=A.canvas.getContext("2d"),e.canvas||(A.canvas.width=Math.floor(e.width*e.scale),A.canvas.height=Math.floor(e.height*e.scale),A.canvas.style.width=e.width+"px",A.canvas.style.height=e.height+"px"),A.fontMetrics=new Ks(document),A.ctx.scale(A.options.scale,A.options.scale),A.ctx.translate(-e.x,-e.y),A.ctx.textBaseline="bottom",A._activeEffects=[],A.context.logger.debug("Canvas renderer initialized ("+e.width+"x"+e.height+") with scale "+e.scale),A}var vs,xs=function(A){return A instanceof LB||(A instanceof yB||A instanceof pB&&A.type!==dB&&A.type!==hB)},Ms=function(A,e){switch(A){case 0:return ts(e);case 2:return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox];default:return rs(e)}},Ss=function(A){switch(A){case 1:return"center";case 2:return"right";default:return"left"}},Ts=["-apple-system","system-ui"],Gs=function(A){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?A.filter(function(A){return-1===Ts.indexOf(A)}):A},Os=(A(Vs,vs=he),Vs.prototype.render=function(t){return a(this,void 0,void 0,function(){var e;return H(this,function(A){switch(A.label){case 0:return e=Nr(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,ks(e)];case 1:return e=A.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=ie(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(e,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},Vs);function Vs(A,e){A=vs.call(this,A,e)||this;return A.canvas=e.canvas||document.createElement("canvas"),A.ctx=A.canvas.getContext("2d"),A.options=e,A.canvas.width=Math.floor(e.width*e.scale),A.canvas.height=Math.floor(e.height*e.scale),A.canvas.style.width=e.width+"px",A.canvas.style.height=e.height+"px",A.ctx.scale(A.options.scale,A.options.scale),A.ctx.translate(-e.x,-e.y),A.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+e.width+"x"+e.height+" at "+e.x+","+e.y+") with scale "+e.scale),A}var ks=function(r){return new Promise(function(A,e){var t=new Image;t.onload=function(){A(t)},t.onerror=e,t.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(r))})},Rs=(Ns.prototype.debug=function(){for(var A=[],e=0;e<arguments.length;e++)A[e]=arguments[e];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.debug?console.debug.apply(console,t([this.id,this.getTime()+"ms"],A)):this.info.apply(this,A))},Ns.prototype.getTime=function(){return Date.now()-this.start},Ns.prototype.info=function(){for(var A=[],e=0;e<arguments.length;e++)A[e]=arguments[e];this.enabled&&"undefined"!=typeof window&&window.console&&"function"==typeof console.info&&console.info.apply(console,t([this.id,this.getTime()+"ms"],A))},Ns.prototype.warn=function(){for(var A=[],e=0;e<arguments.length;e++)A[e]=arguments[e];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.warn?console.warn.apply(console,t([this.id,this.getTime()+"ms"],A)):this.info.apply(this,A))},Ns.prototype.error=function(){for(var A=[],e=0;e<arguments.length;e++)A[e]=arguments[e];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.error?console.error.apply(console,t([this.id,this.getTime()+"ms"],A)):this.info.apply(this,A))},Ns.instances={},Ns);function Ns(A){var e=A.id,A=A.enabled;this.id=e,this.enabled=A,this.start=Date.now()}var Ps=(Xs.instanceCount=1,Xs);function Xs(A,e){this.windowBounds=e,this.instanceName="#"+Xs.instanceCount++,this.logger=new Rs({id:this.instanceName,enabled:A.logging}),this.cache=null!==(e=A.cache)&&void 0!==e?e:new On(this,A)}"undefined"!=typeof window&&Tn.setContext(window);var Js=function(u,F){return a(void 0,void 0,void 0,function(){var e,t,r,B,n,s,o,i,Q,c,a,g,w,U,l,C;return H(this,function(A){switch(A.label){case 0:if(!u||"object"!=typeof u)return[2,Promise.reject("Invalid element provided as first argument")];if(!(e=u.ownerDocument))throw new Error("Element is not attached to a Document");if(!(t=e.defaultView))throw new Error("Document is not attached to a Window");return w={allowTaint:null!==(U=F.allowTaint)&&void 0!==U&&U,imageTimeout:null!==(c=F.imageTimeout)&&void 0!==c?c:15e3,proxy:F.proxy,useCORS:null!==(a=F.useCORS)&&void 0!==a&&a},U=h({logging:null===(g=F.logging)||void 0===g||g,cache:F.cache},w),c={windowWidth:null!==(c=F.windowWidth)&&void 0!==c?c:t.innerWidth,windowHeight:null!==(a=F.windowHeight)&&void 0!==a?a:t.innerHeight,scrollX:null!==(g=F.scrollX)&&void 0!==g?g:t.pageXOffset,scrollY:null!==(w=F.scrollY)&&void 0!==w?w:t.pageYOffset},a=new d(c.scrollX,c.scrollY,c.windowWidth,c.windowHeight),g=new Ps(U,a),c=null!==(w=F.foreignObjectRendering)&&void 0!==w&&w,w={allowTaint:null!==(U=F.allowTaint)&&void 0!==U&&U,onclone:F.onclone,ignoreElements:F.ignoreElements,inlineImages:c,copyStyles:c},g.logger.debug("Starting document clone with size "+a.width+"x"+a.height+" scrolled to "+-a.left+","+-a.top),U=new dn(g,u,w),(w=U.clonedReferenceElement)?[4,U.toIFrame(e,a)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return(r=A.sent(),l=jB(w)||"HTML"===w.tagName?function(A){var e=A.body,t=A.documentElement;if(!e||!t)throw new Error("Unable to get document size");A=Math.max(Math.max(e.scrollWidth,t.scrollWidth),Math.max(e.offsetWidth,t.offsetWidth),Math.max(e.clientWidth,t.clientWidth)),t=Math.max(Math.max(e.scrollHeight,t.scrollHeight),Math.max(e.offsetHeight,t.offsetHeight),Math.max(e.clientHeight,t.clientHeight));return new d(0,0,A,t)}(w.ownerDocument):f(g,w),B=l.width,n=l.height,s=l.left,o=l.top,i=Ys(g,w,F.backgroundColor),l={canvas:F.canvas,backgroundColor:i,scale:null!==(l=null!==(l=F.scale)&&void 0!==l?l:t.devicePixelRatio)&&void 0!==l?l:1,x:(null!==(l=F.x)&&void 0!==l?l:0)+s,y:(null!==(l=F.y)&&void 0!==l?l:0)+o,width:null!==(l=F.width)&&void 0!==l?l:Math.ceil(B),height:null!==(l=F.height)&&void 0!==l?l:Math.ceil(n)},c)?(g.logger.debug("Document cloned, using foreign object rendering"),[4,new Os(g,l).render(w)]):[3,3];case 2:return Q=A.sent(),[3,5];case 3:return g.logger.debug("Document cloned, element located at "+s+","+o+" with size "+B+"x"+n+" using computed rendering"),g.logger.debug("Starting DOM parsing"),C=kB(g,w),i===C.styles.backgroundColor&&(C.styles.backgroundColor=Le.TRANSPARENT),g.logger.debug("Starting renderer for element at "+l.x+","+l.y+" with size "+l.width+"x"+l.height),[4,new bs(g,l).render(C)];case 4:Q=A.sent(),A.label=5;case 5:return null!==(C=F.removeContainer)&&void 0!==C&&!C||dn.destroy(r)||g.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore"),g.logger.debug("Finished rendering"),[2,Q]}})})},Ys=function(A,e,t){var r=e.ownerDocument,B=r.documentElement?fe(A,getComputedStyle(r.documentElement).backgroundColor):Le.TRANSPARENT,n=r.body?fe(A,getComputedStyle(r.body).backgroundColor):Le.TRANSPARENT,t="string"==typeof t?fe(A,t):null===t?Le.TRANSPARENT:4294967295;return e===r.documentElement?oe(B)?oe(n)?t:n:B:t};return function(A,e){return Js(A,e=void 0===e?{}:e)}});</script>
    <!-- 二维码功能已禁用 -->
    <!-- <script src="qrcode.min.js"></script> -->
    <!-- <script src="jsQR.min.js"></script> -->
    <script>
        // 库功能可用性检查函数 - 仅检查本地加载的html2canvas
        window.checkLibraryAvailability = function() {
            return {
                html2canvas: typeof html2canvas !== 'undefined'
            };
        };
    </script>
    <style>
        /* 全局样式重置 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* 主题变量 */
        :root {
            --primary-color: #667eea;
            --primary-color-dark: #5a67d8;
            --secondary-color: #764ba2;
            --accent-color: #ff6b6b;
            --accent-hover: #ee5a5a;
            --success-color: #4ecdc4;
            --warning-color: #ffe66d;
            --bg-gradient-1: #667eea;
            --bg-gradient-2: #764ba2;
            --text-primary: #333;
            --text-secondary: #666;
            --text-light: #999;
            --border-light: #e0e0e0;
            --border-medium: #ddd;
            --bg-light: #f8f9fa;
            --shadow-light: 0 2px 8px rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 5px 15px rgba(0, 0, 0, 0.15);
            --shadow-heavy: 0 10px 30px rgba(0, 0, 0, 0.2);
            --radius-small: 8px;
            --radius-medium: 12px;
            --radius-large: 16px;
            --radius-full: 50%;
        }

        /* 基础样式 */
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: white;
            min-height: 100vh;
            padding: 10px;
            display: flex;
            flex-direction: column;
            color: var(--text-primary);
            line-height: 1.6;
            margin: 0;
        }

        /* 主容器 */
        .container {
            background: white;
            border-radius: var(--radius-large);
            box-shadow: var(--shadow-heavy);
            padding: 30px;
            width: 100%;
            position: relative;
            display: flex;
            flex-direction: column;
            min-height: calc(100vh - 20px);
        }

        /* 屏幕旋转提示覆盖层 */
        .orientation-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            text-align: center;
            padding: 20px;
        }

        .orientation-overlay.visible {
            display: flex;
        }

        /* 当竖屏全屏提示显示时，禁止背景内容滚动 */
        body.portrait-fullscreen-modal-open {
            overflow: hidden;
            position: fixed;
            width: 100%;
        }

        .orientation-icon {
            font-size: 6rem;
            margin-bottom: 20px;
            animation: rotate 2s ease-in-out infinite;
        }

        .orientation-message {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .orientation-submessage {
            font-size: 1rem;
        }
        
        .orientation-options {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 250px;
        }
        
        .orientation-option-btn {
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .orientation-option-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        #orientation-skip-forever {
            background: rgba(102, 126, 234, 0.3);
            border-color: rgba(102, 126, 234, 0.5);
        }
        
        #orientation-skip-forever:hover {
            background: rgba(102, 126, 234, 0.4);
            border-color: rgba(102, 126, 234, 0.6);
        }

        @keyframes rotate {
            0%, 100% {
                transform: rotate(0deg);
            }
            50% {
                transform: rotate(90deg);
            }
        }

        /* 横屏优化样式 */
        @media (orientation: landscape) and (max-width: 1024px) {
            .container {
                min-height: 100vh;
                padding: 20px;
            }

            .header {
                padding: 10px 0;
                margin-bottom: 15px;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .header p {
                font-size: 0.9rem;
            }

            .controls {
                max-width: 100%;
                margin-bottom: 15px;
            }

            .grid-container {
                grid-template-rows: auto 1fr;
            }
        }

        /* 装饰元素 */
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--accent-color));
        }

        /* 头部 */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
        }

        .header h1 {
            color: var(--text-primary);
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.1);
            font-weight: 800;
            letter-spacing: -0.5px;
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* 控制栏 - 优化后 */
        .controls {
            display: flex;
            justify-content: flex-start;
            gap: 12px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            background: linear-gradient(135deg, var(--bg-light), #ffffff);
            padding: 16px 20px;
            border-radius: var(--radius-large);
            box-shadow: var(--shadow-medium);
            border: 1px solid rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(10px);
            max-width: calc(100% - 320px); /* 为右侧回收站留出空间 */
            transition: all 0.3s ease;
        }

        .controls:hover {
            box-shadow: var(--shadow-heavy);
        }

        /* 确保按钮分成两行显示 */
        .controls .btn {
            flex: 0 0 calc(33.333% - 8px); /* 每行显示3个按钮 */
            min-width: 150px;
            box-sizing: border-box;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }



        /* 按钮样式 - 优化版 */
        .btn {
            padding: 12px 20px;
            font-size: 0.95rem;
            border: none;
            border-radius: var(--radius-medium);
            cursor: pointer;
            transition: transform 0.15s ease, box-shadow 0.15s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            will-change: transform, box-shadow;
            min-height: 40px;
            height: 40px;
            line-height: 1;
        }

        /* SVG图标样式 */
        .btn svg {
            flex-shrink: 0;
            width: 16px;
            height: 16px;
        }

        /* 确保所有按钮文字在按钮中间位置 */
        .btn span,
        .btn i,
        .btn svg {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
        }

        /* 按钮悬停效果 - 所有按钮统一使用 */
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        /* 确保模态框内按钮使用与控制栏按钮相同的过渡动画设置 */
        .modal-content .btn {
            transition: transform 0.15s ease, box-shadow 0.15s ease;
            will-change: transform, box-shadow;
        }
        
        /* 确保模态框操作区域的按钮文字居中 */
        .modal-actions .btn {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            min-height: 40px;
            height: 40px;
            line-height: 1 !important;
            text-align: center !important;
        }
        
        /* 专门针对设置模态框按钮的居中修复 */
        #confirm-settings-btn,
        #cancel-settings-btn {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            height: 40px !important;
            line-height: 1 !important;
            text-align: center !important;
        }

        /* 主按钮样式 */
        .btn-primary {
            background: var(--accent-color);
            color: white;
        }

        .btn-primary:hover {
            background: #ee5a5a;
        }

        /* 次按钮样式 */
        .btn-secondary {
            background: var(--success-color);
            color: white;
        }

        .btn-secondary:hover {
            background: #45b7aa;
        }

        /* 第三按钮样式 */
        .btn-tertiary {
            background: linear-gradient(135deg, var(--warning-color), #ffd166);
            color: var(--text-primary);
        }

        .btn-tertiary:hover {
            background: linear-gradient(135deg, #ffd166, var(--warning-color));
        }

        /* 信息按钮样式 */
        .btn-info {
            background: var(--primary-color);
            color: white;
        }

        .btn-info:hover {
            background: var(--primary-color-dark);
        }
        }

        /* 记录本列表 */
        .notebook-list {
            background: white;
            border-radius: var(--radius-medium);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-medium);
            position: relative;
            border: 1px solid var(--border-light);
        }

        .notebook-list h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 1.4rem;
            font-weight: 700;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-light);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* 切换显示模式按钮样式 */
        .view-toggle-btn, .sort-toggle-btn {
            background: var(--bg-light);
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-small);
            padding: 6px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
            transition: all 0.15s ease;
            margin-left: 8px;
        }

        .view-toggle-btn:hover, .sort-toggle-btn:hover {
            background: white;
            border-color: var(--primary-color);
        }

        /* 列表显示模式 */
        .notebook-list.list-view .notebook-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* 图标显示模式 - 为了向后兼容保留 */
        .notebook-list.icon-view .notebook-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 20px;
            margin: 10px;
            flex: 0 0 calc(33.333% - 20px);
        }

        .notebook-list.icon-view #notebooks-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
        }

        /* 平铺显示模式 - 优化后的平铺视图 */
        .notebook-list.tile-view .notebook-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 24px;
            margin: 12px;
            flex: 0 0 calc(33.333% - 24px);
            background: white;
            border-radius: var(--radius-medium);
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border-light);
            transition: all 0.15s ease;
            position: relative;
            overflow: hidden;
        }

        .notebook-list.tile-view .notebook-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary-color);
            transition: all 0.15s ease;
        }

        .notebook-list.tile-view .notebook-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
            border-color: var(--primary-color);
        }

        .notebook-list.tile-view .notebook-item.active {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
            border-color: var(--secondary-color);
        }

        .notebook-list.tile-view .notebook-item.active::before {
            background: var(--secondary-color);
            width: 6px;
        }

        .notebook-list.tile-view #notebooks-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            gap: 12px;
        }

        /* 优化移动端响应式 */
        /* 平板设备 */
        @media (max-width: 768px) {
            /* 平板竖屏 - 2列 */
            @media (orientation: portrait) {
                .notebook-list.tile-view .notebook-item {
                    flex: 0 0 calc(50% - 5px); /* 减去gap的一半作为间距 */
                    padding: 20px 16px;
                    margin: 0;
                }
            }
            
            /* 平板横屏 - 3列 */
            @media (orientation: landscape) {
                .notebook-list.tile-view .notebook-item {
                    flex: 0 0 calc(33.0% - 4px); /* 调整为更精确的值以确保三列显示 */
                    padding: 20px 16px;
                    margin: 0;
                }
            }
            
            .notebook-list.tile-view #notebooks-container {
                display: flex !important;
                flex-wrap: wrap !important;
                justify-content: flex-start !important;
                gap: 6px;
            }
        }

        /* 手机设备 */
        @media (max-width: 480px) {
            /* 手机竖屏 - 2列 */
            @media (orientation: portrait) {
                .notebook-list.tile-view .notebook-item {
                    flex: 0 0 calc(50% - 4px); /* 减去gap的一半作为间距 */
                    padding: 16px 12px;
                    margin: 0;
                    font-size: 0.85rem;
                }
            }
            
            /* 手机横屏 - 3列 */
            @media (orientation: landscape) {
                .notebook-list.tile-view .notebook-item {
                    flex: 0 0 calc(33.0% - 3.333px); /* 调整为更精确的值以确保三列显示 */
                    padding: 16px 12px;
                    margin: 0;
                    font-size: 0.85rem;
                }
            }
            
            .notebook-list.tile-view #notebooks-container {
                display: flex !important;
                flex-wrap: wrap !important;
                justify-content: flex-start !important;
                gap: 5px;
            }
        }

        /* 小屏幕手机设备 */
        @media (max-width: 360px) {
            /* 小屏幕手机竖屏 - 2列 */
            @media (orientation: portrait) {
                .notebook-list.tile-view .notebook-item {
                    flex: 0 0 calc(50% - 3px); /* 减去gap的一半作为间距 */
                    padding: 12px 10px;
                    margin: 0;
                    font-size: 0.8rem;
                }
            }
            
            /* 小屏幕手机横屏 - 3列 */
            @media (orientation: landscape) {
                .notebook-list.tile-view .notebook-item {
                    flex: 0 0 calc(33.0% - 2.666px); /* 调整为更精确的值以确保三列显示 */
                    padding: 12px 10px;
                    margin: 0;
                    font-size: 0.8rem;
                }
            }
            
            .notebook-list.tile-view #notebooks-container {
                display: flex !important;
                flex-wrap: wrap !important;
                justify-content: flex-start !important;
                gap: 4px;
            }
        }

        .notebook-list h3::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 60px;
            height: 2px;
            background: var(--primary-color);
        }

        .notebook-item {
            padding: 12px 16px;
            margin-bottom: 12px;
            border-radius: var(--radius-small);
            cursor: pointer;
            transition: all 0.15s ease;
            background: var(--bg-light);
            border-left: 4px solid var(--primary-color);
            box-shadow: var(--shadow-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notebook-item:hover {
            background: #e9ecef;
            transform: translateX(8px);
            box-shadow: var(--shadow-medium);
        }

        .notebook-item.active {
            background: #e6e9ff;
            border-left: 4px solid var(--secondary-color);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }

        /* 记录本删除按钮 */
        .notebook-delete-btn {
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 50%;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 28px;
            height: 28px;
            margin-left: 8px;
        }

        .notebook-delete-btn:hover {
            background: rgba(220, 53, 69, 0.1);
            transform: scale(1.1);
        }

        .notebook-delete-btn:active {
            transform: scale(0.95);
        }

        /* 记录本 */
        .notebook {
            background: #f9f7f1;
            border-radius: var(--radius-medium);
            padding: 25px;
            position: relative;
            margin-bottom: 30px;
            box-shadow: var(--shadow-medium);
            border: 1px solid #e6d9b8;
        }

        .notebook::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50px;
            height: 100%;
            width: 3px;
            background: linear-gradient(to bottom, #e6d9b8, transparent 80%);
        }

        /* 记录纸 */
        .paper {
            background: white;
            border-radius: var(--radius-small);
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-medium);
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-light);
            transition: all 0.3s ease;
        }

        .paper:hover {
            box-shadow: var(--shadow-heavy);
            transform: translateY(-2px);
        }
        
        .paper.selected {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(124, 157, 250, 0.2);
        }
        
        /* 网格纸背景的选中记录纸 - 移除行线条保留竖线条 */
        .paper.selected.bg-image-grid {
            background-image: linear-gradient(to right, var(--border-light) 1px, transparent 1px);
        }
        
        /* 四格记录纸中网格纸背景的选中记录纸 */
        .paper.selected.bg-image-grid .grid-container.four-column {
            background-image: linear-gradient(to right, var(--border-light) 1px, transparent 1px);
        }
        
        /* 确保输入区下边界与网格纸方格下边线平齐 */
        .paper.bg-image-grid .grid-line {
            height: calc(2.8125rem - 1px);
            border-bottom: none;
        }
        
        .paper.bg-image-grid .grid-container.four-column .grid-line {
            height: calc(2.8125rem - 1px);
            border-bottom: none;
        }

        .paper-header {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px dashed var(--border-light);
            position: relative;
        }
        
        .print-btn {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            background: var(--bg-light);
            color: var(--text-primary);
            border: none;
            border-radius: var(--radius-full);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
        }
        
        .print-btn:hover {
            background: white;
            transform: translateY(-50%) scale(1.1);
            box-shadow: var(--shadow-medium);
        }
        
        .print-btn:active {
            transform: translateY(-50%) scale(0.95);
        }
        
        .paper-date {
            position: absolute;
            right: 40px; /* 为删除按钮留出空间 */
            top: 50%;
            transform: translateY(-50%);
        }
        
        .delete-btn {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(calc(-50% - 5px)); /* 向上移动5px */
            background: linear-gradient(135deg, var(--accent-color), #ff5252);
            color: white;
            border: none;
            border-radius: var(--radius-full);
            width: 30px;
            height: 30px;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: var(--shadow-light);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            font-weight: 500;
            line-height: 1;
        }
        
        .delete-btn:hover {
            background: linear-gradient(135deg, var(--accent-color), #ff5252);
            box-shadow: var(--shadow-light);
        }
        
        .delete-btn:active {
            background: #cc0000;
            box-shadow: 0 0 8px rgba(255, 82, 82, 0.6);
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 82, 82, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 82, 82, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 82, 82, 0); }
        }

        .paper-title {
            font-size: 1.4rem;
            color: var(--text-primary);
            font-weight: 700;
            letter-spacing: -0.3px;
            flex: 1;
            text-align: center;
            outline: none;
            transition: background-color 0.2s ease;
        }
        
        .paper-title[contenteditable="true"] {
            background-color: rgba(102, 126, 234, 0.05);
        }

        .paper-date {
            color: var(--text-light);
            font-size: 0.9rem;
            background: var(--bg-light);
            padding: 4px 10px;
            border-radius: var(--radius-full);
        }

        /* 三格布局 */
        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 40px;
            position: relative;
        }
        
        /* 四格布局 */
        .grid-container.four-column {
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 30px;
        }

        .column {
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* 基本竖线条样式 */
        .column:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 0;
            right: -20px;
            height: 100%;
            width: 1px;
            background-color: var(--column-border-color, #a0d4e6);
        }
        
        /* 虚线样式 */
        .column:not(:last-child)[style*="--column-border-style: dashed"]::after {
            background-image: repeating-linear-gradient(
                to bottom,
                transparent 0px, 
                transparent 19px,
                var(--column-border-color, #a0d4e6) 19px,
                var(--column-border-color, #a0d4e6) 20px
            );
            background-color: transparent;
        }
        
        /* 点线样式 */
        .column:not(:last-child)[style*="--column-border-style: dotted"]::after {
            background-image: repeating-linear-gradient(
                to bottom,
                transparent 0px, 
                transparent 5px,
                var(--column-border-color, #a0d4e6) 5px,
                var(--column-border-color, #a0d4e6) 6px
            );
            background-color: transparent;
        }
        
        /* 实线样式（默认样式）不需要特殊处理，使用上面的基本样式 */

        /* 网格线 */
        .grid-line {
            height: 2.8125rem; /* 与背景图片网格大小(2rem)成比例，保持视觉协调 */
            border-bottom: 1px dashed #a0d4e6;
            transition: background-color 0.3s ease, border-color 0.3s ease;
            position: relative;
            background-color: transparent;
        }
        
        /* 双线样式 */
        .grid-line.double-line {
            border-bottom-width: 4px;
            border-bottom-style: double;
            border-bottom-color: var(--grid-line-color, #a0d4e6);
        }
        

        
        .grid-line:hover {
            background-color: rgba(249, 249, 249, 0.8);
            border-bottom-color: #7cbad9;
        }

        /* 输入框样式 - 同时支持input和textarea */
        .grid-line input,
        .grid-line textarea {
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
            background: transparent;
            font-size: 0.95rem;
            position: relative;
            z-index: 2;
            padding: 10px 12px;
            color: var(--text-primary);
            transition: all 0.3s ease;
            /* 确保textarea的自动换行功能正常工作 */
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-wrap: break-word;
            resize: none;
            /* 统一行高和字体 */
            line-height: 1.4;
            font-family: inherit;
        }

        .grid-line input:focus,
        .grid-line textarea:focus {
            background-color: rgba(255, 230, 109, 0.2);
            transform: scale(1.02);
        }

        /* 模态框 - 包含居中显示和背景模糊 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(3px);
            -webkit-backdrop-filter: blur(3px);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.15s ease;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius-medium);
            padding: 35px;
            width: 90%;
            max-width: 500px;
            box-shadow: var(--shadow-heavy);
            animation: slideIn 0.15s ease;
            border: 1px solid var(--border-light);
            position: relative;
            max-height: 80vh; /* 限制最大高度为视口高度的80% */
            overflow-y: auto; /* 启用垂直滚动 */
        }
        
        /* 为设置模态框的内容区域添加特殊处理，确保按钮始终在底部 */
        #settings-modal .modal-content {
            display: flex;
            flex-direction: column;
            position: relative;
            max-height: 85vh; /* 限制最大高度为视口高度的85% */
            overflow-y: visible; /* 改为visible，确保标题行完全显示 */
            padding-top: 15px;
            padding-bottom: 5px;
        }
        
        /* 为模板选择模态框优化间距和布局 */
        #template-modal .modal-content {
            display: flex;
            flex-direction: column;
            position: relative;
            max-height: 80vh; /* 限制最大高度为视口高度的80% */
            overflow-y: hidden; /* 禁用内容直接滚动 */
            padding-top: 15px;
            padding-bottom: 5px;
        }
        
        /* 为同步与备份模态框优化间距和布局 */
        #sync-modal .modal-content {
            display: flex;
            flex-direction: column;
            position: relative;
            max-height: 80vh; /* 限制最大高度为视口高度的80% */
            overflow-y: auto; /* 启用垂直滚动 */
            padding-top: 15px;
            padding-bottom: 5px; /* 减少底部内边距，使按钮更靠近底部 */
        }
        
        /* 模板选择模态框内容区域容器 */
        #template-modal .modal-content > *:not(.modal-actions) {
            overflow-y: auto; /* 启用内容区域的滚动功能 */
            flex: 1;
            padding-right: 5px; /* 为滚动条留出空间 */
        }
        
        /* 模板选择模态框标题样式 */
        #template-modal .modal-content h3 {
            overflow: visible !important;
            white-space: nowrap;
            margin-top: 0;
            margin-bottom: 12px; /* 减小标题底部间距 */
        }
        
        /* 模板选择模态框操作按钮区域 - 固定在底部 */
        #template-modal .modal-actions {
            margin-top: auto; /* 确保操作按钮区域始终在底部 */
            padding-top: 10px; /* 减小按钮区域顶部内边距 */
            padding-bottom: 2px; /* 减小底部内边距 */
            border-top: 1px solid var(--border-light);
            background-color: white; /* 确保背景色与内容一致 */
            position: sticky;
            bottom: 0;
            z-index: 10; /* 确保在内容之上 */
        }
        
        /* 设置模态框标题和标签行容器 - 确保始终可见 */
        #settings-modal .modal-header {
            position: sticky;
            top: 0;
            background-color: white;
            z-index: 5;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-light);
        }
        
        /* 设置模态框内容区域容器 - 只让内容区域滚动 */
        #settings-modal .tab-content-container {
            overflow-y: auto; /* 只让内容区域滚动 */
            flex: 1;
            padding-right: 5px; /* 为滚动条留出空间 */
        }
        
        /* 只针对设置行和标签行移除滚动条 */
        .settings-tabs {
            overflow-x: hidden !important; /* 仅移除标签行的水平滚动条 */
            overflow-y: hidden !important; /* 仅移除标签行的垂直滚动条 */
            margin-bottom: 8px;
        }
        
        /* 确保设置标题区域没有滚动条 */
        #settings-modal .modal-content h3 {
            overflow: visible !important;
            white-space: nowrap;
            margin-top: 0;
            margin-bottom: 8px;
        }
        
        /* 设置模态框操作按钮区域 - 固定在底部 */
        #settings-modal .modal-actions {
            margin-top: auto; /* 确保操作按钮区域始终在底部 */
            padding-top: 15px;
            padding-bottom: 2px; /* 减少底部内边距 */
            border-top: 1px solid var(--border-light);
        }
        
        /* 同步与备份模态框操作按钮区域 - 固定在底部 */
        #sync-modal .modal-actions {
            margin-top: auto; /* 确保操作按钮区域始终在底部 */
            padding-top: 15px;
            padding-bottom: 5px; /* 减小底部内边距，缩减空白区域 */
            border-top: 1px solid var(--border-light);
            background-color: white; /* 确保背景色与内容一致 */
            position: sticky;
            bottom: 0;
            z-index: 10; /* 确保在内容之上 */
        }
        
        /* 优化滚动条样式 */
        .modal-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .modal-content::-webkit-scrollbar-track {
            background: var(--bg-light);
            border-radius: 3px;
        }
        
        .modal-content::-webkit-scrollbar-thumb {
            background: var(--border-light);
            border-radius: 3px;
        }
        
        .modal-content::-webkit-scrollbar-thumb:hover {
            background: var(--border-color);
        }

        /* 删除确认模态框 - 简化样式 */
        .delete-confirm-content {
            background: white;
            border-radius: 8px;
            padding: 24px 32px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0e0e0;
        }
        
        /* 删除图标样式 */
        .delete-confirm-icon {
            margin: 0 auto 20px;
        }
        
        /* 标题样式 */
        .delete-confirm-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin: 0 0 12px;
        }
        
        /* 消息样式 */
        .delete-confirm-message {
            font-size: 14px;
            color: #666;
            margin: 0 0 24px;
        }
        
        /* 按钮组样式 */
        .delete-confirm-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        /* 取消按钮样式 */
        .delete-confirm-cancel {
            padding: 8px 20px;
            border-radius: 4px;
            border: 1px solid #d0d0d0;
            background: white;
            color: #666;
            font-size: 14px;
            cursor: pointer;
        }
        
        /* 确认删除按钮样式 */
        .delete-confirm-submit {
            padding: 8px 20px;
            border-radius: 4px;
            border: none;
            background: #f44336;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
        }
        

        


        .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }

        .modal-content h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 1.3rem; /* 增大设置标题文字 */
            font-weight: 700;
        }

        .modal-content input {
            width: 100%;
            padding: 12px 16px;
            margin-bottom: 20px;
            border: 2px solid var(--border-medium);
            border-radius: var(--radius-small);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .modal-content input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 25px;
        }
        
        /* 设置选项卡样式 - 完全优化 */
        .settings-tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 2px solid var(--border-medium);
            white-space: nowrap; /* 确保标签在同一行 */
            overflow-x: hidden !important; /* 强制移除水平滚动条 */
            overflow-y: hidden !important; /* 强制移除垂直滚动条 */
        }
        
        .tab-btn {
            padding: 8px 12px; /* 稍微增加内边距 */
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem !important; /* 增大标签文字 */
            color: var(--text-secondary);
            position: relative;
            margin-bottom: -2px;
            flex-shrink: 0; /* 防止标签被压缩 */
            white-space: nowrap;
        }
        
        /* 设置内容区域的标题文字 - 统一缩小 */
        .tab-content h4,
        .tab-content > div > h4 {
            font-size: 0.9rem !important;
            margin-top: 15px;
            margin-bottom: 10px;
        }
        
        .tab-btn:hover {
            color: var(--text-primary);
            background: var(--bg-light);
        }
        
        .tab-btn.active {
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary-color);
        }
        
        /* 选项卡内容样式 */
        .tab-content {
            
        }
        
        /* 主题选项样式 */
        .theme-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            border: 2px solid var(--border-medium);
            border-radius: var(--radius-small);
            cursor: pointer;
            margin: 5px;
            flex: 1;
            min-width: 80px;
        }
        
        .theme-option:hover {
            border-color: var(--primary-color);
        }
        
        .theme-option.selected {
            border-color: var(--primary-color);
            background: var(--bg-light);
        }
        
        .theme-option span {
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* 对齐选项样式 */
        .alignment-option {
            display: flex;
            flex-direction: column;
            padding: 8px 12px;
            border: 2px solid var(--border-medium);
            border-radius: var(--radius-small);
            cursor: pointer;
            margin: 5px;
            flex: 1;
            min-width: 80px;
            font-size: 14px;
        }

        .alignment-option > div {
            width: 100%;
            text-align: inherit;
        }

        .alignment-option[data-alignment="left"] > div {
            text-align: left !important;
        }

        .alignment-option[data-alignment="center"] > div {
            text-align: center !important;
        }

        .alignment-option[data-alignment="right"] > div {
            text-align: right !important;
        }

        .alignment-option > span {
            margin-top: 5px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            width: 100%;
        }

        .alignment-option[data-alignment="left"] > span {
            text-align: left;
        }

        .alignment-option[data-alignment="center"] > span {
            text-align: center;
        }

        .alignment-option[data-alignment="right"] > span {
            text-align: right;
        }

        .alignment-option:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .alignment-option.selected {
            border-color: var(--primary-color);
            background: var(--bg-light);
        }

        .alignment-option > div {
            width: 100%;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
        }

        .alignment-option span {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }



        /* 模板项 */
        .template-item {
            border: 2px solid var(--border-medium);
            border-radius: var(--radius-small);
            padding: 12px;
            cursor: pointer;
            transition: border-color 0.1s ease, background 0.1s ease, transform 0.1s ease, box-shadow 0.1s ease;
            background: var(--bg-light);
            box-shadow: var(--shadow-light);
            text-align: center;
            will-change: border-color, background, transform, box-shadow;
            height: 110px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            line-height: 1.2;
        }

        .template-item:hover {
            border-color: var(--primary-color);
            background: white;
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .template-item.selected {
            border-color: var(--primary-color);
            background: #e6e9ff;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }
        
        /* 暗黑模式下选中模板的样式 */
        .theme-dark .template-item.selected {
            background: #2d3748;
            border-color: #4a5568;
        }
        
        .theme-dark .template-item.selected > div:first-child {
            color: #ffffff !important;
        }
        
        /* 模板项锁定状态 */
        .template-item.locked {
            border-color: var(--border-light);
            background: var(--bg-ultra-light);
            cursor: not-allowed;
            position: relative;
            opacity: 0.7;
        }
        
        .template-item.locked:hover {
            border-color: var(--border-light);
            background: var(--bg-ultra-light);
            transform: none;
            box-shadow: var(--shadow-light);
        }
        
        .template-item.locked::after {
            content: '🔒';
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 16px;
        }

        /* 标签 */
        .tag {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            padding: 4px 10px;
            border-radius: var(--radius-full);
            font-size: 0.85rem;
            margin-right: 8px;
            margin-bottom: 8px;
            font-weight: 500;
            transition: all 0.15s ease;
            box-shadow: var(--shadow-light);
        }

        .tag:hover {
            background: var(--primary-color-dark);
            transform: scale(1.05);
        }

        /* 记录纸操作 */
        .paper-actions {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 8px;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .paper:hover .paper-actions {
            opacity: 1;
        }

        .delete-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: var(--radius-full);
            padding: 6px 12px;
            font-size: 0.9rem;
            cursor: pointer;
            box-shadow: var(--shadow-light);
        }

        .delete-btn:hover {
            background: #ff5252;
            box-shadow: 0 4px 10px rgba(255, 107, 107, 0.3);
        }
        
        .delete-btn:active {
            background: #cc0000;
            box-shadow: 0 2px 5px rgba(255, 107, 107, 0.3);
        }

        .style-btn {
            background: var(--success-color);
            color: white;
            border: none;
            border-radius: var(--radius-full);
            padding: 6px 12px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.15s ease;
            box-shadow: var(--shadow-light);
        }

        .style-btn:hover {
            background: #45b7aa;
            transform: scale(1.05);
            box-shadow: 0 4px 10px rgba(78, 205, 196, 0.3);
        }

        /* 回收站 - PC端基础样式 */
        .recycle-bin {
            position: absolute; /* 改为absolute定位，相对于container容器 */
            top: 15px; /* 向上移动15px */
            right: 30px; /* 与.container的padding-right对齐 */
            width: 320px; /* 保持宽度不变 */
            max-height: 350px; /* 保持最大高度不变 */
            background: white;
            border-radius: var(--radius-medium);
            box-shadow: var(--shadow-heavy);
            padding: 20px;
            z-index: 90; /* 保持z-index不变 */
            border: 1px solid var(--border-light);
            animation: fadeIn 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 350px; /* 固定高度，确保布局稳定 */
        }

        .recycle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-light);
            flex-shrink: 0; /* 防止头部被压缩 */
        }

        .recycle-header h3 {
            font-size: 1.2rem;
            color: var(--text-primary);
            font-weight: 700;
        }

        .recycle-count {
            background: var(--accent-color);
            color: white;
            border-radius: var(--radius-full);
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .recycle-items {
            flex: 1; /* 占据剩余空间 */
            overflow-y: auto; /* 仅内容区域滚动 */
            margin-bottom: 10px;
            min-height: 0; /* 重要：允许flex子元素在flex容器中正确收缩 */
        }

        .recycle-item {
            padding: 10px;
            margin-bottom: 8px;
            background: var(--bg-light);
            border-radius: var(--radius-small);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: flex-start;
            line-height: 1.4;
        }

        /* 回收站项目内部元素样式 */
        .recycle-item-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            word-break: break-word;
            width: 100%;
        }

        .recycle-item-meta {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        /* PC端回收站样式 - 从recycle-fix.css整合 - 新增recycle-footer样式 */
        .recycle-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 10px;
            border-top: 1px solid var(--border-light);
        }

        .recycle-item-date {            font-size: 0.75rem;
            color: var(--text-tertiary);
            white-space: nowrap;
        }

        .recycle-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
            transition: all 0.15s ease;
        }

        /* 展开回收站按钮 */
        .expand-recycle-btn {
            width: 100%;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--radius-small);
            padding: 8px 12px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
            margin-top: 8px;
            font-weight: 500;
        }

        .expand-recycle-btn:hover {
            background: var(--primary-color-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.3);
        }

        .expand-recycle-btn:active {
            transform: translateY(0);
        }

        /* 移除无用的recycle-item-info类 */

        .restore-btn {
            background: var(--success-color);
            color: white;
            border: none;
            border-radius: var(--radius-small);
            padding: 4px 10px;
            font-size: 0.85rem;
            cursor: pointer;
            margin-left: 8px;
            transition: all 0.15s ease;
        }

        .restore-btn:hover {
            background: #45b7aa;
            transform: scale(1.05);
        }

        .empty-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: var(--radius-small);
            padding: 4px 10px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .empty-btn:hover {
            background: #ff5252;
            transform: scale(1.05);
        }

        /* 记录纸样式选择 */
        .paper-styles {
            display: none;
            position: absolute;
            top: 50px;
            right: 15px;
            background: white;
            border-radius: var(--radius-small);
            box-shadow: var(--shadow-heavy);
            padding: 20px;
            min-width: 220px;
            z-index: 200;
            border: 1px solid var(--border-light);
            animation: slideIn 0.3s ease;
        }

        .paper-styles.visible {
            display: block;
        }

        .style-group {
            margin-bottom: 20px;
        }

        .style-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.95rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .style-options {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .line-style-option {
            width: 45px;
            height: 22px;
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-small);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .line-style-option:hover::after {
            content: attr(data-label);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
            z-index: 1001;
            margin-bottom: 5px;
        }

        .line-style-option:hover::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid rgba(0, 0, 0, 0.8);
            margin-bottom: -1px;
            z-index: 1001;
        }

        /* 基础线条样式 - 不使用::after伪元素 */
        .line-style-option.dashed {
            border-bottom: 2px dashed var(--text-primary);
        }

        .line-style-option.solid {
            border-bottom: 2px solid var(--text-primary);
        }

        .line-style-option.dotted {
            border-bottom: 2px dotted var(--text-primary);
        }

        .line-style-option.double {
            border-bottom: 4px double var(--text-primary);
        }



        /* 波浪线的原始样式通过额外元素实现，而不是::after伪元素 */

        .line-style-option.selected {
            background: #e6e9ff;
            border-color: var(--primary-color);
            transform: scale(1.05);
        }

        .color-option {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-full);
            cursor: pointer;
            border: 3px solid transparent;
            box-shadow: var(--shadow-light);
        }

        .color-option.selected {
            border-color: var(--text-primary);
        }

        /* 字体选项样式 */
        .font-option {
            padding: 8px 12px;
            border-radius: var(--radius-small);
            cursor: pointer;
            border: 2px solid transparent;
            background: var(--bg-light);
            margin-right: 8px;
            margin-bottom: 8px;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            min-width: 80px;
            text-align: center;
        }

        .font-option:hover {
            border-color: var(--primary-color);
            background: white;
            transform: translateY(-1px);
            box-shadow: var(--shadow-light);
        }

        .font-option.selected {
            border-color: var(--primary-color);
            background: #e6e9ff;
            font-weight: 600;
        }

        .bg-option {
            width: 65px;
            height: 32px;
            border-radius: var(--radius-small);
            cursor: pointer;
            border: 3px solid transparent;
            box-shadow: var(--shadow-light);
            transition: border-color 0.05s linear, background-color 0.05s linear;
            will-change: border-color, background-color;
        }

        .bg-option.selected {
            border-color: var(--text-primary);
            transition: border-color 0.05s linear, background-color 0.05s linear;
        }

        /* 操作按钮 */
        .action-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: var(--radius-full);
            background: var(--bg-light);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-light);
        }

        .action-btn:hover {
            background: white;
        }

        /* 图片预览 */
        .image-preview {
            max-width: 100%;
            max-height: 180px;
            border-radius: var(--radius-small);
            margin: 8px 0;
            box-shadow: var(--shadow-medium);
        }

        .image-preview:hover {
            
        }

        /* 小按钮 */
        .btn-sm {
            padding: 6px 12px;
            font-size: 0.9rem;
            border: none;
            border-radius: var(--radius-small);
            cursor: pointer;
            background: var(--bg-light);
            box-shadow: var(--shadow-light);
        }

        .btn-sm:hover {
            background: white;
        }
        
        /* 超小按钮 */
        .btn-xs {
            padding: 3px 8px;
            font-size: 11px;
            border: none;
            border-radius: var(--radius-small);
            cursor: pointer;
            background: var(--bg-light);
            box-shadow: var(--shadow-light);
        }
        
        .btn-xs:hover {
            background: white;
        }

        /* 富文本按钮 */
        #format-bold {
            font-weight: bold;
        }

        #format-italic {
            font-style: italic;
        }

        #format-underline {
            text-decoration: underline;
        }



        /* 响应式设计 */
        /* 平板设备适配 */
        @media (max-width: 1024px) {
            .grid-container {
                gap: 35px;
            }
        }
        
        /* 移动设备适配 */
        @media (max-width: 768px) {
            /* 调整基础字体大小以实现整体缩放效果 */
            body {
                font-size: 0.75rem;
            }
            
            /* 基本布局调整 - 三列显示 */
            .grid-container {
                grid-template-columns: 1fr 1fr 1fr;
                gap: 8px;
                width: 100%;
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            /* 四列记录纸在移动设备上也保持四列显示 */
            .grid-container.four-column {
                grid-template-columns: 1fr 1fr 1fr 1fr;
                gap: 6px;
                width: 100%;
                margin: 0;
                padding: 0;
            }
            
            .column:not(:last-child)::after {
                display: block;
                right: -3px; /* 调整竖线位置 */
            }
            
            /* 确保记录纸铺满左右空间 */
            .paper {
                width: 100%;
                margin: 0;
                padding: 3px 8px;
                max-width: none;
                font-size: 0.75rem;
                box-sizing: border-box;
            }
            
            /* 优化记录纸输入框宽度 */
            .grid-line input {
                width: 100%;
                padding: 0 6px;
                box-sizing: border-box;
                max-width: none;
                font-size: 0.75rem;
            }
            
            /* 调整所有文本输入元素的字号 */
            input, textarea, select {
                font-size: 0.75rem;
            }
            
            /* 调整侧边栏按钮的间距和大小 */
            .sidebar-nav .btn {
                padding: 8px 10px;
                font-size: 0.75rem;
                gap: 4px;
            }
            
            /* 调整模态框内元素的间距和大小 */
            .modal-content {
                padding: 20px;
            }
            
            .modal h3 {
                font-size: 1rem;
                margin-bottom: 12px;
            }
            
            /* 调整所有按钮的大小和间距 */
            .btn {
                padding: 8px 12px;
                font-size: 0.8rem;
                height: auto;
            }
            
            .btn-sm {
                padding: 4px 8px;
                font-size: 0.75rem;
            }
            
            .btn-xs {
                padding: 2px 6px;
                font-size: 10px;
            }
            
            /* 调整标签大小 */
            .tag {
                padding: 2px 6px;
                font-size: 0.7rem;
            }
            
            /* 确保图片也能充分利用空间 */
            .image-preview {
                width: 100%;
                height: auto;
                max-height: none;
            }
            
            /* 减小头部标题字体大小 */
            .header h1 {
                font-size: 1.5rem;
                margin: 5px 0;
            }
            
            .header p {
                font-size: 0.8rem;
                margin: 5px 0;
            }
            
            .container {
                padding: 0;
                padding-top: 60px; /* 减少顶部空间 */
                width: 100%;
                box-sizing: border-box;
                margin: 0;
                max-width: none;
            }
            
            /* 确保记录纸父容器也占满宽度 */
            .notebook-content {
                width: 100%;
                margin: 0;
                padding: 0;
                max-width: none;
            }
            
            /* 确保列也占满宽度 */
            .column {
                width: 100%;
                margin: 0;
                padding: 0;
            }
            
            /* 确保网格线也占满宽度 */
            .grid-line {
                width: 100%;
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            /* 显示汉堡菜单按钮 */
            .menu-btn {
                display: flex;
            }
            
            /* 隐藏原控制栏 */
            .controls {
                display: none;
            }
            
            /* 移动端特定回收站样式整合 */
            
            /* PC端横屏样式 - 保持原有PC端回收站样式 */
            @media (orientation: landscape) {
                /* 空规则，保持PC端原有样式不变 */
            }
            
            /* 移动端横屏专用回收站样式 - 简约、易看、贴边、美观设计 */
            @media (orientation: landscape) and (max-width: 768px) {
                .recycle-bin {
                    position: fixed;
                    display: flex;
                    flex-direction: column;
                    width: 180px; /* 更紧凑的宽度 */
                    right: 0; /* 贴右边框 */
                    top: 0; /* 贴顶边框 */
                    z-index: 1000;
                    max-height: 100vh; /* 占满整个垂直空间 */
                    height: 100vh;
                    padding: 10px;
                    background: rgba(255, 255, 255, 0.95); /* 半透明背景增加现代感 */
                    border-radius: 0; /* 无边角，完全贴边 */
                    box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1); /* 单侧阴影，增强层次感 */
                    border: none; /* 无边框 */
                    animation: slideInRight 0.3s ease; /* 右侧滑入动画 */
                }
                
                /* 右侧滑入动画 */
                @keyframes slideInRight {
                    from {
                        transform: translateX(100%);
                    }
                    to {
                        transform: translateX(0);
                    }
                }
                
                .recycle-header {
                    margin-bottom: 8px;
                    padding-bottom: 6px;
                    border-bottom: 1px solid var(--border-light);
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                
                .recycle-header h3 {
                    font-size: 0.9rem;
                    color: var(--text-primary);
                    font-weight: 600;
                    margin: 0;
                    text-align: center;
                    width: 100%;
                }
                
                .recycle-items {
                    flex: 1;
                    overflow-y: auto;
                    margin-bottom: 8px;
                    min-height: 0;
                }
                
                /* 自定义滚动条样式 */
                .recycle-items::-webkit-scrollbar {
                    width: 4px;
                }
                
                .recycle-items::-webkit-scrollbar-track {
                    background: transparent;
                }
                
                .recycle-items::-webkit-scrollbar-thumb {
                    background: var(--border-light);
                    border-radius: 2px;
                }
                
                .recycle-items::-webkit-scrollbar-thumb:hover {
                    background: var(--text-secondary);
                }
                
                .recycle-item {
                    padding: 8px;
                    margin-bottom: 4px;
                    background: white;
                    border-radius: 6px;
                    display: flex;
                    flex-direction: column;
                    justify-content: space-between;
                    align-items: flex-start;
                    line-height: 1.3;
                    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
                    transition: all 0.2s ease;
                }
                
                .recycle-item:hover {
                    transform: translateX(-2px);
                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
                }
                
                .recycle-item-title {
                    font-size: 0.8rem;
                    font-weight: 600;
                    color: var(--text-primary);
                    margin-bottom: 2px;
                    display: flex;
                    align-items: center;
                    word-break: break-word;
                    width: 100%;
                }
                
                .recycle-item-meta,
                .recycle-item-date {
                    font-size: 0.7rem;
                    color: var(--text-secondary);
                    margin-bottom: 2px;
                }
                
                .recycle-footer {
                    display: flex;
                    flex-direction: column;
                    gap: 4px;
                    padding-top: 6px;
                    border-top: 1px solid var(--border-light);
                }
                
                .recycle-footer button {
                    font-size: 0.75rem;
                    padding: 6px 8px;
                    background: var(--accent-color);
                    color: white;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    text-align: center;
                    width: 100%;
                }
                
                .recycle-footer button:hover {
                    background: var(--accent-hover);
                    transform: translateY(-1px);
                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                }
                
                /* 删除按钮特殊样式 */
                .recycle-footer button.delete {
                    background: #ff4d4f;
                }
                
                .recycle-footer button.delete:hover {
                    background: #ff7875;
                }
            }
            
            /* 移动端隐藏原回收站，使用侧边栏中的回收站按钮和弹窗 */
            @media (orientation: portrait) {
                .recycle-bin {
                    display: none !important;
                }
            }
            
            /* 移动端回收站弹窗样式（在所有方向都生效） */
            .mobile-recycle-modal {
                display: flex;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                backdrop-filter: blur(3px);
                -webkit-backdrop-filter: blur(3px);
                justify-content: center;
                align-items: center;
                z-index: 1000;
                animation: fadeIn 0.15s ease;
            }
            
            .mobile-recycle-content {
                background: white;
                border-radius: var(--radius-medium);
                width: 90%;
                max-width: 400px;
                max-height: 80vh;
                box-shadow: var(--shadow-heavy);
                display: flex;
                flex-direction: column;
                border: 1px solid var(--border-light);
            }
            
            .mobile-recycle-header {
                padding: 20px;
                border-bottom: 1px solid var(--border-light);
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .mobile-recycle-header h3 {
                margin: 0;
                font-size: 1.1rem;
            }
            
            .mobile-recycle-close {
                background: none;
                border: none;
                font-size: 1.2rem;
                cursor: pointer;
                width: 30px;
                height: 30px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
                transition: background-color 0.2s;
            }
            
            .mobile-recycle-close:hover {
                background-color: var(--bg-light);
            }
            
            .mobile-recycle-body {
                flex: 1;
                padding: 20px;
                overflow-y: auto;
                min-height: 0; /* 确保flex布局正确工作 */
            }
            
            .mobile-recycle-items {
                max-height: 300px; /* 设置最大高度以限制内容区域 */
                overflow-y: auto; /* 为内容区域单独添加滚动条 */
                -webkit-overflow-scrolling: touch; /* 为iOS设备提供平滑滚动体验 */
            }
            
            /* 为移动回收站项目添加适当的间距和样式 */
            .mobile-recycle-items .recycle-item {
                margin-bottom: 10px; /* 增加项目间距 */
                padding: 15px; /* 增加内边距 */
                border-radius: var(--radius-small);
                border: 1px solid var(--border-light);
                background-color: white;
            }
            
            /* 美化滚动条样式 */
            .mobile-recycle-body::-webkit-scrollbar,
            .mobile-recycle-items::-webkit-scrollbar {
                width: 6px;
            }
            
            .mobile-recycle-body::-webkit-scrollbar-track,
            .mobile-recycle-items::-webkit-scrollbar-track {
                background: var(--bg-light);
                border-radius: 3px;
            }
            
            .mobile-recycle-body::-webkit-scrollbar-thumb,
            .mobile-recycle-items::-webkit-scrollbar-thumb {
                background: var(--border);
                border-radius: 3px;
            }
            
            .mobile-recycle-body::-webkit-scrollbar-thumb:hover,
            .mobile-recycle-items::-webkit-scrollbar-thumb:hover {
                background: var(--text-secondary);
            }
            
            .mobile-recycle-footer {
                padding: 15px 20px;
                border-top: 1px solid var(--border-light);
                display: flex;
                gap: 10px;
            }
            
            .mobile-recycle-footer .btn {
                flex: 1;
            }
            
            /* 调整头部位置和标题字号 */
            .header {
                text-align: center;
                margin-top: 0;
                margin-bottom: 20px; /* 减少底部间距，使内容上移 */
                padding: 15px 0;
            }
            
            .header h1 {
                font-size: 1.8rem; /* 缩小标题字号 */
                margin-bottom: 5px;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            }
            
            .header p {
                font-size: 0.9rem; /* 缩小副标题字号 */
            }
            
            /* 调整内容上移 */
            .notebook-list,
            #current-notebook {
                margin-top: 0;
            }
            
            /* 增强移动端触摸体验 */
            .paper, .notebook-item, .recycle-item {
                touch-action: manipulation;
            }
            
            /* 增大可点击区域 */
            .action-btn {
                width: 40px;
                height: 40px;
            }
            
            /* 移动端侧边栏菜单样式调整 */
            .sidebar-nav .btn {
                /* 让所有菜单按钮宽度与最长菜单名称平齐 */
                width: auto;
                padding: 12px 15px;
                font-size: 0.85rem;
                /* 确保文字和图标对齐 */
                justify-content: flex-start;
                /* 保持图标和文字间距 */
                gap: 8px;
                /* 确保按钮内容完整显示，不换行 */
                white-space: nowrap;
                /* 确保所有按钮与最长按钮等宽 */
                align-self: stretch;
            }
            
            /* 适应侧边栏的图标大小 - 图标长度可以变 */
            .sidebar-nav .btn svg {
                width: 14px;
                height: 14px;
                flex-shrink: 0;
            }
            
            /* 让侧边栏宽度与最长菜单名称平齐，比内容略宽 */
            .sidebar-nav {
                width: fit-content;
                min-width: 140px;
                max-width: 200px;
                padding: 0 2px 0 5px; /* 减少右侧内边距 */
            }
            
            /* 确保侧边栏内容区域不影响宽度计算 */
            .sidebar-content {
                width: fit-content;
                padding: 10px 2px 10px 5px; /* 减少右侧内边距 */
                display: flex;
                flex-direction: column;
                gap: 12px;
            }
            
            .btn-sm {
                padding: 8px 16px;
                font-size: 1rem;
            }
            
            .btn-xs {
                padding: 4px 10px;
                font-size: 0.85rem;
            }
            
            /* 模态框适配 */
            .modal-content {
                width: 90%;
                max-width: 400px;
                margin: 20% auto;
            }
            
            /* 优化输入框体验 */
            input, textarea, select {
                font-size: 1rem;
                padding: 12px;
                height: auto;
            }
            
            /* 优化记录纸单元格触摸体验 */
            .cell {
                min-height: 50px;
                padding: 8px 12px;
                transition: background-color 0.2s ease;
            }
            
            /* 三格布局样式 */
            .grid-container {
                grid-template-columns: 1fr 1fr 1fr;
                gap: 10px;
                width: 100%;
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            /* 四格布局样式 */
            .grid-container.four-column {
                grid-template-columns: 1fr 1fr 1fr 1fr;
                gap: 8px;
                width: 100%;
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            /* 减小头部与内容之间的间距 */
            .header {
                margin-bottom: 10px;
                padding: 5px 0;
            }
            
            /* 优化移动端竖屏模式下记录纸的显示效果 */
            .paper {
                /* 减少内边距，让内容更靠近纸张边缘 */
                padding: 5px 10px;
                /* 减少底部边距，让纸张更紧密排列 */
                margin-bottom: 10px;
                /* 确保记录纸占满可用宽度 */
                width: 100%;
                box-sizing: border-box;
            }
            
            /* 调整纸张头部样式 */
            .paper-header {
                margin-bottom: 8px;
                padding-bottom: 5px;
            }
            
            /* 确保记录本容器占满宽度 */
            .notebook {
                padding: 10px 5px;
                width: 100%;
                box-sizing: border-box;
                margin-bottom: 10px;
            }
            
            .cell:active {
                background-color: var(--bg-light);
            }
            
            /* 移动端滚动优化 - 确保滚动条可见 */
            ::-webkit-scrollbar {
                width: 8px;
                height: 8px;
                -webkit-appearance: none;
            }
            
            ::-webkit-scrollbar-track {
                background-color: rgba(0, 0, 0, 0.05);
                border-radius: 4px;
            }
            
            ::-webkit-scrollbar-thumb {
                background-color: rgba(0, 0, 0, 0.2);
                border-radius: 4px;
            }
            
            ::-webkit-scrollbar-thumb:hover {
                background-color: rgba(0, 0, 0, 0.3);
            }
            
            /* 针对Firefox的滚动条样式 */
            * {
                scrollbar-width: thin;
                scrollbar-color: rgba(0, 0, 0, 0.2) rgba(0, 0, 0, 0.05);
            }
            
            /* 移动端竖屏模式滚动优化 */
            @media (max-width: 768px) and (orientation: portrait) {
                /* 允许body和container自然滚动 */
                body {
                    overflow-y: auto;
                    -webkit-overflow-scrolling: touch;
                    display: block;
                    min-height: auto;
                    /* 性能优化 */
                    -webkit-text-size-adjust: 100%;
                    text-size-adjust: 100%;
                    backface-visibility: hidden;
                    -webkit-backface-visibility: hidden;
                    /* 移除任何可能的边距 */
                    margin: 0;
                    padding: 0;
                }
                
                .container {
                    overflow-y: visible;
                    -webkit-overflow-scrolling: touch;
                    /* 确保容器不会阻止页面滚动 */
                    position: static;
                    min-height: auto;
                    max-height: none;
                    /* 性能优化 */
                    transform: translateZ(0);
                    -webkit-transform: translateZ(0);
                    /* 确保没有额外的内边距 */
                    padding: 0;
                    padding-top: 65px;
                }
                
                /* 优化滚动体验 */
                * {
                    touch-action: manipulation;
                    -webkit-touch-callout: default;
                    /* 性能优化 */
                    will-change: auto;
                }
                
                /* 优化滚动容器 */
                .scrollable {
                    overflow-y: auto;
                    -webkit-overflow-scrolling: touch;
                    /* 硬件加速 */
                    transform: translateZ(0);
                    -webkit-transform: translateZ(0);
                }
                
                /* 确保输入框获得焦点时不会导致页面过度缩放，并优化触摸体验 */
                input, textarea, select {
                    font-size: 16px; /* iOS Safari 强制设置以防止自动缩放 */
                    /* 移除transform缩放，改为直接调整合适的尺寸 */
                    padding: 4px 8px;
                    touch-action: manipulation;
                    -webkit-user-select: text;
                    user-select: text;
                    cursor: text;
                }
                
                /* 优化记录纸单元格以显示更多内容 */
                .cell {
                    min-height: 40px;
                    padding: 4px 8px;
                    font-size: 0.75rem;
                }
                
                /* 进一步减小纸张内边距和外边距 */
                .paper {
                    padding: 3px 6px;
                    margin-bottom: 8px;
                }
                
                /* 在移动设备竖屏模式下禁用横线纸和网格纸背景 */
                @media (max-width: 768px) and (orientation: portrait) {
                    .style-group label:contains('背景图片') + div .bg-image-option[data-image="lined"],
                    .style-group label:contains('背景图片') + div .bg-image-option[data-image="grid"] {
                        display: none !important;
                    }
                    
                    /* 确保移动设备竖屏模式下不显示横线纸和网格纸背景 */
                    .paper.bg-image-lined,
                    .paper.bg-image-grid,
                    .paper.bg-image-lined .grid-container,
                    .paper.bg-image-grid .grid-container {
                        background-image: none !important;
                    }
                    
                    /* 确保CSS选择器兼容性 */
                    .style-group label:nth-of-type(4) + div .bg-image-option[data-image="lined"],
                    .style-group label:nth-of-type(4) + div .bg-image-option[data-image="grid"] {
                        display: none !important;
                    }
                }
                /* 修复移动设备竖屏模式下的网格显示问题 */
                .grid-container {
                    gap: 20px; /* 减小间距，确保在竖屏模式下能更好地展示三列 */
                }
                
                /* 优化列之间的竖线显示，防止出现多余竖线 */
                .column:not(:last-child)::after {
                    right: -10px; /* 调整竖线位置，使其与减小的gap匹配 */
                    width: 1px;
                }
                
                /* 确保网格线高度与宽度比例协调，形成正方形网格 */
                .grid-line {
                    height: 2.5rem; /* 调整高度，使其与宽度更协调 */
                }
                
                /* 确保四格布局也能正确显示 */
                .grid-container.four-column {
                    gap: 15px; /* 减小四格布局的间距 */
                }
                
                /* 减小纸张头部与内容的间距 */
                .paper-header {
                    margin-bottom: 6px;
                    padding-bottom: 3px;
                }
                
                /* 减小纸张标题字体大小 */
                .paper h3 {
                    font-size: 0.9rem;
                    margin: 4px 0;
                }
                
                /* 减小网格线之间的间距 */
                .grid-line {
                    min-height: 36px;
                    line-height: 1.2;
                }
                
                /* 移除可能干扰滚动的样式 */
                * {
                    outline: none;
                    -webkit-outline: none;
                }
            }
            
            /* 移动端按钮间距调整 */
            .modal-actions {
                flex-direction: column;
            }
            
            .modal-actions .btn {
                width: 100%;
                margin-bottom: 10px;
            }
            
            .modal-actions .btn:last-child {
                margin-bottom: 0;
            }
        }
        
        /* 移动端横屏适配 */
        @media (max-height: 480px) and (orientation: landscape) {
            /* 防止body滚动，避免多个滚动条冲突 */
            body {
                overflow: hidden;
                padding-bottom: 0;
            }
            
            /* 调整容器为唯一的滚动元素 */
            .container {
                padding: 10px;
                min-height: 100vh;
                max-height: 100vh;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
                position: relative;
            }
            
            /* 调整头部和标题 */
            .header h1 {
                font-size: 1.4rem; /* 缩小标题字号 */
                margin-bottom: 5px;
            }
            
            /* 调整"极速分类记录事项"文本与下方内容的间距 */
            .header p {
                margin-bottom: 5px; /* 减小与下方内容的间距 */
            }
            
            /* 进一步减小header与controls之间的距离 */
            .header {
                margin-bottom: 0; /* 完全移除头部与控制栏之间的间距 */
            }
            
            /* 控制栏按钮样式 - 显示四个主要按钮并保持在一行 */
            .controls {
                display: flex;
                justify-content: center;
                gap: 6px;
                flex-wrap: nowrap;
            }
            
            .controls .btn {
                flex: 0 0 calc(25% - 6px); /* 每行显示4个按钮 */
                padding: 6px 8px; /* 减小按钮内边距 */
                font-size: 0.8rem; /* 减小按钮字体大小 */
                min-width: auto; /* 允许按钮自适应宽度 */
                height: 36px; /* 减小按钮高度 */
            }
            
            /* 按钮中的SVG图标也需要相应减小 */
            .controls .btn svg {
                width: 14px;
                height: 14px;
            }
            
            /* 只隐藏不需要的控制按钮 */
            .controls #sync-btn,
            .controls #settings-btn {
                display: none; /* 在移动端横屏模式下隐藏这些按钮 */
            }
            
            /* 调整控制栏容器样式 */
            .controls {
                max-width: 100%; /* 确保控制栏占满宽度 */
                margin-top: 0; /* 确保控制栏没有顶部间距 */
                margin-bottom: 15px;
            }
            
            /* 记录纸内容不需要独立滚动，由container统一处理 */
            .notebook-content {
                max-height: none;
                overflow: visible;
            }
            
            /* 移动端横屏模式下的回收站样式 - 美观简约优化版 */
            .recycle-bin {
                position: fixed; /* 固定定位，不随页面滚动 */
                right: 10px; /* 右侧边距 */
                top: 60px; /* 向上移动，减小顶部边距 */
                width: 220px; /* 略微缩小宽度，更紧凑 */
                max-height: calc(100vh - 80px); /* 限制最大高度，确保不超出屏幕 */
                background: white;
                border-radius: var(--radius-medium);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* 更柔和的阴影，更现代 */
                padding: 10px; /* 减小内边距，更紧凑 */
                z-index: 90; /* 确保在普通内容之上 */
                border: 1px solid #f0f0f0; /* 更柔和的边框颜色 */
                animation: fadeIn 0.3s ease;
                display: flex;
                flex-direction: column;
                display: none; /* 默认隐藏 */
                background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); /* 轻微渐变背景，增加层次感 */
            }

            /* 为移动端横屏模式下的回收站头部适配 */
            .recycle-header {
                margin-bottom: 8px; /* 减小间距 */
                padding-bottom: 6px; /* 减小底部内边距 */
                border-bottom: 1px solid #e9ecef; /* 更细的边框 */
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .recycle-header h3 {
                font-size: 0.85rem; /* 缩小字体 */
                font-weight: 600;
                color: #333;
                margin: 0;
            }

            /* 为移动端横屏模式下的回收站项目适配 */
            .recycle-item {
                padding: 6px; /* 减小内边距 */
                margin-bottom: 4px; /* 减小项目间距 */
                border-radius: var(--radius-small);
                transition: all 0.2s ease;
            }

            .recycle-item:hover {
                background-color: #f8f9fa; /* 轻微的悬停效果 */
                transform: translateX(2px); /* 轻微的横向移动，增加交互感 */
            }

            .recycle-item-title {
                font-size: 0.8rem; /* 缩小字体 */
                margin-bottom: 2px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .recycle-item-meta {
                font-size: 0.65rem; /* 缩小字体 */
                color: #666;
            }

            /* 保留移动端横屏模式下回收站的滚动条样式 */
            .recycle-items {
                flex: 1;
                overflow-y: auto;
                margin-bottom: 8px;
                min-height: 0;
            }

            /* 针对移动端横屏模式下的回收站，取消原有的隐藏规则 */
            @media (max-width: 768px) {
                /* 移除强制隐藏回收站的规则，让横屏模式可以显示回收站 */
                .recycle-bin:not(.mobile-recycle-hidden) {
                    display: flex !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                    pointer-events: auto !important;
                    width: 240px !important;
                    height: auto !important;
                    overflow: visible !important;
                }
            }
            
            /* 加宽滚动条以便于用户直接拖动 */
            ::-webkit-scrollbar {
                width: 15px;
                height: 15px;
                -webkit-appearance: none;
            }
            
            ::-webkit-scrollbar-track {
                background-color: rgba(0, 0, 0, 0.05);
                border-radius: 5px;
            }
            
            ::-webkit-scrollbar-thumb {
                background-color: rgba(0, 0, 0, 0.3);
                border-radius: 5px;
            }
            
            /* 针对Firefox的滚动条样式 */
            * {
                scrollbar-width: thin;
                scrollbar-color: rgba(0, 0, 0, 0.3) rgba(0, 0, 0, 0.05);
            }
        }
    </style>
    <style>
        /* 侧边栏导航样式 */
        .sidebar {}
        
        /* 汉堡菜单按钮 */
        .menu-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            background: var(--bg-light);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-small);
            box-shadow: var(--shadow-light);
            cursor: pointer;
            z-index: 1005;
            align-items: center;
            justify-content: center;
        }
        
        .menu-btn svg {
            width: 24px;
            height: 24px;
        }
        
        /* 侧边栏容器 */
        .sidebar-nav {
            position: fixed;
            top: 0;
            left: -220px;
            width: 220px;
            height: 100vh;
            background: white;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.15);
            z-index: 1004;
            transition: left 0.3s ease;
            overflow-y: auto;
            padding-top: 80px;
        }
        
        .sidebar-nav.open {
            left: 0;
        }
        
        /* 侧边栏内容 */
        .sidebar-content {
            padding: 20px;
        }
        
        .sidebar-nav .btn {
            width: 100%;
            margin-bottom: 12px;
            justify-content: flex-start;
        }
        
        .sidebar-nav .btn svg {
            margin-right: 12px;
        }
        
        /* 遮罩层 */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1003;
            display: none;
        }
        
        .sidebar-overlay.visible {
            display: block;
        }
    </style>
</head>
<body>

    
    <!-- 竖屏强制全屏提示覆盖层 -->
    <div class="orientation-overlay" id="portrait-fullscreen-overlay">
        <div class="orientation-icon">📱</div>
                <div class="orientation-submessage">我们建议您将手机翻转到横屏，体验最佳</div>
        <div class="orientation-submessage">为保证功能正常使用，您必须进入全屏模式</div>
        <div class="orientation-submessage">按一次返回键可退出全屏</div>
        <div class="orientation-options">
            <button class="orientation-option-btn" id="enter-portrait-fullscreen-btn" style="background: rgba(76, 175, 80, 0.3); border-color: rgba(76, 175, 80, 0.5);">进入全屏</button>
        </div>
    </div>
    <!-- 侧边栏导航 -->
    <button class="menu-btn" id="menu-btn">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
    </button>
    
    <div class="sidebar-nav" id="sidebar-nav">
        <div class="sidebar-content">
            <button class="btn btn-primary" id="sidebar-new-paper-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                新建记录纸
            </button>
            <button class="btn btn-primary" id="sidebar-new-notebook-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                新建记录本
            </button>

            <button class="btn btn-secondary" id="sidebar-four-column-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="18"></rect><rect x="14" y="3" width="7" height="18"></rect><rect x="8" y="3" width="6" height="18"></rect></svg>
                四格记录
            </button>
            <button class="btn btn-secondary" id="sidebar-template-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
                模板选择
            </button>
            <button class="btn btn-tertiary" id="sidebar-sync-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
                同步与备份
            </button>
            <button class="btn btn-tertiary" id="sidebar-settings-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                设置
            </button>
            
            <!-- 回收站侧边栏按钮 -->
            <button class="btn btn-tertiary" id="sidebar-recycle-btn" style="margin-top: 30px; background: linear-gradient(135deg, #4caf50, #66bb6a); color: white;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"></path><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                回收站
            </button>
        </div>
    </div>
    
    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    
    <div class="container">
        <div class="header">
            <h1>三格记录本</h1>
            <p>极速分类记录事项</p>
        </div>

        <div class="controls">
            <button class="btn btn-primary" id="new-paper-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                新建记录纸
            </button>

            <button class="btn btn-secondary" id="four-column-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="18"></rect><rect x="14" y="3" width="7" height="18"></rect><rect x="8" y="3" width="6" height="18"></rect></svg>
                四格记录
            </button>
            <button class="btn btn-tertiary" id="sync-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
                同步与备份
            </button>
            <button class="btn btn-primary" id="new-notebook-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                新建记录本
            </button>
            <button class="btn btn-secondary" id="template-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
                模板选择
            </button>
            <button class="btn btn-tertiary" id="settings-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                设置
            </button>
        </div>

        <div class="notebook-list" id="notebook-list">
            <h3>
                我的记录本
                <button class="sort-toggle-btn" id="sort-toggle-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
                </button>
                <button class="view-toggle-btn" id="view-toggle-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
                    <span>列表视图</span>
                </button>
            </h3>
            <div id="notebooks-container"></div>
        </div>

        <div id="current-notebook" class="notebook">
            <div id="papers-container"></div>
        </div>
    </div>

    <!-- 新建记录纸模态框 -->
    <div id="new-paper-modal" class="modal">
        <div class="modal-content">
            <h3>新建记录纸</h3>
            <input type="text" id="paper-title" placeholder="请输入记录纸标题">
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px;">添加标签（可选，用逗号分隔）</label>
                <input type="text" id="paper-tags" placeholder="例如：工作,学习,计划">
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" id="confirm-paper-btn">确定</button>
                <button class="btn btn-secondary" id="cancel-paper-btn">取消</button>
            </div>
        </div>
    </div>

    <!-- 模板选择模态框 -->
    <div id="template-modal" class="modal">
        <div class="modal-content">
            <h3>选择记录纸模板</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 12px; margin-bottom: 15px;">
                <div class="template-item" data-template="todo">
                    <div style="font-weight: bold; font-size: 0.95rem; margin-bottom: 3px;">待办事项</div>
                    <div style="font-size: 0.8rem; color: #666;">待办/进行中/已完成</div>
                </div>
                <div class="template-item" data-template="notes">
                    <div style="font-weight: bold; font-size: 0.95rem; margin-bottom: 3px;">学习笔记</div>
                    <div style="font-size: 0.8rem; color: #666;">知识点/重点/总结</div>
                </div>
                <div class="template-item" data-template="meeting">
                    <div style="font-weight: bold; font-size: 0.95rem; margin-bottom: 3px;">会议记录</div>
                    <div style="font-size: 0.8rem; color: #666;">讨论/决议/行动项</div>
                </div>
                <div class="template-item locked" data-template="speaker">
                    <div style="font-weight: bold; font-size: 0.95rem; margin-bottom: 3px;">叭叭的小人</div>
                    <div style="font-size: 0.75rem; color: #666; line-height: 1.3;">醒来的第n个小时/干活啦/做完了没有</div>
                    <div style="font-size: 0.7rem; color: #999; margin-top: 2px;">(已禁用)</div>
                </div>
            </div>
            <input type="text" id="template-paper-title" placeholder="请输入记录纸标题" style="margin-bottom: 12px;">
            <div class="modal-actions">
                <button class="btn btn-primary" id="confirm-template-btn">使用模板</button>
                <button class="btn btn-secondary" id="cancel-template-btn">取消</button>
             </div>
        </div>
    </div>

    <!-- 本地备份与恢复模态框 -->
    <div id="sync-modal" class="modal">
        <div class="modal-content">
            <h3>本地备份与恢复</h3>
            
            <!-- 本地备份与恢复部分 -->
            <div class="sync-section" style="margin-bottom: 15px;">
                <p style="margin-bottom: 15px; color: #666;">备份所有数据到本地文件或从本地文件恢复数据</p>
                <div style="display: flex; justify-content: space-between;">
                    <button class="btn btn-primary" id="local-backup-btn" style="flex: 1; margin-right: 10px;">创建本地备份</button>
                    <button class="btn btn-secondary" id="local-restore-btn" style="flex: 1; margin-left: 10px;">从备份恢复</button>
                </div>
            </div>
            
            <!-- 二维码分享部分 - 已禁用 -->
            <div class="sync-section" style="margin-bottom: 15px; border-top: 1px solid #e0e0e0; padding-top: 15px; display: none;">
                <p style="margin-bottom: 15px; color: #666;">通过二维码分享数据到其他设备</p>
                <div style="display: flex; justify-content: space-between; gap: 10px;">
                    <button class="btn btn-primary" id="generate-qr-btn" style="flex: 1;">生成分享二维码</button>
                    <button class="btn btn-secondary" id="scan-qr-btn" style="flex: 1;">扫描二维码</button>
                </div>
            </div>
            
            <!-- 存储设置部分 -->
            <div class="sync-section" style="margin-bottom: 15px; border-top: 1px solid #e0e0e0; padding-top: 15px;">
                <h4 style="margin-bottom: 10px; color: #333;">存储设置</h4>
                <div class="style-group" style="margin-bottom: 8px;">
                    <label>数据存储位置</label>
                    <div class="style-options" style="display: flex; flex-wrap: wrap; gap: 10px;">
                        <div class="storage-option" style="margin-bottom: 0; display: flex; align-items: center; padding: 4px 8px; border-radius: var(--radius-small); transition: background-color 0.2s;">
                            <input type="radio" id="local-storage" name="storage-type" value="local" checked>
                            <label for="local-storage" style="margin-left: 6px; cursor: pointer; white-space: nowrap;">本地存储</label>
                        </div>
                        <div class="storage-option" style="margin-bottom: 0; display: flex; align-items: center; padding: 4px 8px; border-radius: var(--radius-small); transition: background-color 0.2s;">
                            <input type="radio" id="cloud-storage" name="storage-type" value="cloud" disabled>
                            <label for="cloud-storage" style="margin-left: 6px; cursor: not-allowed; opacity: 0.7; white-space: nowrap;">云存储 <span style="color: #999; font-size: 0.85rem;">(暂未开放)</span></label>
                        </div>
                    </div>
                </div>
                
                <div class="style-group" style="margin-bottom: 5px;">
                    <label>数据存储目录</label>
                    <div class="storage-path-container" style="margin-top: 3px; display: flex; align-items: center; gap: 6px;">
                        <input type="text" id="storage-path" readonly style="
                            flex: 1;
                            padding: 6px 10px;
                            border: 1px solid var(--border-light);
                            border-radius: var(--radius-small);
                            background-color: var(--bg-light);
                            font-size: 0.9rem;
                            color: var(--text-secondary);
                        " value="浏览器本地存储 (localStorage)">
                        <button id="change-storage-path" class="btn btn-primary" style="
                            padding: 6px 14px;
                            background-color: var(--primary-color);
                            color: white;
                            border: none;
                            border-radius: var(--radius-small);
                            cursor: pointer;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            transition: background-color 0.2s ease;
                            min-height: 32px;
                        ">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" style="transform: translateY(-4px) !important;">
                                <path d="M3 7h18v14H3z"></path>
                                <path d="M10 13h4"></path>
                                <path d="M7 7v0c0-1.1.9-2 2-2h8c1.1 0 2 .9 2 2v0h0"></path>
                            </svg>
                        </button>
                    </div>
                    <p style="margin-top: 4px; font-size: 0.85rem; color: var(--text-secondary);">
                        数据将保存在您的浏览器本地存储中，清除浏览器缓存可能会导致数据丢失。
                    </p>
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancel-sync-btn">关闭</button>
            </div>
        </div>
    </div>
    
    <!-- 二维码显示模态框 - 优化样式 - 已禁用 -->
    <div id="qr-modal" class="modal" style="display: none !important;">
        <div class="modal-content" style="width: 360px; max-width: 95%; position: relative; background: linear-gradient(145deg, #ffffff, #f8f9fa); border-radius: var(--radius-large); padding: 20px 20px; box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12); border: none; box-sizing: border-box; overflow-x: auto;">
            <h3 style="text-align: center; color: var(--primary-color); margin-bottom: 8px; font-size: 1.3rem; font-weight: 700; padding-bottom: 6px; position: relative;">
                扫描二维码分享数据
                <span style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 50px; height: 3px; background: linear-gradient(90deg, var(--primary-color), var(--secondary-color)); border-radius: 2px;"></span>
            </h3>
            
            <p style="margin-bottom: 15px; color: var(--text-secondary); text-align: center; font-size: 0.85rem;">请使用其他设备扫描下方二维码获取数据</p>
            
            <div style="display: flex; justify-content: center; margin-bottom: 15px; overflow: hidden;">
                <div id="qr-code-container" style="padding: 15px; background: white; border-radius: var(--radius-medium); box-shadow: var(--shadow-light);">
                    <!-- 二维码将在这里生成 -->
                </div>
            </div>
            
            <div style="text-align: center; margin-bottom: 15px; padding: 10px; background: var(--bg-light); border-radius: var(--radius-small); border-left: 3px solid var(--warning-color);">
                <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 3px;">有效期：2分钟</p>
                <p id="qr-expire-countdown" style="color: var(--accent-color); font-weight: bold; font-size: 0.95rem;">120</p>
            </div>
            
            <div class="modal-actions" style="justify-content: center; gap: 15px; flex-wrap: wrap;">
                <button class="btn btn-secondary" id="cancel-qr-btn" style="min-width: 100px; padding: 10px 20px; transition: all 0.3s ease;">关闭</button>
                <button class="btn btn-primary" id="refresh-qr-btn" style="min-width: 120px; padding: 10px 24px; transition: all 0.3s ease;">刷新二维码</button>
            </div>
            
            <!-- 响应式设计脚本 -->
            <script>
                // 监听窗口尺寸变化，调整二维码大小
                function adjustQrCodeSize() {
            // 二维码功能已禁用，此函数不再需要
        }
                
                // 在模态框显示时调用调整函数 - 已禁用二维码功能，移除相关事件监听
                // document.getElementById('generate-qr-btn')?.addEventListener('click', adjustQrCodeSize);
                // document.getElementById('refresh-qr-btn')?.addEventListener('click', adjustQrCodeSize);
                
                // 监听窗口尺寸变化和设备方向变化 - 已禁用二维码功能，移除相关事件监听
                // window.addEventListener('resize', adjustQrCodeSize);
                // window.addEventListener('orientationchange', adjustQrCodeSize);
            </script>
        </div>
    </div>

    <!-- 二维码扫描模态框 - 已禁用 -->
    <div id="scan-modal" class="modal" style="display: none !important;">
        <div class="modal-content" style="width: 100vw; height: 100vh; max-width: none; max-height: none; position: fixed; top: 0; left: 0; margin: 0; padding: 0; border: none; border-radius: 0; background: transparent; overflow: hidden;">
            
            <!-- 视频容器，全屏覆盖 -->
            <div id="scanner-container" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #000;">
                <!-- 视频元素将在这里动态创建 -->
                
                <!-- 半透明遮罩层 - 四个方向的黑色遮罩，中间留出扫描区域 -->
                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0;">
                    <!-- 顶部遮罩 -->
                    <div style="position: absolute; top: 0; left: 0; right: 0; height: calc(50vh - 140px); background: rgba(0, 0, 0, 0.6);"></div>
                    <!-- 底部遮罩 -->
                    <div style="position: absolute; bottom: 0; left: 0; right: 0; height: calc(50vh - 140px); background: rgba(0, 0, 0, 0.6);"></div>
                    <!-- 左侧遮罩 -->
                    <div style="position: absolute; top: calc(50vh - 140px); left: 0; width: calc(50vw - 140px); height: 280px; background: rgba(0, 0, 0, 0.6);"></div>
                    <!-- 右侧遮罩 -->
                    <div style="position: absolute; top: calc(50vh - 140px); right: 0; width: calc(50vw - 140px); height: 280px; background: rgba(0, 0, 0, 0.6);"></div>
                </div>
                
                <!-- 扫描框指示器（包含扫描线和四角） -->
                <div id="scanning-indicator" style="position: absolute; top: 50%; left: 50%; width: 280px; height: 280px; transform: translate(-50%, -50%); pointer-events: none;">
                    <!-- 扫描线动画 -->
                    <div style="position: absolute; top: 0; left: 0; right: 0; height: 2px; background: rgba(76, 175, 80, 0.8); animation: scan-line 2s linear infinite;"></div>
                    
                    <!-- 四个角 -->
                    <div style="position: absolute; top: -2px; left: -2px; width: 20px; height: 20px; border-top: 3px solid #4caf50; border-left: 3px solid #4caf50; border-radius: 4px 0 0 0;"></div>
                    <div style="position: absolute; top: -2px; right: -2px; width: 20px; height: 20px; border-top: 3px solid #4caf50; border-right: 3px solid #4caf50; border-radius: 0 4px 0 0;"></div>
                    <div style="position: absolute; bottom: -2px; left: -2px; width: 20px; height: 20px; border-bottom: 3px solid #4caf50; border-left: 3px solid #4caf50; border-radius: 0 0 0 4px;"></div>
                    <div style="position: absolute; bottom: -2px; right: -2px; width: 20px; height: 20px; border-bottom: 3px solid #4caf50; border-right: 3px solid #4caf50; border-radius: 0 0 4px 0;"></div>
                </div>
                
                <!-- 关闭按钮 -->
                <div id="close-scan-btn" style="position: absolute; top: 20px; right: 20px; width: 44px; height: 44px; border-radius: 50%; background: rgba(0, 0, 0, 0.5); color: white; display: flex; align-items: center; justify-content: center; font-size: 24px; cursor: pointer; z-index: 1000; transition: all 0.3s ease;">✕</div>
                
                <!-- 取消按钮 -->
                <button id="cancel-scan-btn" style="position: absolute; bottom: 60px; left: 50%; transform: translateX(-50%); padding: 12px 32px; background: rgba(255, 255, 255, 0.9); color: #333; border: none; border-radius: 25px; font-size: 16px; font-weight: 600; cursor: pointer; z-index: 1000; transition: all 0.3s ease;">取消</button>
                
                <!-- 提示文字 -->
                <div style="position: absolute; bottom: 120px; left: 0; right: 0; text-align: center; color: white; font-size: 16px; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);">
                    将二维码对准扫描框
                </div>
            </div>
            
            <!-- 扫描动画样式 -->
            <style>
                @keyframes scan-line {
                    0% { top: 0; opacity: 0.8; }
                    50% { opacity: 1; }
                    100% { top: 100%; opacity: 0.8; }
                }
                
                #cancel-scan-btn:hover {
                    background: white;
                    transform: translateX(-50%) scale(1.05);
                }
                
                #close-scan-btn:hover {
                    background: rgba(0, 0, 0, 0.7);
                    transform: scale(1.1);
                }
                
                /* 响应式调整 */
                @media (max-width: 480px) {
                    #scanning-indicator {
                        width: 240px !important;
                        height: 240px !important;
                    }
                    
                    #cancel-scan-btn {
                        padding: 10px 24px !important;
                        font-size: 14px !important;
                    }
                }
            </style>
        </div>
    </div>

    <!-- 记录纸操作菜单 -->
    <div id="paper-menu" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>记录纸操作</h3>
            <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px;">
                <button class="btn btn-secondary" id="add-image-btn" style="justify-content: flex-start;">插入图片</button>
                <button class="btn btn-secondary" id="rich-text-btn" style="justify-content: flex-start;">富文本编辑</button>
                <button class="btn btn-secondary" id="add-tags-btn" style="justify-content: flex-start;">添加/编辑标签</button>
                <button class="btn btn-primary" id="delete-paper-btn" style="justify-content: flex-start; background: linear-gradient(45deg, #ff6b6b, #ee5a5a);">删除记录纸</button>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="close-paper-menu-btn">关闭</button>
            </div>
        </div>
    </div>

    <!-- 图片插入模态框 -->
    <div id="image-modal" class="modal">
        <div class="modal-content">
            <h3>插入图片</h3>
            <p style="margin-bottom: 10px; color: #666;">请选择要插入的位置：</p>
            <div style="margin-bottom: 15px;">
                <select id="image-column">
                    <option value="0">第一列</option>
                    <option value="1">第二列</option>
                    <option value="2">第三列</option>
                    <option value="3">第四列</option>
                </select>
                <select id="image-row">
                    <!-- 动态生成行选项 -->
                </select>
            </div>
            <p style="margin-bottom: 10px; color: #666;">请输入图片URL：</p>
            <input type="text" id="image-url" placeholder="https://example.com/image.jpg" style="margin-bottom: 20px;">
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancel-image-btn">取消</button>
                <button class="btn btn-primary" id="confirm-image-btn">插入</button>
            </div>
        </div>
    </div>

    <!-- 富文本编辑模态框 -->
    <div id="rich-text-modal" class="modal">
        <div class="modal-content">
            <h3>富文本编辑</h3>
            <p style="margin-bottom: 10px; color: #666;">请选择要编辑的位置：</p>
            <div style="margin-bottom: 15px;">
                <select id="rich-text-column">
                    <option value="0">第一列</option>
                    <option value="1">第二列</option>
                    <option value="2">第三列</option>
                    <option value="3">第四列</option>
                </select>
                <select id="rich-text-row">
                    <!-- 动态生成行选项 -->
                </select>
            </div>
            <div style="border: 1px solid #ddd; border-radius: 5px; padding: 10px; margin-bottom: 20px;">
                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <button class="btn btn-sm" id="format-bold">B</button>
                    <button class="btn btn-sm" id="format-italic">I</button>
                    <button class="btn btn-sm" id="format-underline">U</button>
                    <select id="format-color">
                        <option value="black">黑色</option>
                        <option value="red">红色</option>
                        <option value="blue">蓝色</option>
                        <option value="green">绿色</option>
                    </select>
                </div>
                <textarea id="rich-text-content" rows="10" style="width: 100%; border: 1px solid #ddd; border-radius: 5px; padding: 10px;"></textarea>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancel-rich-text-btn">取消</button>
                <button class="btn btn-primary" id="confirm-rich-text-btn">应用</button>
            </div>
        </div>
    </div>

    <!-- 标签编辑模态框 -->
    <div id="tags-modal" class="modal">
        <div class="modal-content">
            <h3>编辑标签</h3>
            <input type="text" id="edit-paper-tags" placeholder="标签（用逗号分隔）">
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancel-tags-btn">取消</button>
                <button class="btn btn-primary" id="confirm-tags-btn">保存</button>
            </div>
        </div>
    </div>

    <!-- 设置模态框 -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <!-- 标题和标签行容器 - 固定在顶部 -->
            <div class="modal-header">
                <h3>设置</h3>
                
                <div class="settings-tabs">
                    <button class="tab-btn active" data-tab="paper-style">记录纸样式</button>
                    <button class="tab-btn" data-tab="theme">主题设置</button>
                    <button class="tab-btn" data-tab="alignment">对齐设置</button>
                </div>
            </div>
            
            <!-- 内容区域容器 - 可滚动 -->
            <div class="tab-content-container">
                <div class="tab-content" id="paper-style-content">
                <style>
                    .bg-image-option {
                        padding: 8px 16px;
                        border: 1px solid var(--border-light);
                        border-radius: var(--radius-small);
                        cursor: pointer;
                        transition: all 0.3s ease;
                        text-align: center;
                        font-size: 0.85rem;
                        background: white;
                    }
                    
                    .bg-image-option:hover {
                        background: var(--bg-light);
                    }
                    
                    .bg-image-option.active {
                        background: var(--primary-color);
                        color: white;
                        border-color: var(--primary-color);
                    }
                    
                    /* 背景图片样式类 - 调整为与单元格高度精确匹配 */
                    /* 横线纸样式 */
                    .paper.bg-image-lined {
                        background-image: linear-gradient(to bottom, transparent calc(100% - 1px), var(--border-light) 1px);
                        background-size: 100% 2.8125rem;
                    }
                    
                    /* 网格纸样式 - 确保网格为正方形且与输入区精确对齐 */
                    .paper.bg-image-grid {
                        background-image:
                            linear-gradient(to right, var(--border-light) 1px, transparent 1px),
                            linear-gradient(to bottom, var(--border-light) 1px, transparent 1px);
                        background-size: 2.8125rem 2.8125rem;
                        background-position: 0 0;
                        background-repeat: repeat;
                        background-attachment: scroll;
                    }
                    
                    /* 点阵纸样式 - 确保点阵在输入区垂直居中 */
                    .paper.bg-image-dot {
                        background-image: radial-gradient(var(--border-light) 1px, transparent 1px);
                        background-size: 2.8125rem 2.8125rem;
                        background-position: 0 10px;
                        background-repeat: repeat;
                        background-attachment: local;
                    }
                    
                    /* 四格记录纸特定样式 - 横线纸 */
                    .paper.bg-image-lined .grid-container.four-column {
                        background-image: linear-gradient(to bottom, transparent calc(100% - 1px), var(--border-light) 1px);
                        background-size: 100% 2.8125rem;
                    }
                    
                    /* 四格记录纸特定样式 - 网格纸 */
                    .paper.bg-image-grid .grid-container.four-column {
                        background-image:
                            linear-gradient(to right, var(--border-light) 1px, transparent 1px),
                            linear-gradient(to bottom, var(--border-light) 1px, transparent 1px);
                        background-size: 2.8125rem 2.8125rem;
                        background-position: 0 0;
                        background-repeat: repeat;
                        background-attachment: scroll;
                    }
                    
                    /* 四格记录纸特定样式 - 点阵纸 */
                    .paper.bg-image-dot .grid-container.four-column {
                        background-image: radial-gradient(var(--border-light) 1px, transparent 1px);
                        background-size: 2.8125rem 2.8125rem;
                        background-position: 0 10px;
                        background-repeat: repeat;
                        background-attachment: local;
                    }
                    
                    /* 响应式调整背景图片大小 - 与单元格高度同步调整 */
                    @media (max-width: 768px) {
                        .grid-line {
                            height: 2.1rem;

                        
                        .paper.bg-image-lined, .paper.bg-image-lined .grid-container.four-column {
                            background-size: 100% 2.1rem;
                        }
                        
                        .paper.bg-image-grid, .paper.bg-image-grid .grid-container.four-column {
                            background-size: 2.1rem 2.1rem;
                            background-position: 0 0;
                            background-repeat: repeat;
                            background-attachment: scroll;
                        }
                        
                        .paper.bg-image-dot, .paper.bg-image-dot .grid-container.four-column {
                            background-size: 2.1rem 2.1rem;
                            background-position: 0 0;
                            background-repeat: repeat;
                            background-attachment: local;
                        }
                        
                        /* 响应式下网格纸背景的选中记录纸 - 移除行线条保留竖线条 */
                        .paper.selected.bg-image-grid {
                            background-image: linear-gradient(to right, var(--border-light) 1px, transparent 1px);
                        }
                        
                        .paper.selected.bg-image-grid .grid-container.four-column {
                            background-image: linear-gradient(to right, var(--border-light) 1px, transparent 1px);
                        }
                        
                        /* 响应式下确保输入区下边界与网格纸方格下边线平齐 */
                        .paper.bg-image-grid .grid-line {
                            height: calc(2.1rem - 1px);
                            border-bottom: none;
                        }
                        
                        .paper.bg-image-grid .grid-container.four-column .grid-line {
                            height: calc(2.1rem - 1px);
                            border-bottom: none;
                        }
                    }
                    
                    /* 横屏模式进一步优化 - 与单元格高度同步调整 */
                    @media (max-height: 480px) and (orientation: landscape) {
                        .grid-line {
                            height: 1.75rem;
                        }
                        
                        .paper.bg-image-lined, .paper.bg-image-lined .grid-container.four-column {
                            background-size: 100% 1.75rem;
                        }
                        
                        .paper.bg-image-grid, .paper.bg-image-grid .grid-container.four-column {
                            background-size: 1.75rem 1.75rem;
                            background-position: 0 0;
                            background-repeat: repeat;
                            background-attachment: scroll;
                        }
                        
                        .paper.bg-image-dot, .paper.bg-image-dot .grid-container.four-column {
                            background-size: 1.75rem 1.75rem;
                            background-position: 0 0;
                            background-repeat: repeat;
                            background-attachment: local;
                        }
                        
                        /* 横屏模式下网格纸背景的选中记录纸 - 移除行线条保留竖线条 */
                        .paper.selected.bg-image-grid {
                            background-image: linear-gradient(to right, var(--border-light) 1px, transparent 1px);
                        }
                        
                        .paper.selected.bg-image-grid .grid-container.four-column {
                            background-image: linear-gradient(to right, var(--border-light) 1px, transparent 1px);
                        }
                        
                        /* 横屏模式下确保输入区下边界与网格纸方格下边线平齐 */
                        .paper.bg-image-grid .grid-line {
                            height: calc(1.75rem - 1px);
                            border-bottom: none;
                        }
                        
                        .paper.bg-image-grid .grid-container.four-column .grid-line {
                            height: calc(1.75rem - 1px);
                            border-bottom: none;
                        }
                    }
                    
                    /* 自定义背景图片样式 */
                    .paper.bg-image-custom {
                        background-size: cover;
                        background-position: center;
                        background-repeat: no-repeat;
                        background-color: #ffffff;
                    }
                    
                    /* 叭叭的小人模板背景图片样式 - 增加优先级确保正确显示 */
        .paper.bg-image-speaker {
            background-image: url("叭叭叭的小人模板背景图.png") !important;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #ffffff;
        }
                </style>

                <div class="style-group">
                    <label>背景图片</label>
                    <div style="display: flex; flex-direction: column; gap: 6px;">
                        <input type="file" id="background-image-upload" accept="image/*" style="padding: 6px;">
                        <div id="background-image-preview" style="display: none; text-align: center;">
                            <img id="preview-image" style="max-width: 100%; max-height: 150px; border-radius: 5px; border: 1px solid var(--border-light);">
                            <button id="remove-background-image" class="btn btn-sm btn-danger" style="margin-top: 8px;">移除图片</button>
                        </div>
                        <div class="style-options" style="margin-top: 6px;">
                            <div class="bg-image-option" data-image="none">无背景</div>
                            <div class="bg-image-option" data-image="lined">横线纸</div>
                            <div class="bg-image-option" data-image="grid">网格纸</div>
                            <div class="bg-image-option" data-image="dot">点阵纸</div>
                        </div>
                    </div>
                </div>

                <div class="style-group">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <label>行线条样式</label>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-xs" id="apply-line-style-current">应用到本记录纸</button>
                            <button class="btn btn-xs" id="apply-line-style-all">应用到全部</button>
                        </div>
                    </div>
                    <div class="style-options" style="margin-top: 10px;">
                        <div class="line-style-option dashed" data-style="dashed" data-label="虚线"></div>
                        <div class="line-style-option solid" data-style="solid" data-label="实线"></div>
                        <div class="line-style-option dotted" data-style="dotted" data-label="点线"></div>
                        <div class="line-style-option double" data-style="double" data-label="双实线"></div>
                    </div>
                </div>
                
                <div class="style-group">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <label>竖线条样式</label>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-xs" id="apply-column-style-current">应用到本记录纸</button>
                            <button class="btn btn-xs" id="apply-column-style-all">应用到全部</button>
                        </div>
                    </div>
                    <div class="style-options" id="column-border-style-options" style="margin-top: 10px;">
                        <div class="line-style-option dashed" data-style="dashed" data-label="虚线"></div>
                        <div class="line-style-option solid" data-style="solid" data-label="实线"></div>
                        <div class="line-style-option dotted" data-style="dotted" data-label="点线"></div>
                    </div>
                </div>
                
                <div class="style-group">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <label>线条颜色</label>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-xs" id="apply-line-color-current">应用到本记录纸</button>
                            <button class="btn btn-xs" id="apply-line-color-all">应用到全部</button>
                        </div>
                    </div>
                    <div class="style-options" style="margin-bottom: 12px; margin-top: 10px;">
                        <div class="color-option" style="background: #000000;" data-color="#000000"></div>
                        <div class="color-option" style="background: #ff6b6b;" data-color="#ff6b6b"></div>
                        <div class="color-option" style="background: #4ecdc4;" data-color="#4ecdc4"></div>
                        <div class="color-option" style="background: #ffe66d;" data-color="#ffe66d"></div>
                        <div class="color-option" style="background: #667eea;" data-color="#667eea"></div>
                        <div class="color-option" style="background: #48bb78;" data-color="#48bb78"></div>
                        <div class="color-option" style="background: #9f7aea;" data-color="#9f7aea"></div>
                        <div class="color-option" style="background: #f56565;" data-color="#f56565"></div>
                        <div class="color-option" style="background: #ed8936;" data-color="#ed8936"></div>
                        <div class="color-option" style="background: #4a5568;" data-color="#4a5568"></div>
                    </div>
                    <div class="style-options">
                        <div class="color-option" style="background: #ffedcc;" data-color="#ffedcc"></div>
                        <div class="color-option" style="background: #ccf6ff;" data-color="#ccf6ff"></div>
                        <div class="color-option" style="background: #e5ffcc;" data-color="#e5ffcc"></div>
                        <div class="color-option" style="background: #ffcceb;" data-color="#ffcceb"></div>
                        <div class="color-option" style="background: #e6ccff;" data-color="#e6ccff"></div>
                        <div class="color-option" style="background: #f0f0d8;" data-color="#f0f0d8"></div>
                        <div class="color-option" style="background: #d9f0ff;" data-color="#d9f0ff"></div>
                        <div class="color-option" style="background: #fff5cc;" data-color="#fff5cc"></div>
                        <div class="color-option" style="background: #ccebff;" data-color="#ccebff"></div>
                        <div class="color-option" style="background: #ccffec;" data-color="#ccffec"></div>
                    </div>
                </div>
                
                <div class="style-group">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <label>背景颜色</label>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-xs" id="apply-bg-color-current">应用到本记录纸</button>
                            <button class="btn btn-xs" id="apply-bg-color-all">应用到全部</button>
                        </div>
                    </div>
                    <div class="style-options" style="margin-top: 10px;">
                        <div class="bg-option" style="background: #ffffff;" data-bg="#ffffff"></div>
                        <div class="bg-option" style="background: #f9f7f1;" data-bg="#f9f7f1"></div>
                        <div class="bg-option" style="background: #e6f7ff;" data-bg="#e6f7ff"></div>
                        <div class="bg-option" style="background: #fff7e6;" data-bg="#fff7e6"></div>
                        <div class="bg-option" style="background: #f6ffed;" data-bg="#f6ffed"></div>
                        <div class="bg-option" style="background: #faf5ff;" data-bg="#faf5ff"></div>
                        <div class="bg-option" style="background: #fff5f5;" data-bg="#fff5f5"></div>
                        <div class="bg-option" style="background: #edf2f7;" data-bg="#edf2f7"></div>
                        <div class="bg-option" style="background: #e6fffa;" data-bg="#e6fffa"></div>
                        <div class="bg-option" style="background: #f8f5f2;" data-bg="#f8f5f2"></div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="theme-content" style="display: none;">
                <div class="style-group">
                    <label>主题颜色</label>
                    <div class="style-options">
                        <div class="theme-option" data-theme="default">
                            <div style="display: flex;">
                                <div style="background: #3a86ff; width: 20px; height: 20px;"></div>
                                <div style="background: #8338ec; width: 20px; height: 20px;"></div>
                            </div>
                            <span>默认</span>
                        </div>
                        <div class="theme-option" data-theme="dark">
                            <div style="display: flex;">
                                <div style="background: #2d3748; width: 20px; height: 20px;"></div>
                                <div style="background: #4a5568; width: 20px; height: 20px;"></div>
                            </div>
                            <span>暗黑</span>
                        </div>
                        <div class="theme-option" data-theme="pastel">
                            <div style="display: flex;">
                                <div style="background: #ff9e9e; width: 20px; height: 20px;"></div>
                                <div style="background: #ffd9c0; width: 20px; height: 20px;"></div>
                            </div>
                            <span>柔和</span>
                        </div>
                        <div class="theme-option" data-theme="vibrant">
                            <div style="display: flex;">
                                <div style="background: #ff0054; width: 20px; height: 20px;"></div>
                                <div style="background: #1e3a8a; width: 20px; height: 20px;"></div>
                            </div>
                            <span>鲜艳</span>
                        </div>
                    </div>
                </div>
                
                <div class="style-group" style="margin-top: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <label>文字颜色</label>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-xs" id="apply-text-color-current">应用到本记录纸</button>
                            <button class="btn btn-xs" id="apply-text-color-all">应用到全部</button>
                        </div>
                    </div>
                    <div class="style-options" style="margin-top: 10px;">
                        <div class="text-color-option color-option" style="background: #000000;" data-color="#000000"></div>
                        <div class="text-color-option color-option" style="background: #ffffff; border: 1px solid #cccccc;" data-color="#ffffff"></div>
                        <div class="text-color-option color-option" style="background: #666666;" data-color="#666666"></div>
                        <div class="text-color-option color-option" style="background: #999999;" data-color="#999999"></div>
                        <div class="text-color-option color-option" style="background: #ff6b6b;" data-color="#ff6b6b"></div>
                        <div class="text-color-option color-option" style="background: #4ecdc4;" data-color="#4ecdc4"></div>
                        <div class="text-color-option color-option" style="background: #ffe66d;" data-color="#ffe66d"></div>
                        <div class="text-color-option color-option" style="background: #667eea;" data-color="#667eea"></div>
                        <div class="text-color-option color-option" style="background: #48bb78;" data-color="#48bb78"></div>
                        <div class="text-color-option color-option" style="background: #9f7aea;" data-color="#9f7aea"></div>
                        <div class="text-color-option color-option" style="background: #f56565;" data-color="#f56565"></div>
                        <div class="text-color-option color-option" style="background: #ed8936;" data-color="#ed8936"></div>
                        <div class="text-color-option color-option" style="background: #2dd4bf;" data-color="#2dd4bf"></div>
                        <div class="text-color-option color-option" style="background: #db2777;" data-color="#db2777"></div>
                        <div class="text-color-option color-option" style="background: #f97316;" data-color="#f97316"></div>
                        <div class="text-color-option color-option" style="background: #ffe4e1; border: 1px solid #cccccc;" data-color="#ffe4e1"></div>
                        <div class="text-color-option color-option" style="background: #e0f7fa; border: 1px solid #cccccc;" data-color="#e0f7fa"></div>
                        <div class="text-color-option color-option" style="background: #e8f5e9; border: 1px solid #cccccc;" data-color="#e8f5e9"></div>
                        <div class="text-color-option color-option" style="background: #f3e5f5; border: 1px solid #cccccc;" data-color="#f3e5f5"></div>
                    </div>
                </div>
                
                <div class="style-group" style="margin-top: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <label>字号设置</label>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-xs" id="apply-font-size-current">应用到本记录纸</button>
                            <button class="btn btn-xs" id="apply-font-size-all">应用到全部</button>
                        </div>
                    </div>
                    <div class="style-options" style="margin-top: 10px;">
                        <select id="font-size-select" style="padding: 6px 12px; border: 1px solid var(--border-medium); border-radius: var(--radius-small); background: white; font-size: 0.9rem;">
                            <option value="12px">12px - 小</option>
                            <option value="14px" selected>14px - 标准</option>
                            <option value="16px">16px - 中</option>
                            <option value="18px">18px - 大</option>
                            <option value="20px">20px - 较大</option>
                            <option value="24px">24px - 超大</option>
                        </select>
                    </div>
                </div>
                
                <div class="style-group" style="margin-top: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <label>字体设置</label>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-xs" id="apply-font-current">应用到本记录纸</button>
                            <button class="btn btn-xs" id="apply-font-all">应用到全部</button>
                        </div>
                    </div>
                    <div class="style-options" style="margin-top: 10px; flex-wrap: wrap; display: flex; gap: 6px; justify-content: flex-start;">
                        <div class="font-option" data-font="SimSun, serif" style="margin: 2px 2px; padding: 4px 5px; font-size: 12px;">宋体</div>
                        <div class="font-option" data-font="Microsoft YaHei, sans-serif" style="margin: 2px 2px; padding: 4px 5px; font-size: 12px;">微软雅黑</div>
                        <div class="font-option" data-font="Courier New, monospace" style="margin: 2px 2px; padding: 4px 5px; font-size: 12px;">等宽字体</div>
                        <div class="font-option" data-font="KaiTi, STKaiti, serif" style="margin: 2px 2px; padding: 4px 5px; font-size: 12px;">楷体</div>
                        <div class="font-option" data-font="SimHei, STHeiti, sans-serif" style="margin: 2px 2px; padding: 4px 5px; font-size: 12px;">黑体</div>
                        <div class="font-option" data-font="YouYuan, STKaiti, serif" style="margin: 2px 2px; padding: 4px 5px; font-size: 12px;">幼圆</div>
                        <div class="font-option" data-font="FangSong, STFangsong, serif" style="margin: 2px 2px; padding: 4px 5px; font-size: 12px;">仿宋</div>
                        <div class="font-option" data-font="FZShuTi, STKaiti, serif" style="margin: 2px 2px; padding: 4px 5px; font-size: 12px;">方正舒体</div>
                        <div class="font-option" data-font="FZYaoTi, STKaiti, serif" style="margin: 2px 2px; padding: 4px 5px; font-size: 12px;">方正姚体</div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="alignment-content" style="display: none;">
                <div class="style-group">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <label style="text-align: left; display: block; margin: 0;">记录纸的文字对齐方式</label>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-sm btn-secondary" id="apply-to-current-paper" style="padding: 4px 10px; font-size: 12px;">应用到本记录纸</button>
                        <button class="btn btn-sm btn-primary" id="apply-to-all-papers" style="padding: 4px 10px; font-size: 12px;">应用到全部</button>
                    </div>
                </div>
                    <div class="style-options">
                        <div class="alignment-option" data-alignment="left" data-label="左对齐">
                            <span>左对齐</span>
                        </div>
                        <div class="alignment-option" data-alignment="center" data-label="居中对齐">
                            <span>居中对齐</span>
                        </div>
                        <div class="alignment-option" data-alignment="right" data-label="右对齐">
                            <span>右对齐</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 存储设置已移动到同步与备份菜单 -->
        </div>

        <div class="modal-actions">
                <button class="btn btn-primary" id="confirm-settings-btn">应用</button>
                <button class="btn btn-secondary" id="cancel-settings-btn">取消</button>
            </div>
        </div>
    </div>

    <!-- 回收站 -->
    <div class="recycle-bin">
        <div class="recycle-header">
            <h3>回收站</h3>
            <span class="recycle-count" id="recycle-count">0</span>
        </div>
        <div class="recycle-items" id="recycle-items">
            <div style="text-align: center; color: #999; font-size: 0.9rem;">回收站为空</div>
        </div>
        <div class="recycle-footer" style="flex-shrink: 0; display: flex; justify-content: space-between; align-items: center; margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border-light);">
            <!-- 左侧收起按钮 -->
            <div class="btn-with-tooltip" style="position: relative;">
                <button id="collapse-recycle-btn" style="background: var(--bg-light); border: none; border-radius: var(--radius-small); width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                </button>
                <span class="tooltip-text" style="visibility: hidden; opacity: 0; transition: opacity 0.3s; position: absolute; top: 50%; left: 100%; transform: translateY(-50%); margin-left: 5px; padding: 4px 8px; background-color: rgba(0, 0, 0, 0.7); color: white; font-size: 0.75rem; border-radius: 4px; white-space: nowrap; z-index: 1000;">收起</span>
            </div>
            <!-- 右侧清空按钮 -->
            <button class="empty-btn" id="empty-recycle-btn" disabled>清空回收站</button>
        </div>
    </div>
    
    <!-- 移动端回收站弹窗 -->
    <div class="mobile-recycle-modal" id="mobile-recycle-modal" style="display: none;">
        <div class="mobile-recycle-content">
            <div class="mobile-recycle-header">
                <h3>回收站</h3>
                <button class="mobile-recycle-close" id="mobile-recycle-close">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
            </div>
            <div class="mobile-recycle-body">
                <div class="recycle-filter-buttons" id="mobile-recycle-filter">
                    <button class="filter-btn active" data-filter="all">全部</button>
                    <button class="filter-btn" data-filter="paper">记录纸</button>
                    <button class="filter-btn" data-filter="notebook">记录本</button>
                </div>
                <div class="recycle-items" id="mobile-recycle-items">
                    <div style="text-align: center; color: #999; font-size: 0.9rem;">回收站为空</div>
                </div>
            </div>
            <div class="mobile-recycle-footer">
                <button class="btn btn-secondary" id="mobile-recycle-close-btn">关闭</button>
                <button class="btn btn-danger" id="mobile-empty-recycle-btn" disabled>清空回收站</button>
            </div>
        </div>
    </div>

    <!-- 新建记录本模态框 -->
    <div id="new-notebook-modal" class="modal">
        <div class="modal-content">
            <h3>新建记录本</h3>
            <input type="text" id="notebook-title" placeholder="请输入记录本标题">
            <div class="modal-actions">
                <button class="btn btn-primary" id="confirm-notebook-btn">确定</button>
                <button class="btn btn-secondary" id="cancel-notebook-btn">取消</button>
            </div>
        </div>
    </div>

    <!-- 删除确认模态框 - 简化版本 -->
    <div id="delete-confirm-modal" class="modal">
        <div class="modal-content delete-confirm-content">
            <div class="delete-confirm-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" fill="#fee2e2"/>
                    <path d="M15.5 8.5L8.5 15.5" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M15.5 15.5L8.5 8.5" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <h3 id="delete-confirm-title" class="delete-confirm-title">确认删除</h3>
            <p id="delete-confirm-message" class="delete-confirm-message">您确定要执行此操作吗？</p>
            <div class="delete-confirm-actions">
                <button id="delete-cancel-btn" class="delete-confirm-cancel">取消</button>
                <button id="delete-confirm-btn" class="delete-confirm-submit">确认删除</button>
            </div>
        </div>
    </div>

    <!-- 恢复确认模态框 - 基于删除确认模态框样式 -->
    <div id="restore-confirm-modal" class="modal">
        <div class="modal-content delete-confirm-content">
            <div class="delete-confirm-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" fill="#dcfce7"/>
                    <path d="M9 12L11 14L15 10" stroke="#22c55e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <h3 id="restore-confirm-title" class="delete-confirm-title">确认恢复</h3>
            <p id="restore-confirm-message" class="delete-confirm-message">确定要恢复这个项目吗？</p>
            <div class="delete-confirm-actions">
                <button id="restore-cancel-btn" class="delete-confirm-cancel">取消</button>
                <button id="restore-confirm-btn" class="delete-confirm-submit">确认恢复</button>
            </div>
        </div>
    </div>

    <script>
        // 数据模型
        let notebooks = [];
        let currentNotebookId = null;
        let currentPaperId = null;
        let recycleBinData = [];
        
        // 删除确认模态框相关变量
        let deleteConfirmCallback = null;
        let deleteConfirmParams = null;
        let templates = {
            'blank': {
                name: '空白模板',
                data: Array(3).fill().map(() => Array(25).fill(''))
            },
            'todo': {
                name: '待办事项',
                data: [
                    // 第一列：待办事项
                    Array(25).fill('').map((_, i) => i === 0 ? '待办事项' : ''),
                    // 第二列：进行中
                    Array(25).fill('').map((_, i) => i === 0 ? '进行中' : ''),
                    // 第三列：已完成
                    Array(25).fill('').map((_, i) => i === 0 ? '已完成' : '')
                ]
            },
            'notes': {
                name: '学习笔记',
                data: [
                    // 第一列：知识点
                    Array(25).fill('').map((_, i) => i === 0 ? '知识点' : ''),
                    // 第二列：重点
                    Array(25).fill('').map((_, i) => i === 0 ? '重点' : ''),
                    // 第三列：总结
                    Array(25).fill('').map((_, i) => i === 0 ? '总结' : '')
                ]
            },
            'meeting': {
                name: '会议记录',
                data: [
                    // 第一列：讨论
                    Array(25).fill('').map((_, i) => i === 0 ? '讨论内容' : ''),
                    // 第二列：决议
                    Array(25).fill('').map((_, i) => i === 0 ? '决议事项' : ''),
                    // 第三列：行动项
                    Array(25).fill('').map((_, i) => i === 0 ? '行动项' : '')
                ]
            },
            'speaker': {
                name: '叭叭的小人',
                data: [
                    // 第一列：醒来的第n个小时
                    Array(25).fill('').map((_, i) => i === 0 ? '醒来的第n个小时' : ''),
                    // 第二列：干活啦
                    Array(25).fill('').map((_, i) => i === 0 ? '干活啦' : ''),
                    // 第三列：做完了没有
                    Array(25).fill('').map((_, i) => i === 0 ? '做完了没有' : '')
                ]
            }
        };
        
        // 当前样式设置
        let currentStyle = {
            lineStyle: 'dashed',
            lineColor: '#a0d4e6',
            backgroundColor: '#ffffff',
            textAlignment: 'center', // 默认居中对齐
            columnBorderStyle: 'solid' // 默认竖线条样式为实线
        };

        // DOM元素
        const newPaperBtn = document.getElementById('new-paper-btn');
        const newNotebookBtn = document.getElementById('new-notebook-btn');
        const exportBtn = document.getElementById('export-btn');
        const syncBtn = document.getElementById('sync-btn');
        const templateBtn = document.getElementById('template-btn');
        const papersContainer = document.getElementById('papers-container');
        const notebooksContainer = document.getElementById('notebooks-container');
        const newPaperModal = document.getElementById('new-paper-modal');
        const newNotebookModal = document.getElementById('new-notebook-modal');
        const syncModal = document.getElementById('sync-modal');
        const templateModal = document.getElementById('template-modal');
        const paperMenuModal = document.getElementById('paper-menu');
        const imageModal = document.getElementById('image-modal');
        const richTextModal = document.getElementById('rich-text-modal');
        const tagsModal = document.getElementById('tags-modal');
        const settingsModal = document.getElementById('settings-modal');
        const cancelPaperBtn = document.getElementById('cancel-paper-btn');
        const confirmPaperBtn = document.getElementById('confirm-paper-btn');
        const cancelNotebookBtn = document.getElementById('cancel-notebook-btn');
        const confirmNotebookBtn = document.getElementById('confirm-notebook-btn');
        const cancelSyncBtn = document.getElementById('cancel-sync-btn');
        const cancelTemplateBtn = document.getElementById('cancel-template-btn');
        const confirmTemplateBtn = document.getElementById('confirm-template-btn');
        const closePaperMenuBtn = document.getElementById('close-paper-menu-btn');
        const addImageBtn = document.getElementById('add-image-btn');
        const richTextEditBtn = document.getElementById('rich-text-btn');
        const addTagsBtn = document.getElementById('add-tags-btn');
        const deletePaperBtn = document.getElementById('delete-paper-btn');
        const cancelImageBtn = document.getElementById('cancel-image-btn');
        const confirmImageBtn = document.getElementById('confirm-image-btn');
        
        // 样式相关DOM元素
        const settingsBtn = document.getElementById('settings-btn');
        const cancelSettingsBtn = document.getElementById('cancel-settings-btn');
        const confirmSettingsBtn = document.getElementById('confirm-settings-btn');
        const lineStyleOptions = document.querySelectorAll('.line-style-option:not(#column-border-style-options .line-style-option)');
        const columnBorderStyleOptions = document.querySelectorAll('#column-border-style-options .line-style-option');
        const colorOptions = document.querySelectorAll('.color-option:not(.text-color-option)');
        const textColorOptions = document.querySelectorAll('.text-color-option');
        const bgOptions = document.querySelectorAll('.bg-option');
        const applyTextColorCurrentBtn = document.getElementById('apply-text-color-current');
        const applyTextColorAllBtn = document.getElementById('apply-text-color-all');
        
        // 回收站相关DOM元素
        const recycleCount = document.getElementById('recycle-count');
        const recycleItems = document.getElementById('recycle-items');
        const emptyRecycleBtn = document.getElementById('empty-recycle-btn');
        const cancelRichTextBtn = document.getElementById('cancel-rich-text-btn');
        const confirmRichTextBtn = document.getElementById('confirm-rich-text-btn');
        const cancelTagsBtn = document.getElementById('cancel-tags-btn');
        const confirmTagsBtn = document.getElementById('confirm-tags-btn');
        const paperTitle = document.getElementById('paper-title');
        const notebookTitle = document.getElementById('notebook-title');
        const templatePaperTitle = document.getElementById('template-paper-title');
        const paperTagsInput = document.getElementById('paper-tags');
        const editPaperTagsInput = document.getElementById('edit-paper-tags');
        const imageColumnSelect = document.getElementById('image-column');
        const imageRowSelect = document.getElementById('image-row');
        const imageUrlInput = document.getElementById('image-url');
        const richTextColumnSelect = document.getElementById('rich-text-column');
        const richTextRowSelect = document.getElementById('rich-text-row');
        const richTextContent = document.getElementById('rich-text-content');
        const formatBoldBtn = document.getElementById('format-bold');
        const formatItalicBtn = document.getElementById('format-italic');
        const formatUnderlineBtn = document.getElementById('format-underline');
        const formatColorSelect = document.getElementById('format-color');
        const templateItems = document.querySelectorAll('.template-item');
        let selectedTemplate = 'blank';

        // 添加防抖函数以提高方向检测的可靠性
        function debounce(func, wait) {
            let timeout;
            return function() {
                const context = this;
                const args = arguments;
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(context, args), wait);
            };
        }
        
        // 检查是否为移动设备
        function isMobile() {
            // 优先使用用户代理字符串检测移动设备
            const isMobileUA = /Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            // 结合设备特性检测
            const hasTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            const isSmallScreen = window.innerWidth <= 1024;
            
            // 基于用户代理和设备特性的综合判断
            return isMobileUA || (hasTouch && isSmallScreen);
        }
        
        // 检测并处理屏幕方向，特别是更新回收站UI
        function checkScreenOrientation() {
            const isPortrait = window.innerHeight > window.innerWidth;
            const isMobileDevice = isMobile();
            const mobileRecycleModal = document.getElementById('mobile-recycle-modal');
            const recycleBin = document.querySelector('.recycle-bin');
            
            // 确保两个元素都存在
            if (!mobileRecycleModal || !recycleBin) return;
            
            // 更准确地检查当前是否有回收站界面在显示
            const isMobileRecycleVisible = mobileRecycleModal.style.display !== 'none' && 
                                          mobileRecycleModal.style.visibility !== 'hidden';
            const isSidebarRecycleVisible = recycleBin.style.display && recycleBin.style.display !== 'none';
            const isRecycleBinVisible = isMobileRecycleVisible || isSidebarRecycleVisible;
            
            // 只有在回收站界面当前可见的情况下才更新布局
            if (isRecycleBinVisible) {
                if (isMobileDevice && isPortrait) {
                    // 移动设备且竖屏时：显示移动端弹窗式回收站
                    mobileRecycleModal.style.display = 'flex';
                    mobileRecycleModal.style.visibility = 'visible';
                    mobileRecycleModal.style.pointerEvents = 'auto';
                    recycleBin.style.display = 'none';
                    
                    // 更新移动端回收站内容
                    if (typeof window.updateMobileRecycleBin === 'function') {
                        window.updateMobileRecycleBin();
                    }
                } else {
                    // 在PC端或移动设备横屏时显示原始回收站，隐藏移动端弹窗
                    recycleBin.style.display = 'flex';
                    
                    // 完全清空所有可能覆盖CSS的内联样式
                    const allProperties = ['height', 'width', 'position', 'left', 'top', 'right', 'bottom', 'zIndex', 'flexDirection', 'padding', 'margin', 'backgroundColor', 'borderRadius', 'boxShadow', 'border'];
                    allProperties.forEach(prop => {
                        recycleBin.style[prop] = '';
                    });
                    
                    // 为内容区域也清空内联样式，确保CSS完全控制
                    const recycleItems = recycleBin.querySelector('.recycle-items');
                    if (recycleItems) {
                        ['overflowY', 'minHeight', 'maxHeight', 'flex', 'padding', 'margin'].forEach(prop => {
                            recycleItems.style[prop] = '';
                        });
                    }
                    
                    // 确保移动端弹窗完全隐藏
                    mobileRecycleModal.style.display = 'none';
                    mobileRecycleModal.style.visibility = 'hidden';
                    mobileRecycleModal.style.pointerEvents = 'none';
                }
            }
        }
        
        // 创建防抖版本的方向检测函数，增加延迟以提高可靠性
        const debouncedCheckScreenOrientation = debounce(checkScreenOrientation, 200);
        
        // 处理跳过横屏提示
        function handleSkipOrientationPrompt(option) {
            // 由于屏幕旋转提示覆盖层已被移除，此函数只保留"不再提示"的功能
            if (option === 'forever') {
                localStorage.setItem('skipOrientationPrompt', 'true');
            }
        }

        // 初始化应用
        function initApp() {
            // 从localStorage加载数据
            loadFromLocalStorage();
            
            // 从本地存储加载回收站数据
            const savedRecycleBin = localStorage.getItem('recycleBinData');
            if (savedRecycleBin) {
                recycleBinData = JSON.parse(savedRecycleBin);
            }
            
            // 初始化筛选类型
            window.recycleFilterType = 'all'; // 'all', 'paper', 'notebook'
            
            // 更新回收站UI
            updateRecycleBinUI();
            
            // 从本地存储加载样式设置
            const savedStyle = localStorage.getItem('currentStyle');
            if (savedStyle) {
                currentStyle = JSON.parse(savedStyle);
            }
            
            renderNotebooksList();
            if (notebooks.length > 0) {
                switchToNotebook(notebooks[0].id);
            }
            setupEventListeners();
            
            // 添加跳过选项按钮事件监听
            const skipOnceBtn = document.getElementById('orientation-skip-once');
            const skipForeverBtn = document.getElementById('orientation-skip-forever');
            
            if (skipOnceBtn) {
                skipOnceBtn.addEventListener('click', function() {
                    handleSkipOrientationPrompt('once');
                });
            }
            
            if (skipForeverBtn) {
                skipForeverBtn.addEventListener('click', function() {
                    handleSkipOrientationPrompt('forever');
                });
            }
            
            // 应用保存的主题设置
            applyThemeToUI();
            
            // 初始化屏幕方向检测
            checkScreenOrientation();
            window.addEventListener('resize', debouncedCheckScreenOrientation);
            window.addEventListener('orientationchange', debouncedCheckScreenOrientation);
            // 为了确保在从横屏返回竖屏时能正确检测，额外添加一个定时器检查
            let orientationCheckTimer;
            function startOrientationCheckTimer() {
                if (orientationCheckTimer) clearInterval(orientationCheckTimer);
                orientationCheckTimer = setInterval(() => {
                    checkScreenOrientation();
                }, 500); // 每500ms检查一次
            }
            
            function stopOrientationCheckTimer() {
                if (orientationCheckTimer) {
                    clearInterval(orientationCheckTimer);
                    orientationCheckTimer = null;
                }
            }
            
            // 在方向变化时启动短暂的连续检查
            window.addEventListener('orientationchange', () => {
                startOrientationCheckTimer();
                // 延长检查时间到5秒，确保复杂方向变化也能正确检测
                setTimeout(stopOrientationCheckTimer, 5000);
            });
            
            // 添加额外的检查机制，专门处理从横屏到竖屏的转换
            let lastOrientation = window.innerHeight > window.innerWidth; // 初始方向
            window.addEventListener('resize', () => {
                const currentOrientation = window.innerHeight > window.innerWidth;
                // 检测从横屏到竖屏的转换
                if (!lastOrientation && currentOrientation) {
                    // 连续检查多次以确保正确检测
                    let counter = 0;
                    const transitionCheckInterval = setInterval(() => {
                        checkScreenOrientation();
                        counter++;
                        if (counter >= 5) {
                            clearInterval(transitionCheckInterval);
                        }
                    }, 200);
                }
                lastOrientation = currentOrientation;
            });
        }

        // 设置事件监听器
        function setupEventListeners() {
            // 初始化删除确认模态框
            initDeleteConfirmModal();
            // 初始化恢复确认模态框
            initRestoreConfirmModal();
            
            // 模板选择功能
            templateItems.forEach(item => {
                item.addEventListener('click', function() {
                    // 检查是否为锁定的模板
                    if (this.classList.contains('locked')) {
                        showToast('本地应用已禁用该模板');
                        return;
                    }
                    
                    templateItems.forEach(i => i.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedTemplate = this.dataset.template;
                });
            });

            // 打开模板选择模态框
            templateBtn.addEventListener('click', function() {
                templatePaperTitle.value = '';
                templateModal.style.display = 'flex';
                
                // 如果有模板项，默认选中第一个可用的模板
                if (templateItems.length > 0) {
                    // 查找第一个非锁定的模板
                    let firstAvailableTemplate = null;
                    templateItems.forEach(item => {
                        if (!item.classList.contains('locked') && !firstAvailableTemplate) {
                            firstAvailableTemplate = item;
                        }
                        item.classList.remove('selected');
                    });
                    
                    if (firstAvailableTemplate) {
                        selectedTemplate = firstAvailableTemplate.dataset.template;
                        firstAvailableTemplate.classList.add('selected');
                    } else {
                        selectedTemplate = '';
                    }
                } else {
                    selectedTemplate = '';
                }
            });

            // 确认创建带模板的记录纸
            confirmTemplateBtn.addEventListener('click', function() {
                const title = templatePaperTitle.value.trim();
                if (!title) {
                    // 如果标题为空，提示用户输入
                    alert('请输入记录纸标题！');
                    templatePaperTitle.focus();
                    return;
                }
                createPaperWithTemplate(title, selectedTemplate);
                templateModal.style.display = 'none';
            });
            
            // 记录纸快捷删除按钮点击事件
            papersContainer.addEventListener('click', function(e) {
                if (e.target.classList.contains('delete-btn')) {
                    const paperId = e.target.closest('.paper').dataset.paperId;
                    moveToRecycleBin(paperId);
                }
            });
            
            // 设置按钮点击事件
            settingsBtn.addEventListener('click', function() {
                showSettingsModal();
            });
            
            // 初始化存储设置相关事件
            const changeStoragePathBtn = document.getElementById('change-storage-path');
            const storagePathInput = document.getElementById('storage-path');
            
            if (changeStoragePathBtn && storagePathInput) {
                // 尝试从localStorage读取上次保存的存储路径
                const savedStoragePath = localStorage.getItem('threeGridStoragePath');
                if (savedStoragePath) {
                    storagePathInput.value = savedStoragePath;
                }
                
                changeStoragePathBtn.addEventListener('click', function() {
                    // 创建目录选择器
                    const dirInput = document.createElement('input');
                    dirInput.type = 'file';
                    dirInput.style.display = 'none';
                    dirInput.webkitdirectory = true; // 启用目录选择
                    dirInput.multiple = false;
                    
                    dirInput.addEventListener('change', function(e) {
                        // 检查是否有选择目录
                        if (e.target.files && e.target.files.length > 0) {
                            // 获取选择的目录路径
                            // 在不同浏览器中，文件路径的获取方式可能不同
                            const file = e.target.files[0];
                            let dirPath = file.webkitRelativePath ? 
                                file.webkitRelativePath.split('/')[0] : file.name;
                            
                            // 对于支持的浏览器，尝试获取完整路径信息
                            if (file.webkitRelativePath && file.webkitRelativePath.includes('/')) {
                                // 构建模拟的完整路径显示
                                dirPath = '用户选择的目录/' + dirPath;
                            }
                            
                            // 更新输入框显示
                            storagePathInput.value = dirPath;
                            
                            // 保存选择的路径到localStorage
                            localStorage.setItem('threeGridStoragePath', dirPath);
                            
                            // 显示成功提示
                            showToast('存储目录已更新：' + dirPath);
                        }
                    });
                    
                    document.body.appendChild(dirInput);
                    dirInput.click();
                    
                    // 移除临时元素
                    setTimeout(() => {
                        document.body.removeChild(dirInput);
                    }, 100);
                });
            }
            
            // 样式选择事件
            lineStyleOptions.forEach(option => {
                option.addEventListener('click', function() {
                    lineStyleOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    currentStyle.lineStyle = this.dataset.style;
                });
                
                // 移动端长按显示提示
                let pressTimer;
                
                option.addEventListener('touchstart', (e) => {
                    e.preventDefault(); // 阻止默认行为
                    pressTimer = setTimeout(() => {
                        const label = option.getAttribute('data-label');
                        showToast(label);
                    }, 800); // 800毫秒长按触发
                });
                
                option.addEventListener('touchend', () => {
                    clearTimeout(pressTimer);
                });
                
                option.addEventListener('touchmove', () => {
                    clearTimeout(pressTimer);
                });
            });
            
            // 竖线条样式选择事件
            columnBorderStyleOptions.forEach(option => {
                option.addEventListener('click', function() {
                    columnBorderStyleOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    currentStyle.columnBorderStyle = this.dataset.style;
                });
                
                // 移动端长按显示提示
                let pressTimer;
                
                option.addEventListener('touchstart', (e) => {
                    e.preventDefault(); // 阻止默认行为
                    pressTimer = setTimeout(() => {
                        const label = option.getAttribute('data-label');
                        showToast(label);
                    }, 800); // 800毫秒长按触发
                });
                
                option.addEventListener('touchend', () => {
                    clearTimeout(pressTimer);
                });
                
                option.addEventListener('touchmove', () => {
                    clearTimeout(pressTimer);
                });
            });
            

            
            // 长按定时器
            let colorLongPressTimer;
            
            colorOptions.forEach(option => {
                // 将每个选项设为相对定位，以便提示元素的绝对定位参考
                option.style.position = 'relative';
                
                option.addEventListener('click', function() {
                    colorOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    currentStyle.lineColor = this.dataset.color;
                });
                
                // 鼠标悬停事件（桌面端）
                option.addEventListener('mouseenter', function() {
                    showColorNameNearOption(this, this.dataset.color);
                });
                
                option.addEventListener('mouseleave', function() {
                    hideColorNameTooltip();
                });
                
                // 移动端触摸事件
                option.addEventListener('touchstart', function(e) {
                    e.preventDefault(); // 防止触发其他事件
                    colorLongPressTimer = setTimeout(() => {
                        showColorNameNearOption(this, this.dataset.color);
                        // 2秒后自动隐藏
                        setTimeout(hideColorNameTooltip, 2000);
                    }, 500); // 长按500毫秒显示颜色名称
                });
                
                option.addEventListener('touchend', function() {
                    clearTimeout(colorLongPressTimer);
                });
                
                option.addEventListener('touchmove', function() {
                    clearTimeout(colorLongPressTimer);
                    hideColorNameTooltip();
                });
            });
            
            // 颜色名称映射
            const colorNames = {
                // 背景颜色
                '#ffffff': '白色',
                '#f9f7f1': '米白',
                '#e6f7ff': '浅蓝',
                '#fff7e6': '浅黄',
                '#f6ffed': '浅绿',
                '#faf5ff': '浅紫',
                '#fff5f5': '浅粉',
                '#edf2f7': '淡灰',
                '#e6fffa': '浅青',
                '#f8f5f2': '浅棕',
                // 线条颜色和文字颜色
                '#000000': '黑色',
                '#333333': '白色',
                '#666666': '中灰',
                '#999999': '浅灰',
                '#ffe4e1': '浅珊瑚色',
                '#e0f7fa': '浅青色',
                '#e8f5e9': '浅绿色',
                '#f3e5f5': '浅紫色',
                '#ff6b6b': '珊瑚红',
                '#4ecdc4': '薄荷绿',
                '#ffe66d': '淡黄色',
                '#667eea': '靛蓝色',
                '#48bb78': '翠绿',
                '#9f7aea': '紫色',
                '#f56565': '红色',
                '#ed8936': '橙色',
                '#4a5568': '深灰',
                '#ffedcc': '浅橙',
                '#ccf6ff': '天蓝',
                '#e5ffcc': '浅绿',
                '#ffcceb': '粉红',
                '#e6ccff': '淡紫',
                '#f0f0d8': '淡米',
                '#d9f0ff': '浅蓝',
                '#fff5cc': '浅黄',
                '#ccebff': '海蓝',
                '#ccffec': '浅青',
                '#2dd4bf': '青色',
                '#db2777': '玫红',
                '#f97316': '深橙'
            };

            // 创建和显示颜色名称标签
            function createColorNameTooltip() {
                // 检查是否已存在提示元素
                let tooltip = document.getElementById('color-name-tooltip');
                if (!tooltip) {
                    tooltip = document.createElement('div');
                    tooltip.id = 'color-name-tooltip';
                    tooltip.style.cssText = `
                        position: absolute;
                        background: rgba(0, 0, 0, 0.8);
                        color: white;
                        padding: 4px 8px;
                        border-radius: 4px;
                        font-size: 0.85rem;
                        z-index: 1003;
                        pointer-events: none;
                        white-space: nowrap;
                    `;
                    document.body.appendChild(tooltip);
                }
                return tooltip;
            }

            // 显示颜色名称在颜色选项旁边
            function showColorNameNearOption(option, color) {
                const colorName = colorNames[color] || color;
                const tooltip = createColorNameTooltip();
                tooltip.textContent = colorName;
                
                // 获取选项位置并设置提示位置
                const rect = option.getBoundingClientRect();
                
                // 考虑页面滚动位置，确保tooltip始终显示在颜色选项旁边
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;
                
                // 设置tooltip位置在颜色选项的右下方
                tooltip.style.top = `${rect.top + scrollTop + 5}px`;
                tooltip.style.left = `${rect.right + scrollLeft + 5}px`;
                tooltip.style.display = 'block';
                
                // 确保在视口内
                const tooltipRect = tooltip.getBoundingClientRect();
                if (tooltipRect.bottom > window.innerHeight) {
                    tooltip.style.top = `${rect.top + scrollTop - tooltipRect.height - 5}px`;
                }
                if (tooltipRect.right > window.innerWidth) {
                    tooltip.style.left = `${rect.left + scrollLeft - tooltipRect.width - 5}px`;
                }
            }

            // 隐藏颜色名称提示
            function hideColorNameTooltip() {
                const tooltip = document.getElementById('color-name-tooltip');
                if (tooltip) {
                    tooltip.style.display = 'none';
                }
            }

            // 长按定时器
            let longPressTimer;
            
            bgOptions.forEach(option => {
                // 将每个选项设为相对定位，以便提示元素的绝对定位参考
                option.style.position = 'relative';
                
                option.addEventListener('click', function() {
                    bgOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    currentStyle.backgroundColor = this.dataset.bg;
                });

                // 鼠标悬停事件（桌面端）
                option.addEventListener('mouseenter', function() {
                    showColorNameNearOption(this, this.dataset.bg);
                });

                option.addEventListener('mouseleave', function() {
                    hideColorNameTooltip();
                });

                // 移动端触摸事件
                option.addEventListener('touchstart', function(e) {
                    e.preventDefault(); // 防止触发其他事件
                    longPressTimer = setTimeout(() => {
                        showColorNameNearOption(this, this.dataset.bg);
                        // 2秒后自动隐藏
                        setTimeout(hideColorNameTooltip, 2000);
                    }, 500); // 长按500毫秒显示颜色名称
                });

                option.addEventListener('touchend', function() {
                    clearTimeout(longPressTimer);
                });

                option.addEventListener('touchmove', function() {
                    clearTimeout(longPressTimer);
                    hideColorNameTooltip();
                });
            });

            // 长按定时器
            let textColorLongPressTimer;
            
            textColorOptions.forEach(option => {
                // 将每个选项设为相对定位，以便提示元素的绝对定位参考
                option.style.position = 'relative';
                
                option.addEventListener('click', function() {
                    textColorOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                });
                
                // 鼠标悬停事件（桌面端）
                option.addEventListener('mouseenter', function() {
                    showColorNameNearOption(this, this.dataset.color);
                });
                
                option.addEventListener('mouseleave', function() {
                    hideColorNameTooltip();
                });
                
                // 移动端触摸事件
                option.addEventListener('touchstart', function(e) {
                    e.preventDefault(); // 防止触发其他事件
                    textColorLongPressTimer = setTimeout(() => {
                        showColorNameNearOption(this, this.dataset.color);
                        // 2秒后自动隐藏
                        setTimeout(hideColorNameTooltip, 2000);
                    }, 500); // 长按500毫秒显示颜色名称
                });
                
                option.addEventListener('touchend', function() {
                    clearTimeout(textColorLongPressTimer);
                });
                
                option.addEventListener('touchmove', function() {
                    clearTimeout(textColorLongPressTimer);
                    hideColorNameTooltip();
                });
            });
            
            // 应用文字颜色到当前记录纸
            applyTextColorCurrentBtn.addEventListener('click', function() {
                const selectedTextColorOption = document.querySelector('.text-color-option.selected');
                if (selectedTextColorOption) {
                    const color = selectedTextColorOption.dataset.color;
                    const currentPaper = getCurrentPaper();
                    if (currentPaper) {
                        applyTextColorToPaper(currentPaper, color);
                        showToast('文字颜色已应用到当前记录纸');
                    } else {
                        showToast('请先选择一张记录纸');
                    }
                } else {
                    showToast('请先选择文字颜色');
                }
            });
            
            // 应用文字颜色到所有记录纸
            applyTextColorAllBtn.addEventListener('click', function() {
                const selectedTextColorOption = document.querySelector('.text-color-option.selected');
                if (selectedTextColorOption) {
                    const color = selectedTextColorOption.dataset.color;
                    applyTextColorToAllPapers(color);
                    showToast('文字颜色已应用到所有记录纸');
                } else {
                    showToast('请先选择文字颜色');
                }
            });
            
            // 应用行线条样式到当前记录纸
            document.getElementById('apply-line-style-current').addEventListener('click', function() {
                const selectedLineStyleOption = document.querySelector('.line-style-option.selected:not(#column-border-style-options .line-style-option)');
                if (selectedLineStyleOption) {
                    const style = selectedLineStyleOption.dataset.style;
                    const currentPaper = getCurrentPaper();
                    if (currentPaper) {
                        applyLineStyleToPaper(currentPaper, style);
                        showToast('行线条样式已应用到当前记录纸');
                    } else {
                        showToast('请先选择一张记录纸');
                    }
                } else {
                    showToast('请先选择行线条样式');
                }
            });
            
            // 应用行线条样式到所有记录纸
            document.getElementById('apply-line-style-all').addEventListener('click', function() {
                const selectedLineStyleOption = document.querySelector('.line-style-option.selected:not(#column-border-style-options .line-style-option)');
                if (selectedLineStyleOption) {
                    const style = selectedLineStyleOption.dataset.style;
                    applyLineStyleToAllPapers(style);
                    showToast('行线条样式已应用到所有记录纸');
                } else {
                    showToast('请先选择行线条样式');
                }
            });
            
            // 应用竖线条样式到当前记录纸
            document.getElementById('apply-column-style-current').addEventListener('click', function() {
                const selectedColumnStyleOption = document.querySelector('#column-border-style-options .line-style-option.selected');
                if (selectedColumnStyleOption) {
                    const style = selectedColumnStyleOption.dataset.style;
                    const currentPaper = getCurrentPaper();
                    if (currentPaper) {
                        applyColumnStyleToPaper(currentPaper, style);
                        showToast('竖线条样式已应用到当前记录纸');
                    } else {
                        showToast('请先选择一张记录纸');
                    }
                } else {
                    showToast('请先选择竖线条样式');
                }
            });
            
            // 应用竖线条样式到所有记录纸
            document.getElementById('apply-column-style-all').addEventListener('click', function() {
                const selectedColumnStyleOption = document.querySelector('#column-border-style-options .line-style-option.selected');
                if (selectedColumnStyleOption) {
                    const style = selectedColumnStyleOption.dataset.style;
                    applyColumnStyleToAllPapers(style);
                    showToast('竖线条样式已应用到所有记录纸');
                } else {
                    showToast('请先选择竖线条样式');
                }
            });
            
            // 应用线条颜色到当前记录纸
            document.getElementById('apply-line-color-current').addEventListener('click', function() {
                const selectedColorOption = document.querySelector('.color-option.selected:not(.text-color-option)');
                if (selectedColorOption) {
                    const color = selectedColorOption.dataset.color;
                    const currentPaper = getCurrentPaper();
                    if (currentPaper) {
                        applyLineColorToPaper(currentPaper, color);
                        showToast('线条颜色已应用到当前记录纸');
                    } else {
                        showToast('请先选择一张记录纸');
                    }
                } else {
                    showToast('请先选择线条颜色');
                }
            });
            
            // 应用线条颜色到所有记录纸
            document.getElementById('apply-line-color-all').addEventListener('click', function() {
                const selectedColorOption = document.querySelector('.color-option.selected:not(.text-color-option)');
                if (selectedColorOption) {
                    const color = selectedColorOption.dataset.color;
                    applyLineColorToAllPapers(color);
                    showToast('线条颜色已应用到所有记录纸');
                } else {
                    showToast('请先选择线条颜色');
                }
            });
            
            // 应用背景颜色到当前记录纸
            document.getElementById('apply-bg-color-current').addEventListener('click', function() {
                const selectedBgOption = document.querySelector('.bg-option.selected');
                if (selectedBgOption) {
                    const bgColor = selectedBgOption.dataset.bg;
                    const currentPaper = getCurrentPaper();
                    if (currentPaper) {
                        applyBgColorToPaper(currentPaper, bgColor);
                        showToast('背景颜色已应用到当前记录纸');
                    } else {
                        showToast('请先选择一张记录纸');
                    }
                } else {
                    showToast('请先选择背景颜色');
                }
            });
            
            // 应用背景颜色到所有记录纸
            document.getElementById('apply-bg-color-all').addEventListener('click', function() {
                const selectedBgOption = document.querySelector('.bg-option.selected');
                if (selectedBgOption) {
                    const bgColor = selectedBgOption.dataset.bg;
                    applyBgColorToAllPapers(bgColor);
                    showToast('背景颜色已应用到所有记录纸');
                } else {
                    showToast('请先选择背景颜色');
                }
            });
            
            // 点击页面其他地方隐藏提示
            document.addEventListener('click', function(e) {
                if (!e.target.classList.contains('bg-option') && !e.target.classList.contains('color-option')) {
                    hideColorNameTooltip();
                }
            });

            // 对齐选项点击事件
            const alignmentOptions = document.querySelectorAll('.alignment-option');
            alignmentOptions.forEach(option => {
                option.addEventListener('click', function() {
                    alignmentOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    currentStyle.textAlignment = this.dataset.alignment;
                });
            });
            
            // 显示简单提示的函数
        window.showToast = function(message) {
            // 检查是否已存在toast元素
            let toast = document.getElementById('style-toast');
            if (toast) {
                document.body.removeChild(toast);
            }
            
            // 创建新的toast元素 - 简洁风格
            toast = document.createElement('div');
            toast.id = 'style-toast';
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                bottom: 30%;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(243, 244, 246, 0.95);
                color: #374151;
                padding: 8px 16px;
                border-radius: 6px;
                font-size: 1rem;
                z-index: 1002;
                pointer-events: none;
                opacity: 1;
                border: 1px solid #e5e7eb;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
                transition: all 0.2s ease;
            `;
            
            document.body.appendChild(toast);
            
            // 2秒后移除toast
            setTimeout(() => {
                if (document.body.contains(toast)) {
                    // 添加淡出动画
                    toast.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
                    toast.style.opacity = '0';
                    toast.style.transform = 'translateX(-50%) translateY(10px)';
                    setTimeout(() => {
                        if (document.body.contains(toast)) {
                            document.body.removeChild(toast);
                        }
                    }, 400);
                }
            }, 2000);
        };
        
        // 全局全屏相关函数 - 移到initMobileOptimizations外部以确保全局可访问
        // 请求全屏显示的函数 - 优化版本
        window.requestFullscreen = function() {
            if (document.fullscreenElement) {
                console.log('已经是全屏状态');
                return; // 已经是全屏状态
            }
            
            const docEl = document.documentElement;
            
            if (docEl.requestFullscreen) {
                docEl.requestFullscreen().catch(err => {
                    console.log(`全屏请求失败: ${err.message}`);
                    // 尝试通过用户交互方式触发全屏
                    if (window.setupFullscreenUserInteraction) {
                        window.setupFullscreenUserInteraction();
                    }
                });
            } else if (docEl.webkitRequestFullscreen) { // Safari
                docEl.webkitRequestFullscreen().catch(err => {
                    console.log(`全屏请求失败: ${err.message}`);
                    if (window.setupFullscreenUserInteraction) {
                        window.setupFullscreenUserInteraction();
                    }
                });
            } else if (docEl.msRequestFullscreen) { // IE11
                try {
                    docEl.msRequestFullscreen();
                } catch (err) {
                    console.log(`全屏请求失败: ${err.message}`);
                    if (window.setupFullscreenUserInteraction) {
                        window.setupFullscreenUserInteraction();
                    }
                }
            }
        };
        
        // 退出全屏显示的函数
        window.exitFullscreen = function() {
            if (!document.fullscreenElement) return; // 不是全屏状态
            
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.webkitExitFullscreen) { // Safari
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) { // IE11
                document.msExitFullscreen();
            }
        };
        
        // 移动端优化函数
        function initMobileOptimizations() {
            // 更准确地检测是否为移动设备
            const isMobile = /iPhone|iPad|iPod|Android|webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isTablet = window.matchMedia('(max-width: 1024px)').matches;
            const isSmallScreen = window.matchMedia('(max-width: 768px)').matches;
            
            // 对移动设备和小屏幕平板都应用全屏优化
            if (!isMobile && !isTablet && !isSmallScreen) return;
            
            // 检测屏幕方向
            function isPortrait() {
                return window.innerHeight > window.innerWidth;
            }
            
            // 记录键盘活动状态
            let isKeyboardActive = false;
            
            // 初始化输入框事件监听，检测键盘状态
            function setupKeyboardActivityDetection() {
                const inputs = document.querySelectorAll('input, textarea, select');
                inputs.forEach(input => {
                    input.addEventListener('focus', () => {
                        isKeyboardActive = true;
                    });
                    
                    input.addEventListener('blur', () => {
                        // 延迟一小段时间再设置键盘不活动，确保键盘完全收起
                        setTimeout(() => {
                            isKeyboardActive = false;
                        }, 300);
                    });
                });
            }
            
            // 设置用户交互触发全屏的方式
            window.setupFullscreenUserInteraction = function() {
                // 检测是否已经添加过点击事件
                if (document.getElementById('fullscreen-overlay')) return;
                
                // 创建一个半透明覆盖层，引导用户点击以进入全屏
                const overlay = document.createElement('div');
                overlay.id = 'fullscreen-overlay';
                overlay.style.position = 'fixed';
                overlay.style.top = '0';
                overlay.style.left = '0';
                overlay.style.right = '0';
                overlay.style.bottom = '0';
                overlay.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
                overlay.style.color = 'white';
                overlay.style.display = 'flex';
                overlay.style.flexDirection = 'column';
                overlay.style.alignItems = 'center';
                overlay.style.justifyContent = 'center';
                overlay.style.zIndex = '9999';
                overlay.style.padding = '20px';
                overlay.style.textAlign = 'center';
                
                overlay.innerHTML = `
                    <h3 style="margin-bottom: 20px;">点击进入全屏模式</h3>
                    <p style="margin-bottom: 30px;">为获得最佳体验，请点击进入全屏模式</p>
                    <button id="enter-fullscreen-btn" style="
                        padding: 12px 24px;
                        background-color: #4CAF50;
                        color: white;
                        border: none;
                        border-radius: 8px;
                        font-size: 16px;
                        cursor: pointer;
                        transition: background-color 0.3s;
                    ">
                        进入全屏
                    </button>
                `;
                
                document.body.appendChild(overlay);
                
                // 添加点击事件
                document.getElementById('enter-fullscreen-btn').addEventListener('click', function() {
                    // 移除覆盖层
                    document.body.removeChild(overlay);
                    // 重新请求全屏
                    requestFullscreen();
                });
            }
            
            // 设置键盘活动检测
            setupKeyboardActivityDetection();
            
            // 处理返回键事件，实现按一次退出全屏
            function handleBackButton() {
                // 如果当前是全屏状态
                if (document.fullscreenElement) {
                    // 按一次就退出全屏
                    exitFullscreen();
                    
                    // 隐藏竖屏全屏提示
                    const portraitFullscreenOverlay = document.getElementById('portrait-fullscreen-overlay');
                    if (portraitFullscreenOverlay) {
                        portraitFullscreenOverlay.classList.remove('visible');
                    }
                    
                    // 阻止默认返回行为
                    return true;
                }
                
                return false;
            }
            
            // 设置返回键监听
            function setupBackButtonListener() {
                // 监听Android设备的返回键
                document.addEventListener('backbutton', function(e) {
                    if (handleBackButton()) {
                        e.preventDefault();
                    }
                }, false);
                
                // 监听iOS设备的手势（通过history API）
                window.addEventListener('popstate', function(e) {
                    if (handleBackButton()) {
                        history.pushState(null, null, window.location.href);
                    }
                }, false);
                
                // 初始化history状态
                history.pushState(null, null, window.location.href);
            }
            
            // 处理屏幕方向变化
            function handleOrientationChange() {
                // 如果键盘正在活动，不进行全屏状态切换
                if (isKeyboardActive) {
                    console.log('键盘正在活动，跳过全屏状态切换');
                    return;
                }
                
                // 检测是否在开发服务器环境(localhost)
                const isDevServer = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
                
                // 延迟执行以确保方向变化已经完成
                setTimeout(() => {
                    const currentOrientation = isPortrait();
                    
                    console.log(`屏幕方向: ${currentOrientation ? '竖屏' : '横屏'}`);
                    
                    const portraitFullscreenOverlay = document.getElementById('portrait-fullscreen-overlay');
                    
                    if (currentOrientation) {
                        // 竖屏模式：如果当前已是全屏状态，则保持全屏
                        if (!isDevServer && document.fullscreenElement) {
                            console.log('竖屏模式：保持全屏状态');
                            // 确保移除强制全屏提示
                            if (portraitFullscreenOverlay) {
                                portraitFullscreenOverlay.classList.remove('visible');
                                document.body.classList.remove('portrait-fullscreen-modal-open');
                            }
                        } 
                        // 如果不是全屏状态，显示强制全屏提示
                        else if (!isDevServer && !document.fullscreenElement) {
                            console.log('竖屏模式：显示强制全屏提示');
                            if (portraitFullscreenOverlay) {
                                portraitFullscreenOverlay.classList.add('visible');
                                // 添加类禁止背景滚动
                                document.body.classList.add('portrait-fullscreen-modal-open');
                            }
                        } else {
                            // 开发服务器环境，隐藏提示
                            if (portraitFullscreenOverlay) {
                                portraitFullscreenOverlay.classList.remove('visible');
                                // 移除类允许背景滚动
                                document.body.classList.remove('portrait-fullscreen-modal-open');
                            }
                        }
                    } else {
                        // 横屏模式：隐藏竖屏全屏提示并移除限制类
                        // 无论什么情况，在横屏模式下都移除portrait-fullscreen-modal-open类
                        document.body.classList.remove('portrait-fullscreen-modal-open');
                        
                        if (portraitFullscreenOverlay) {
                            portraitFullscreenOverlay.classList.remove('visible');
                        }
                        
                        // 在横屏模式下，仅在非开发服务器环境请求全屏
                        if (!isDevServer && !document.fullscreenElement) {
                            console.log('横屏模式：请求进入全屏');
                            requestFullscreen();
                        }
                    }
                }, 700); // 增加延迟时间，提高方向判断的准确性
            }
            
            // 设置竖屏强制全屏按钮事件
            function setupPortraitFullscreenButton() {
                const enterPortraitFullscreenBtn = document.getElementById('enter-portrait-fullscreen-btn');
                const portraitFullscreenOverlay = document.getElementById('portrait-fullscreen-overlay');
                
                if (enterPortraitFullscreenBtn) {
                    enterPortraitFullscreenBtn.addEventListener('click', function() {
                        if (portraitFullscreenOverlay) {
                            portraitFullscreenOverlay.classList.remove('visible');
                            // 移除类允许背景滚动
                            document.body.classList.remove('portrait-fullscreen-modal-open');
                        }
                        
                        // 在竖屏模式下直接请求全屏，不进行方向切换
                        requestFullscreen();
                    });
                }
            }
            
            // 初始检测并设置
            handleOrientationChange();
            
            // 初始化返回键监听
            setupBackButtonListener();
            
            // 初始化竖屏全屏按钮
            setupPortraitFullscreenButton();
            
            // 添加方向变化事件监听
            window.addEventListener('orientationchange', handleOrientationChange);
            
            // 防抖处理resize事件，避免键盘调起时频繁触发
            let orientationChangeTimeout;
            function debouncedOrientationChangeHandler() {
                // 再次检查键盘状态，确保不会在键盘弹出时触发全屏切换
                if (isKeyboardActive) {
                    console.log('键盘正在活动，取消计划中的全屏状态切换');
                    clearTimeout(orientationChangeTimeout);
                    return;
                }
                
                clearTimeout(orientationChangeTimeout);
                orientationChangeTimeout = setTimeout(handleOrientationChange, 1000); // 增加防抖延迟到1000ms
            }
            window.addEventListener('resize', debouncedOrientationChangeHandler);
            
            // 双击屏幕可以切换全屏状态（给用户控制的选项）
            document.addEventListener('dblclick', function(e) {
                // 排除点击在按钮、输入框等交互元素上的情况
                if (e.target.tagName.toLowerCase() === 'button' || 
                    e.target.tagName.toLowerCase() === 'input' || 
                    e.target.tagName.toLowerCase() === 'textarea' || 
                    e.target.closest('.modal') || 
                    e.target.closest('#sidebar-nav')) {
                    return;
                }
                
                if (document.fullscreenElement) {
                    exitFullscreen();
                } else {
                    requestFullscreen();
                }
            });
            
            // 优化滚动行为 - 在所有方向下提供良好的滚动体验
            let scrollStartY = 0;
            let currentScrollTop = 0;
            let isScrolling = false;
            
            // 获取主容器元素，作为横屏模式下的主要滚动容器
            const container = document.querySelector('.container');
            
            // 自定义滚动行为 - 性能优化版本
            function handleVerticalScroll(event) {
                // 获取当前屏幕方向
                const portrait = isPortrait();
                
                // 对于竖屏模式，使用简单的处理逻辑以提高性能
                if (portrait) {
                    if (event.type === 'touchstart') {
                        scrollStartY = event.touches[0].clientY;
                        isScrolling = true;
                        // 只在竖屏模式下获取window.scrollY
                        currentScrollTop = window.scrollY;
                    } else if (event.type === 'touchend' || event.type === 'touchcancel') {
                        isScrolling = false;
                    }
                    // 对于touchmove事件，在竖屏模式下完全交给浏览器原生处理
                    return;
                }
                
                // 横屏模式下的处理逻辑
                // 检查是否触摸在侧边栏上
                const sidebarNav = document.getElementById('sidebar-nav');
                const touchTarget = document.elementFromPoint(
                    event.type === 'touchmove' ? event.touches[0].clientX : event.clientX,
                    event.type === 'touchmove' ? event.touches[0].clientY : event.clientY
                );
                const isTouchingSidebar = sidebarNav && sidebarNav.contains(touchTarget);
                
                // 如果触摸在侧边栏上，让默认滚动行为处理
                if (isTouchingSidebar) {
                    return;
                }
                
                if (event.type === 'touchstart') {
                    scrollStartY = event.touches[0].clientY;
                    // 横屏模式下获取container.scrollTop
                    currentScrollTop = container.scrollTop;
                    isScrolling = true;
                } else if (event.type === 'touchmove' && isScrolling) {
                    // 检查是否有模态框显示并触摸在模态框内
                    const visibleModal = document.querySelector('.modal:not([style*="display: none"])');
                    if (visibleModal) {
                        const modalTouchTarget = document.elementFromPoint(
                            event.touches[0].clientX,
                            event.touches[0].clientY
                        );
                        // 如果触摸目标在模态框内，则允许滚动
                        if (visibleModal.contains(modalTouchTarget)) {
                            return;
                        }
                    }
                    
                    const touchY = event.touches[0].clientY;
                    const scrollDistance = scrollStartY - touchY;
                    
                    // 横屏模式保持现有的自定义滚动行为
                    const scrollFactor = 1.8;
                    const enhancedScrollDistance = scrollDistance * scrollFactor;
                    container.scrollTop = currentScrollTop + enhancedScrollDistance;
                    
                    event.preventDefault();
                } else if (event.type === 'touchend' || event.type === 'touchcancel') {
                    isScrolling = false;
                }
            }
            
            // 添加事件监听来优化滚动
            document.addEventListener('touchstart', handleVerticalScroll, { passive: true });
            
            // 优化版 - 设置事件监听器
            // 添加防抖，避免在方向变化时频繁触发
            let resizeTimeout;
            function setupDynamicScrollListener() {
                // 先移除之前的事件监听器
                document.removeEventListener('touchmove', handleVerticalScroll);
                
                // 根据屏幕方向设置passive属性
                const isPassive = isPortrait();
                document.addEventListener('touchmove', handleVerticalScroll, { passive: isPassive });
            }
            
            // 防抖处理resize事件
            function debouncedResizeHandler() {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    setupDynamicScrollListener();
                }, 100); // 100ms的防抖延迟
            }
            
            // 初始设置事件监听器
            setupDynamicScrollListener();
            
            // 监听屏幕尺寸变化和方向变化，动态调整事件监听器
            window.addEventListener('resize', debouncedResizeHandler);
            window.addEventListener('orientationchange', debouncedResizeHandler);
            
            document.addEventListener('touchend', handleVerticalScroll, { passive: true });
            document.addEventListener('touchcancel', handleVerticalScroll, { passive: true });
            
            // 1. 添加触摸反馈优化
            document.querySelectorAll('.btn, .cell, .action-btn, .style-option, .bg-option, .color-option').forEach(element => {
                element.style.tapHighlightColor = 'transparent';
                element.style.webkitTapHighlightColor = 'transparent';
                element.style.userSelect = 'none';
                element.style.webkitUserSelect = 'none';
            });
            
            // 2. 优化页面缩放控制，只在真正需要时防止页面缩放
            // 使用passive: true来提高滚动性能
            document.addEventListener('touchmove', function(e) {
                // 只有在检测到实际缩放操作时才尝试阻止默认行为
                // 并且确保这不会影响正常的滚动体验
                if (isPortrait() && e.scale !== 1) {
                    try {
                        e.preventDefault();
                    } catch (err) {
                        // 在某些浏览器中，passive: true的监听器调用preventDefault会抛出错误
                        // 我们可以安全地忽略这些错误
                    }
                }
            }, { passive: true });
            
            // 3. 优化双击缩放控制，只在竖屏模式下防止双击缩放
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function(e) {
                const now = (new Date()).getTime();
                // 只在竖屏模式下防止双击缩放，但允许点击在paper-title上和回收站弹窗内的双击通过
                if (isPortrait() && now - lastTouchEnd <= 300 && !e.target.classList.contains('paper-title') && !e.target.closest('.mobile-recycle-modal')) {
                    e.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
            
            // 4. 优化输入框获取焦点时的行为
            const inputs = document.querySelectorAll('input, textarea, select');
            
            // 改进的滚动位置管理系统
            let scrollPositions = {}; // 存储每个输入框的滚动位置
            let lastActiveInputId = null; // 记录最后活动的输入框ID
            let keyboardVisibleStartTime = 0;
            let isScrollingBack = false;
            let keyboardOpenTimeout = null;
            let defaultScrollPosition = 0; // 全局默认滚动位置备份
            
            // 为每个输入框添加唯一ID（如果没有）
            inputs.forEach((input, index) => {
                if (!input.id) {
                    input.id = `input-${Date.now()}-${index}`;
                }
            });
            
            // 添加全局滚动事件监听，用于更新默认滚动位置
            window.addEventListener('scroll', function() {
                // 只有当不在滚动恢复过程中时才更新默认滚动位置
                if (!isScrollingBack && document.activeElement && 
                    !(document.activeElement.tagName.toLowerCase() === 'input' || 
                      document.activeElement.tagName.toLowerCase() === 'textarea' || 
                      document.activeElement.tagName.toLowerCase() === 'select')) {
                    defaultScrollPosition = window.scrollY;
                }
            }, { passive: true });
            
            // 监听输入框聚焦，保存当前滚动位置
            inputs.forEach(input => {
                // 点击输入框时，先滚动到可视区域
                input.addEventListener('touchstart', function(e) {
                    // 只在竖屏模式下保存滚动位置
                    if (isPortrait() && !isScrollingBack) {
                        // 清除之前可能存在的键盘收起超时
                        if (keyboardOpenTimeout) {
                            clearTimeout(keyboardOpenTimeout);
                            keyboardOpenTimeout = null;
                        }
                        
                        // 保存当前滚动位置（为当前输入框保存）
                        const currentScrollY = window.scrollY;
                        scrollPositions[this.id] = currentScrollY;
                        lastActiveInputId = this.id;
                        
                        // 延迟滚动到输入框位置，避免快速点击导致的问题
                        setTimeout(() => {
                            // 确保在滚动前检查是否仍需要滚动
                            if (!isScrollingBack && document.activeElement !== this) {
                                const inputRect = this.getBoundingClientRect();
                                // 只有当输入框不在可视区域中心时才滚动
                                if (inputRect.top < window.innerHeight * 0.2 || inputRect.bottom > window.innerHeight * 0.8) {
                                    this.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                }
                            }
                        }, 150);
                    }
                });
                
                // 监听输入框聚焦事件，标记键盘可见状态
                input.addEventListener('focus', function() {
                    if (isPortrait()) {
                        keyboardVisibleStartTime = Date.now();
                        lastActiveInputId = this.id;
                        
                        // 设置一个超时，当键盘长时间打开时更新滚动位置
                        keyboardOpenTimeout = setTimeout(() => {
                            // 如果键盘已经打开很长时间，更新保存的滚动位置
                            if (document.activeElement === this) {
                                scrollPositions[this.id] = window.scrollY;
                            }
                        }, 1000); // 1秒后更新位置
                    }
                });
                
                // 监听输入框失焦，恢复滚动位置
                input.addEventListener('blur', function() {
                    // 只在竖屏模式下恢复位置
                    if (isPortrait()) {
                        // 清除键盘打开超时
                        if (keyboardOpenTimeout) {
                            clearTimeout(keyboardOpenTimeout);
                            keyboardOpenTimeout = null;
                        }
                        
                        // 检查键盘打开的时间，避免快速点击/失焦导致的问题
                        const keyboardOpenDuration = Date.now() - keyboardVisibleStartTime;
                        
                        // 只有当键盘打开了足够长的时间（超过100ms）才需要恢复位置
                        // 对于快速收起键盘的情况，使用defaultScrollPosition作为后备
                        if (keyboardOpenDuration > 100) {
                            // 标记正在滚动回原位
                            isScrollingBack = true;
                            
                            // 延迟执行以确保键盘完全收起，增加延迟时间到600ms
                            setTimeout(() => {
                                // 检查当前是否还有其他输入框处于焦点状态
                                const activeElement = document.activeElement;
                                const isAnotherInputFocused = activeElement && 
                                    (activeElement.tagName.toLowerCase() === 'input' || 
                                     activeElement.tagName.toLowerCase() === 'textarea' || 
                                     activeElement.tagName.toLowerCase() === 'select');
                                
                                if (!isAnotherInputFocused) {
                                    // 使用最后活动的输入框ID获取滚动位置，如果不存在则使用默认滚动位置
                                    let targetScrollPosition = lastActiveInputId ? scrollPositions[lastActiveInputId] : null;
                                    
                                    // 如果没有找到对应的滚动位置或键盘快速收起，使用全局默认滚动位置
                                    if (targetScrollPosition === null || keyboardOpenDuration < 300) {
                                        targetScrollPosition = defaultScrollPosition;
                                    }
                                    
                                    // 滚动回保存的位置，使用更可靠的方式
                                    try {
                                        // 确保targetScrollPosition有效
                                        if (targetScrollPosition !== null && targetScrollPosition >= 0) {
                                            // 获取当前滚动位置，只有当差异足够大时才滚动
                                            const currentScrollY = window.scrollY;
                                            if (Math.abs(currentScrollY - targetScrollPosition) > 10) {
                                                window.scrollTo({ 
                                                    top: targetScrollPosition, 
                                                    behavior: 'smooth' 
                                                });
                                            }
                                        }
                                    } catch (err) {
                                        console.log('Scroll restoration error:', err);
                                    }
                                }
                                
                                // 重置状态标志，增加延迟时间确保滚动完成
                                setTimeout(() => {
                                    isScrollingBack = false;
                                }, 600);
                            }, 600); // 增加延迟时间，确保键盘完全收起并避免页面跳动
                        }
                    }
                });
            });
            
            // 5. 为四格记录纸的输入框添加特殊处理（解决缩放后无法调用键盘的问题）
            // 优化四格记录纸的触摸事件处理，区分点击和滑动操作
            let touchStartTime = 0;
            let touchStartX = 0;
            let touchStartY = 0;
            const CLICK_THRESHOLD = 5; // 滑动距离阈值，小于此值视为点击
            const TAP_TIMEOUT = 200; // 点击时间阈值，小于此值视为点击
            
            document.addEventListener('touchstart', function(e) {
                touchStartTime = Date.now();
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            }, { passive: true });
            
            document.addEventListener('touchend', function(e) {
                const touchEndTime = Date.now();
                const touchEndX = e.changedTouches[0].clientX;
                const touchEndY = e.changedTouches[0].clientY;
                
                // 计算触摸时间和距离
                const touchDuration = touchEndTime - touchStartTime;
                const touchDistanceX = Math.abs(touchEndX - touchStartX);
                const touchDistanceY = Math.abs(touchEndY - touchStartY);
                
                // 检查是否是在四格记录纸中点击了输入框，且符合点击条件
                const fourColumnGrid = e.target.closest('.grid-container.four-column');
                const isInputElement = e.target.tagName.toLowerCase() === 'input' || 
                                      e.target.tagName.toLowerCase() === 'textarea' || 
                                      e.target.tagName.toLowerCase() === 'select';
                
                // 只在竖屏模式下处理四格记录纸的输入框问题，且只有在真正的点击（非滑动）时才触发
                if (isPortrait() && fourColumnGrid && isInputElement && 
                    touchDuration < TAP_TIMEOUT && 
                    touchDistanceX < CLICK_THRESHOLD && 
                    touchDistanceY < CLICK_THRESHOLD && 
                    !isScrollingBack) {
                    // 清除之前可能存在的键盘收起超时
                    if (keyboardOpenTimeout) {
                        clearTimeout(keyboardOpenTimeout);
                        keyboardOpenTimeout = null;
                    }
                    
                    // 保存当前滚动位置
                    const currentScrollY = window.scrollY;
                    const inputId = e.target.id || `input-${Date.now()}`;
                    scrollPositions[inputId] = currentScrollY;
                    lastActiveInputId = inputId;
                    keyboardVisibleStartTime = Date.now();
                    
                    // 强制触发输入框的聚焦，解决缩放后触摸位置不匹配的问题
                    e.target.focus();
                    
                    // 滚动到输入框位置
                    setTimeout(() => {
                        // 使用getBoundingClientRect检测元素位置，避免不必要的滚动
                        const inputRect = e.target.getBoundingClientRect();
                        if (inputRect.top < window.innerHeight * 0.2 || inputRect.bottom > window.innerHeight * 0.8) {
                            e.target.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                        
                        // 设置一个超时，当键盘长时间打开时更新滚动位置
                        keyboardOpenTimeout = setTimeout(() => {
                            // 如果键盘已经打开很长时间，更新保存的滚动位置
                            if (document.activeElement === e.target) {
                                scrollPositions[inputId] = window.scrollY;
                            }
                        }, 1000); // 1秒后更新位置
                    }, 150);
                }
            }, { passive: false });
            
            // 标记用户是否在键盘打开期间主动滑动了页面
            let userInitiatedScroll = false;
            
            // 监听用户滑动事件
            document.addEventListener('touchmove', function(e) {
                // 只有在键盘打开且用户主动滑动时才设置标志
                if (isPortrait() && document.activeElement && 
                    (document.activeElement.tagName.toLowerCase() === 'input' || 
                     document.activeElement.tagName.toLowerCase() === 'textarea' || 
                     document.activeElement.tagName.toLowerCase() === 'select') && 
                    !isScrollingBack) {
                    userInitiatedScroll = true;
                }
            }, { passive: true });
            

            
            // 添加全局点击事件监听，用于检测点击输入框外区域导致键盘收起的情况
            document.addEventListener('touchstart', function(e) {
                // 检查点击目标是否不是输入框及其父元素
                const isInputElement = e.target.tagName.toLowerCase() === 'input' || 
                                      e.target.tagName.toLowerCase() === 'textarea' || 
                                      e.target.tagName.toLowerCase() === 'select';
                const hasInputParent = e.target.closest('input, textarea, select') !== null;
                
                // 如果点击的不是输入框，且当前有元素获得焦点
                if (!isInputElement && !hasInputParent && isPortrait() && 
                    document.activeElement && !isScrollingBack) {
                    const activeElement = document.activeElement;
                    const isInputFocused = activeElement && 
                        (activeElement.tagName.toLowerCase() === 'input' || 
                         activeElement.tagName.toLowerCase() === 'textarea' || 
                         activeElement.tagName.toLowerCase() === 'select');
                    
                    // 只有当输入框获得焦点且键盘打开了足够长时间时才恢复位置
                    if (isInputFocused) {
                            const keyboardOpenDuration = Date.now() - keyboardVisibleStartTime;
                            
                            if (keyboardOpenDuration > 100) {
                                // 标记正在滚动回原位
                                isScrollingBack = true;
                                
                                // 延迟执行以确保键盘完全收起，增加延迟时间到600ms
                                setTimeout(() => {
                                    try {
                                        // 如果用户主动滑动了页面，则不恢复滚动位置
                                        if (!userInitiatedScroll) {
                                            // 使用最后活动的输入框ID获取滚动位置，如果不存在则使用默认滚动位置
                                            let targetScrollPosition = lastActiveInputId ? scrollPositions[lastActiveInputId] : null;
                                            
                                            // 如果没有找到对应的滚动位置或键盘快速收起，使用全局默认滚动位置
                                            if (targetScrollPosition === null || keyboardOpenDuration < 300) {
                                                targetScrollPosition = defaultScrollPosition;
                                            }
                                            
                                            // 确保targetScrollPosition有效
                                            if (targetScrollPosition !== null && targetScrollPosition >= 0) {
                                                // 获取当前滚动位置，只有当差异足够大时才滚动
                                                const currentScrollY = window.scrollY;
                                                if (Math.abs(currentScrollY - targetScrollPosition) > 10) {
                                                    window.scrollTo({ 
                                                        top: targetScrollPosition, 
                                                        behavior: 'smooth' 
                                                    });
                                                }
                                            }
                                        }
                                    } catch (err) {
                                        console.log('Scroll restoration error:', err);
                                    }
                                    
                                    // 重置状态标志和用户滑动标志，增加延迟时间确保滚动完成
                                    setTimeout(() => {
                                        isScrollingBack = false;
                                        userInitiatedScroll = false; // 重置用户主动滑动标志
                                    }, 600);
                                }, 600); // 增加延迟时间，确保键盘完全收起并避免页面跳动
                            }
                        }
                }
            }, { passive: true });
            
            // 5. 移除下拉刷新功能 - 根据用户需求
            
            // 6. 为记录纸单元格添加长按手势支持
            document.querySelectorAll('.cell').forEach(cell => {
                let longPressTimer;
                
                cell.addEventListener('touchstart', function() {
                    longPressTimer = setTimeout(() => {
                        // 触发记录纸操作菜单（如果已实现）
                        if (typeof openPaperMenu === 'function') {
                            openPaperMenu(this.closest('.paper'));
                        }
                    }, 800);
                }, { passive: true });
                
                cell.addEventListener('touchend', function() {
                    clearTimeout(longPressTimer);
                });
                
                cell.addEventListener('touchmove', function() {
                    clearTimeout(longPressTimer);
                });
            });
        }
        
        // 侧边栏导航功能实现
        function initSidebar() {
            const menuBtn = document.getElementById('menu-btn');
            const sidebarNav = document.getElementById('sidebar-nav');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            const sidebarButtons = document.querySelectorAll('.sidebar-nav .btn');
            
            // 切换侧边栏显示/隐藏
            function toggleSidebar() {
                sidebarNav.classList.toggle('open');
                sidebarOverlay.classList.toggle('visible');
                document.body.style.overflow = sidebarNav.classList.contains('open') ? 'hidden' : '';
            }
            
            // 绑定汉堡菜单点击事件
            menuBtn.addEventListener('click', toggleSidebar);
            
            // 点击遮罩层关闭侧边栏
            sidebarOverlay.addEventListener('click', toggleSidebar);
            
            // 点击侧边栏中的按钮后关闭侧边栏并触发相应操作
            sidebarButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    toggleSidebar();
                    
                    // 特殊处理回收站按钮
                    if (this.id === 'sidebar-recycle-btn') {
                        // 根据设备类型和屏幕方向显示不同的回收站界面
                        setTimeout(() => {
                            // 获取两种回收站元素
                            const mobileRecycleModal = document.getElementById('mobile-recycle-modal');
                            const recycleBin = document.querySelector('.recycle-bin');
                            
                            // 检查屏幕方向
                            const isPortrait = window.innerHeight > window.innerWidth;
                            
                            if (isMobile() && isPortrait) {
                                // 只在移动设备且竖屏时显示弹窗式回收站
                                mobileRecycleModal.style.display = 'flex';
                                mobileRecycleModal.style.visibility = 'visible';
                                mobileRecycleModal.style.pointerEvents = 'auto';
                                recycleBin.style.display = 'none';
                                
                                // 更新移动端回收站内容
                                window.updateMobileRecycleBin();
                            } else {
                                // 在PC端或移动设备横屏时显示原始回收站，隐藏移动端弹窗
                                // 只设置显示属性，其他样式完全由CSS媒体查询控制
                                recycleBin.style.display = 'flex';
                                
                                // 完全清空所有可能覆盖CSS的内联样式
                                const allProperties = ['height', 'width', 'position', 'left', 'top', 'right', 'bottom', 'zIndex', 'flexDirection', 'padding', 'margin', 'backgroundColor', 'borderRadius', 'boxShadow', 'border'];
                                allProperties.forEach(prop => {
                                    recycleBin.style[prop] = '';
                                });
                                
                                // 为内容区域也清空内联样式，确保CSS完全控制
                                const recycleItems = recycleBin.querySelector('.recycle-items');
                                if (recycleItems) {
                                    ['overflowY', 'minHeight', 'maxHeight', 'flex', 'padding', 'margin'].forEach(prop => {
                                        recycleItems.style[prop] = '';
                                    });
                                }
                                
                                // 应用当前主题样式到回收站
                                const currentTheme = localStorage.getItem('threeGridTheme') || 'default';
                                if (currentTheme === 'dark') {
                                    // 暗黑主题下设置回收站背景色和文字颜色
                                    recycleBin.style.backgroundColor = '#2d3748';
                                    recycleBin.style.color = '#e2e8f0';
                                    // 为回收站标题设置文字颜色
                                    const recycleTitle = recycleBin.querySelector('.recycle-header h3');
                                    if (recycleTitle) {
                                        recycleTitle.style.color = '#e2e8f0';
                                    }
                                    // 为回收站项目设置背景色
                                    const recycleItemElements = recycleBin.querySelectorAll('.recycle-item');
                                    recycleItemElements.forEach(item => {
                                        item.style.backgroundColor = '#4a5568';
                                    });
                                }
                                
                                // 确保移动端弹窗完全隐藏
                                mobileRecycleModal.style.display = 'none';
                                mobileRecycleModal.style.visibility = 'hidden';
                                mobileRecycleModal.style.pointerEvents = 'none';
                            }
                        }, 300); // 等待侧边栏关闭动画完成
                    } else {
                        // 其他按钮：触发原按钮的点击事件
                        const originalBtnId = this.id.replace('sidebar-', '');
                        const originalBtn = document.getElementById(originalBtnId);
                        
                        if (originalBtn) {
                            setTimeout(() => {
                                originalBtn.click();
                            }, 300); // 等待侧边栏关闭动画完成
                        }
                    }
                });
            });
        }
        
        // 在DOM加载完成后初始化功能
        document.addEventListener('DOMContentLoaded', function() {
            initMobileOptimizations();
            initSidebar();
            
            // 在移动设备上初始化移动端回收站弹窗（无论横竖屏）
            if (isMobile()) {
                initMobileRecycleBin();
            }
            
            // 初始化对齐方式应用按钮
            initAlignmentApplyButtons();
        });
        
        // 初始化移动端回收站弹窗
        function initMobileRecycleBin() {
            const mobileRecycleModal = document.getElementById('mobile-recycle-modal');
            const mobileRecycleClose = document.getElementById('mobile-recycle-close');
            const mobileRecycleCloseBtn = document.getElementById('mobile-recycle-close-btn');
            const mobileEmptyRecycleBtn = document.getElementById('mobile-empty-recycle-btn');
            const mobileRecycleFilter = document.getElementById('mobile-recycle-filter');
            const mobileRecycleItems = document.getElementById('mobile-recycle-items');
            
            // 关闭弹窗
            function closeMobileRecycleModal() {
                mobileRecycleModal.style.display = 'none';
            }
            
            // 绑定关闭按钮事件
            mobileRecycleClose.addEventListener('click', closeMobileRecycleModal);
            mobileRecycleCloseBtn.addEventListener('click', closeMobileRecycleModal);
            
            // 点击弹窗外部关闭
            mobileRecycleModal.addEventListener('click', function(e) {
                if (e.target === mobileRecycleModal) {
                    closeMobileRecycleModal();
                }
            });
            
            // 清空回收站按钮事件
            mobileEmptyRecycleBtn.addEventListener('click', function() {
                if (confirm('确定要清空回收站吗？此操作不可恢复。')) {
                    clearRecycleBin();
                    closeMobileRecycleModal();
                }
            });
            
            // 筛选按钮事件
            mobileRecycleFilter.addEventListener('click', function(e) {
                if (e.target.classList.contains('filter-btn')) {
                    // 更新按钮选中状态
                    document.querySelectorAll('#mobile-recycle-filter .filter-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    e.target.classList.add('active');
                    
                    // 应用筛选
                    const filterType = e.target.dataset.filter;
                    window.recycleFilterType = filterType;
                    window.updateMobileRecycleBin();
                }
            });
            
            // 移动端回收站项目点击事件（恢复）
            mobileRecycleItems.addEventListener('click', function(e) {
                if (e.target.classList.contains('recycle-item') || e.target.closest('.recycle-item')) {
                    const recycleItem = e.target.closest('.recycle-item');
                    const recycleId = recycleItem.dataset.recycleId;
                    // 使用自定义恢复确认模态框
                    showRestoreConfirmModal('确认恢复', '确定要恢复这个项目吗？', function() {
                        restoreFromRecycleBin(recycleId);
                        window.updateMobileRecycleBin();
                    });
                }
            });
        }
        
        // 更新移动端回收站内容 - 绑定到window对象确保在任何作用域都可访问
        window.updateMobileRecycleBin = function() {
            const mobileRecycleItems = document.getElementById('mobile-recycle-items');
            const mobileEmptyRecycleBtn = document.getElementById('mobile-empty-recycle-btn');
            
            // 检查元素是否存在，避免在PC端或非竖屏模式下报错
            if (!mobileRecycleItems || !mobileEmptyRecycleBtn) {
                return;
            }
            
            // 确保容器有正确的滚动样式类
            mobileRecycleItems.className = 'recycle-items mobile-recycle-items';
            
            // 复制PC端回收站的内容到移动端
            const pcRecycleItems = document.getElementById('recycle-items');
            
            // 清空移动端回收站
            mobileRecycleItems.innerHTML = '';
            
            // 如果回收站为空
            if (pcRecycleItems && pcRecycleItems.querySelector('div[style*="text-align: center"]')) {
                mobileRecycleItems.innerHTML = '<div style="text-align: center; color: #999; font-size: 0.9rem;">回收站为空</div>';
                mobileEmptyRecycleBtn.disabled = true;
            } else if (pcRecycleItems) {
                // 复制PC端的回收站项目
                const recycleItems = pcRecycleItems.querySelectorAll('.recycle-item');
                recycleItems.forEach(item => {
                    const clonedItem = item.cloneNode(true);
                    mobileRecycleItems.appendChild(clonedItem);
                });
                mobileEmptyRecycleBtn.disabled = false;
            }
            
            // 应用筛选
            const filterType = window.recycleFilterType || 'all';
            const items = mobileRecycleItems.querySelectorAll('.recycle-item');
            let visibleItemsCount = 0;
            
            items.forEach(item => {
                const itemType = item.querySelector('.recycle-item-type');
                if (!itemType) {
                    item.style.display = 'block';
                    visibleItemsCount++;
                    return;
                }
                
                const isPaper = itemType.classList.contains('paper');
                const isNotebook = itemType.classList.contains('notebook');
                
                if (filterType === 'all' || 
                    (filterType === 'paper' && isPaper) || 
                    (filterType === 'notebook' && isNotebook)) {
                    item.style.display = 'block';
                    visibleItemsCount++;
                } else {
                    item.style.display = 'none';
                }
            });
            
            // 如果筛选后没有可见项，显示空状态
            if (visibleItemsCount === 0 && items.length > 0) {
                mobileRecycleItems.innerHTML = '<div style="text-align: center; color: #999; font-size: 0.9rem;">没有符合条件的项目</div>';
            }
            
            // 强制重新应用滚动样式
            mobileRecycleItems.style.overflowY = 'auto';
            mobileRecycleItems.style.maxHeight = '300px';
            mobileRecycleItems.style['-webkit-overflow-scrolling'] = 'touch';
        };
        

            
            // 设置确认按钮事件
            confirmSettingsBtn.addEventListener('click', function() {
                applySettings();
                saveStyleToLocalStorage();
                settingsModal.style.display = 'none';
            });
            
            // 设置取消按钮事件
            cancelSettingsBtn.addEventListener('click', function() {
                settingsModal.style.display = 'none';
            });
            
            // 主题选项点击事件
            document.querySelectorAll('.theme-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
            
            // 选项卡切换事件
            document.querySelectorAll('.tab-btn').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    
                    // 更新选项卡选中状态
                    document.querySelectorAll('.tab-btn').forEach(t => {
                        t.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // 显示对应内容区域
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.style.display = 'none';
                    });
                    document.getElementById(`${tabId}-content`).style.display = 'block';
                });
            });
            
            // 确认清空回收站模态框HTML
            const confirmEmptyModalHtml = `
                <div id="confirm-empty-modal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <h3>确认清空回收站</h3>
                        <p>确定要清空回收站吗？此操作不可恢复。</p>
                        <div class="modal-actions">
                            <button class="btn btn-secondary" id="cancel-empty-btn">取消</button>
                            <button class="btn btn-primary" id="confirm-empty-btn">确定</button>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', confirmEmptyModalHtml);
            
            const confirmEmptyModal = document.getElementById('confirm-empty-modal');
            const cancelEmptyBtn = document.getElementById('cancel-empty-btn');
            const confirmEmptyBtn = document.getElementById('confirm-empty-btn');
            
            // 清空回收站按钮事件
            emptyRecycleBtn.addEventListener('click', function() {
                confirmEmptyModal.style.display = 'flex';
            });
            
            // 取消清空回收站
            cancelEmptyBtn.addEventListener('click', function() {
                confirmEmptyModal.style.display = 'none';
            });
            
            // 确认清空回收站
            confirmEmptyBtn.addEventListener('click', function() {
                confirmEmptyModal.style.display = 'none';
                clearRecycleBin();
            });
            
            // 点击模态框外部关闭
            window.addEventListener('click', function(event) {
                if (event.target === confirmEmptyModal) {
                    confirmEmptyModal.style.display = 'none';
                }
            });
            
            // 收起回收站按钮事件
            const collapseRecycleBtn = document.getElementById('collapse-recycle-btn');
            if (collapseRecycleBtn) {
                // 点击事件
                collapseRecycleBtn.addEventListener('click', function() {
                    // 在PC端隐藏回收站
                    const recycleBin = document.querySelector('.recycle-bin');
                    recycleBin.style.display = 'none';
                });
                
                // 鼠标悬停提示
                const tooltip = collapseRecycleBtn.nextElementSibling;
                collapseRecycleBtn.addEventListener('mouseenter', function() {
                    tooltip.style.visibility = 'visible';
                    tooltip.style.opacity = '1';
                });
                collapseRecycleBtn.addEventListener('mouseleave', function() {
                    tooltip.style.visibility = 'hidden';
                    tooltip.style.opacity = '0';
                });
                
                // 移动端长按提示和点击支持
                let longPressTimer;
                collapseRecycleBtn.addEventListener('touchstart', function(e) {
                    // 移除preventDefault，允许点击事件正常触发
                    longPressTimer = setTimeout(() => {
                        tooltip.style.visibility = 'visible';
                        tooltip.style.opacity = '1';
                        setTimeout(() => {
                            tooltip.style.visibility = 'hidden';
                            tooltip.style.opacity = '0';
                        }, 2000); // 2秒后自动隐藏
                    }, 500); // 500毫秒长按触发
                });
                collapseRecycleBtn.addEventListener('touchend', function() {
                    clearTimeout(longPressTimer);
                });
                collapseRecycleBtn.addEventListener('touchmove', function() {
                    clearTimeout(longPressTimer);
                });
                collapseRecycleBtn.addEventListener('touchcancel', function() {
                    clearTimeout(longPressTimer);
                });
            }
            
            // 回收站项目点击事件（恢复）
            recycleItems.addEventListener('click', function(e) {
                if (e.target.classList.contains('recycle-item') || e.target.closest('.recycle-item')) {
                    const recycleItem = e.target.closest('.recycle-item');
                    const recycleId = recycleItem.dataset.recycleId;
                    // 使用自定义恢复确认模态框
                    showRestoreConfirmModal('确认恢复', '确定要恢复这个项目吗？', function() {
                        restoreFromRecycleBin(recycleId);
                    });
                }
            });
        }

        // 显示删除确认模态框
        function showDeleteConfirmModal(title, message, callback, params = null) {
            const deleteConfirmModal = document.getElementById('delete-confirm-modal');
            const deleteConfirmTitle = document.getElementById('delete-confirm-title');
            const deleteConfirmMessage = document.getElementById('delete-confirm-message');
            
            // 重置状态
            deleteConfirmCallback = callback;
            deleteConfirmParams = params;
            
            // 设置内容
            deleteConfirmTitle.textContent = title;
            deleteConfirmMessage.textContent = message;
            
            // 显示模态框
            deleteConfirmModal.style.display = 'flex';
        }
        
        // 全局变量用于恢复确认模态框
        let restoreConfirmCallback = null;
        let restoreConfirmParams = null;
        
        // 显示恢复确认模态框
        function showRestoreConfirmModal(title, message, callback, params = null) {
            const restoreConfirmModal = document.getElementById('restore-confirm-modal');
            const restoreConfirmTitle = document.getElementById('restore-confirm-title');
            const restoreConfirmMessage = document.getElementById('restore-confirm-message');
            
            // 重置状态
            restoreConfirmCallback = callback;
            restoreConfirmParams = params;
            
            // 设置内容
            restoreConfirmTitle.textContent = title;
            restoreConfirmMessage.textContent = message;
            
            // 显示模态框
            restoreConfirmModal.style.display = 'flex';
        }
        
        // 初始化删除确认模态框事件
        function initDeleteConfirmModal() {
            const deleteConfirmModal = document.getElementById('delete-confirm-modal');
            const deleteConfirmBtn = document.getElementById('delete-confirm-btn');
            const deleteCancelBtn = document.getElementById('delete-cancel-btn');
            const modalContent = deleteConfirmModal.querySelector('.modal-content');
            
            // 确认删除
            deleteConfirmBtn.addEventListener('click', function() {
                if (typeof deleteConfirmCallback === 'function') {
                    deleteConfirmCallback(deleteConfirmParams);
                }
                deleteConfirmModal.style.display = 'none';
            });
            
            // 取消删除
            deleteCancelBtn.addEventListener('click', function() {
                deleteConfirmModal.style.display = 'none';
            });
            
            // 点击背景关闭
            deleteConfirmModal.addEventListener('click', function(e) {
                if (e.target === deleteConfirmModal) {
                    deleteConfirmModal.style.display = 'none';
                }
            });
            
            // 阻止事件冒泡
            modalContent.addEventListener('click', function(e) {
                e.stopPropagation();
            });
        }
        
        // 初始化恢复确认模态框事件
        function initRestoreConfirmModal() {
            const restoreConfirmModal = document.getElementById('restore-confirm-modal');
            const restoreConfirmBtn = document.getElementById('restore-confirm-btn');
            const restoreCancelBtn = document.getElementById('restore-cancel-btn');
            const modalContent = restoreConfirmModal.querySelector('.modal-content');
            
            // 确认恢复
            restoreConfirmBtn.addEventListener('click', function() {
                if (typeof restoreConfirmCallback === 'function') {
                    restoreConfirmCallback(restoreConfirmParams);
                }
                restoreConfirmModal.style.display = 'none';
            });
            
            // 取消恢复
            restoreCancelBtn.addEventListener('click', function() {
                restoreConfirmModal.style.display = 'none';
            });
            
            // 点击背景关闭
            restoreConfirmModal.addEventListener('click', function(e) {
                if (e.target === restoreConfirmModal) {
                    restoreConfirmModal.style.display = 'none';
                }
            });
            
            // 阻止事件冒泡
            modalContent.addEventListener('click', function(e) {
                e.stopPropagation();
            });
        }
        
        // 使用模板创建记录纸
        function createPaperWithTemplate(title, templateId) {
            // 检查是否有记录本
            if (notebooks.length === 0) {
                showToast('请先创建一个记录本');
                return;
            }
            
            const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
            if (!currentNotebook) return;

            // 获取模板数据，如果不存在则使用默认的空白数据结构
            const template = templates[templateId] || {
                name: '自定义模板',
                data: Array(3).fill().map(() => Array(25).fill(''))
            };
            
            // 为不同模板设置特定的样式
            let templateStyle = { ...currentStyle };
            
            switch(templateId) {
                case 'todo':
                    templateStyle = {
                        ...currentStyle,
                        lineStyle: 'dashed',
                        lineColor: '#5cb85c', // 绿色
                        backgroundColor: '#f9fff9',
                        columnBorderStyle: 'solid'
                    };
                    break;
                case 'notes':
                    templateStyle = {
                        ...currentStyle,
                        lineStyle: 'dotted',
                        lineColor: '#337ab7', // 蓝色
                        backgroundColor: '#f0f7ff',
                        columnBorderStyle: 'solid'
                    };
                    break;
                case 'meeting':
                    templateStyle = {
                        ...currentStyle,
                        lineStyle: 'solid',
                        lineColor: '#f0ad4e', // 橙色
                        backgroundColor: '#fff9f0',
                        columnBorderStyle: 'solid'
                    };
                    break;
                case 'speaker':
                    templateStyle = {
                        ...currentStyle,
                        lineStyle: 'solid',
                        lineColor: '#333333',
                        backgroundColor: '#ffffff',
                        textAlignment: 'center',
                        columnBorderStyle: 'solid',
                        backgroundImage: 'speaker' // 直接设置backgroundImage属性
                    };
                    break;
                default:
                    // 其他模板或默认情况使用当前样式设置
                    templateStyle = { ...currentStyle };
                    break;
            }
            
            const newPaper = {
                id: Date.now().toString(),
                title: title,
                date: new Date().toLocaleDateString('zh-CN'),
                data: JSON.parse(JSON.stringify(template.data)),
                style: templateStyle // 应用模板特定的样式设置
            };

            currentNotebook.papers.unshift(newPaper);
            currentNotebook.updatedAt = new Date().toISOString(); // 更新修改时间
            debouncedSaveToLocalStorage();
            renderPapers();
        }

        // 打开本地备份与恢复模态框 - 控制栏按钮
        syncBtn.addEventListener('click', function() {
            // 为确保弹窗显示在最顶层，设置更高的z-index值
            syncModal.style.zIndex = '1005';
            syncModal.style.display = 'flex';
        });
        
        // 侧边栏同步按钮的事件处理由initSidebar函数统一处理，无需单独绑定

        // 标签系统
        // 为新记录纸添加标签
        addTagsBtn.addEventListener('click', function() {
            if (!currentPaperId) {
                alert('请先选择一个记录纸');
                return;
            }
            
            const paper = getCurrentPaper();
            if (!paper) return;
            
            paperTagsInput.value = paper.tags ? paper.tags.join(', ') : '';
            tagsModal.style.display = 'block';
        });

        // 确认添加标签
        confirmTagsBtn.addEventListener('click', function() {
            if (!currentPaperId) return;
            
            const paper = getCurrentPaper();
            if (!paper) return;
            
            const tagsText = paperTagsInput.value.trim();
            paper.tags = tagsText ? tagsText.split(',').map(tag => tag.trim()).filter(tag => tag) : [];
            
            // 更新记录本的修改时间
            const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
            if (currentNotebook) {
                currentNotebook.updatedAt = new Date().toISOString();
            }
            
            saveToLocalStorage();
            renderPapers();
            tagsModal.style.display = 'none';
        });

        // 搜索标签功能
        function searchByTag(tag) {
            const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
            if (!currentNotebook) return;
            
            const filteredPapers = currentNotebook.papers.filter(paper => 
                paper.tags && paper.tags.includes(tag)
            );
            
            // 在实际应用中，这里应该显示筛选后的记录纸列表
            alert(`找到 ${filteredPapers.length} 个包含标签 "${tag}" 的记录纸`);
            // 为简化示例，我们在控制台打印筛选结果
            console.log('筛选结果:', filteredPapers);
        }



        // 排序记录本函数
        function sortNotebooks(sortBy, sortOrder) {
            notebooks.sort((a, b) => {
                if (sortBy === 'title') {
                    // 按名称排序
                    const titleA = a.title.toLowerCase();
                    const titleB = b.title.toLowerCase();
                    if (sortOrder === 'asc') {
                        return titleA.localeCompare(titleB);
                    } else {
                        return titleB.localeCompare(titleA);
                    }
                } else if (sortBy === 'createdAt' || sortBy === 'updatedAt') {
                    // 按时间排序
                    if (sortOrder === 'asc') {
                        return new Date(a[sortBy]) - new Date(b[sortBy]);
                    } else {
                        return new Date(b[sortBy]) - new Date(a[sortBy]);
                    }
                }
                return 0;
            });
            saveToLocalStorage();
            renderNotebooksList();
        }

        // 从本地存储加载数据，添加错误处理
        function loadFromLocalStorage() {
            try {
                // 1. 检查是否有用户选择的存储路径
                const storagePath = localStorage.getItem('threeGridStoragePath');
                

                
                if (storagePath && storagePath !== '本地浏览器存储') {
                    // 如果有用户选择的存储路径，尝试使用导入功能加载数据
                    showToast('检测到您已设置自定义存储路径，请使用导入功能加载数据');
                }
                
                // 从localStorage加载数据
                loadFromBrowserStorage();
            } catch (error) {
                console.error('加载本地存储数据时发生错误:', error);
                createDefaultNotebook();
            }
        }
        
        // 从浏览器localStorage加载数据的核心函数
        function loadFromBrowserStorage() {
            try {
                // 1. 加载基本的记录本数据
                const savedNotebooks = localStorage.getItem('threeGridNotebooks');
                if (savedNotebooks) {
                    try {
                        const parsedNotebooks = JSON.parse(savedNotebooks);
                        // 验证数据结构是否有效
                        if (Array.isArray(parsedNotebooks)) {
                            notebooks = parsedNotebooks;
                            // 确保每个notebook都有createdAt和updatedAt属性
                            notebooks.forEach(notebook => {
                                if (!notebook.createdAt) {
                                    notebook.createdAt = new Date().toISOString();
                                    notebook.updatedAt = new Date().toISOString();
                                } else if (!notebook.updatedAt) {
                                    notebook.updatedAt = notebook.createdAt;
                                }
                            });
                            // 默认按创建时间排序，越新创建的记录本排在越前面
                            sortNotebooks('createdAt', 'desc');
                        } else {
                            console.error('本地存储数据格式无效，使用默认数据');
                            createDefaultNotebook();
                        }
                    } catch (jsonError) {
                        console.error('解析本地存储数据失败:', jsonError);
                        createDefaultNotebook();
                    }
                } else {
                    createDefaultNotebook();
                }
                
                // 2. 加载回收站数据，添加错误处理
                try {
                    const savedRecycleBin = localStorage.getItem('recycleBinData');
                    if (savedRecycleBin) {
                        try {
                            const parsedRecycleBin = JSON.parse(savedRecycleBin);
                            // 验证数据结构是否有效
                            if (Array.isArray(parsedRecycleBin)) {
                                recycleBinData = parsedRecycleBin;
                            } else {
                                console.error('回收站数据格式无效，使用空回收站');
                                recycleBinData = [];
                            }
                        } catch (jsonError) {
                            console.error('解析回收站数据失败:', jsonError);
                            recycleBinData = [];
                        }
                    }
                } catch (error) {
                    console.error('加载回收站数据时发生错误:', error);
                    recycleBinData = [];
                }
                
                // 3. 从本地存储加载样式设置，添加错误处理
                try {
                    const savedStyle = localStorage.getItem('currentStyle');
                    if (savedStyle) {
                        try {
                            const parsedStyle = JSON.parse(savedStyle);
                            // 验证数据结构是否有效
                            if (parsedStyle && typeof parsedStyle === 'object') {
                                currentStyle = parsedStyle;
                            } else {
                                console.error('样式设置数据格式无效，使用默认样式');
                                // 保持现有currentStyle不变，它已经在其他地方初始化了
                            }
                        } catch (jsonError) {
                            console.error('解析样式设置失败:', jsonError);
                            // 保持现有currentStyle不变
                        }
                    }
                } catch (error) {
                    console.error('加载样式设置时发生错误:', error);
                    // 保持现有currentStyle不变
                }
            } catch (error) {
                console.error('从浏览器存储加载数据时发生错误:', error);
                createDefaultNotebook();
            }
        }
        
        // 创建默认记录本
        function createDefaultNotebook() {
            try {
                // 使用更健壮的移动端检测方法
                const isMobile = window.matchMedia('(max-width: 768px)').matches || 
                                navigator.userAgent.match(/(iPhone|iPad|iPod|Android|webOS|BlackBerry|IEMobile|Opera Mini)/i) !== null;
                const defaultRows = isMobile ? 9 : 15;
                
                console.log('检测到设备类型:', isMobile ? '移动设备' : 'PC设备', '，创建默认', defaultRows, '行记录纸');
                
                // 创建默认的三格记录纸数据，包含示例内容
                const defaultPaperData = Array(3).fill().map(() => Array(defaultRows).fill(''));
                
                // 为第一格添加示例内容（左侧）
                defaultPaperData[0][0] = '<div style="font-weight: bold; color: #1a56db; text-align: center; padding-bottom: 10px;">📝 左侧栏</div>';
                defaultPaperData[0][1] = '这里可以记录你的灵感、创意和想法';
                defaultPaperData[0][3] = '💡 点击右下角"+"按钮可以添加更多内容';
                
                // 为第二格添加示例内容（中间）
                defaultPaperData[1][0] = '<div style="font-weight: bold; color: #059669; text-align: center; padding-bottom: 10px;">📋 中间栏</div>';
                defaultPaperData[1][1] = '这里可以记录待办事项、计划和目标';
                defaultPaperData[1][3] = '✅ 完成的任务可以标记出来';
                
                // 为第三格添加示例内容（右侧）
                defaultPaperData[2][0] = '<div style="font-weight: bold; color: #b45309; text-align: center; padding-bottom: 10px;">💭 右侧栏</div>';
                defaultPaperData[2][1] = '这里可以记录反思、总结和收获';
                defaultPaperData[2][3] = '📚 随时回顾和完善你的思考';
                
                notebooks = [{
                    id: Date.now().toString(),
                    title: '我的第一个记录本',
                    papers: [{
                        id: (Date.now() + 1).toString(),
                        title: '示例记录纸',
                        date: new Date().toLocaleDateString('zh-CN'),
                        data: defaultPaperData,
                        style: { 
                            textAlignment: 'center', 
                            backgroundColor: '#ffffff', 
                            backgroundImage: null, 
                            customBackgroundImage: null 
                        }
                    }],
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                }];
                
                // 确保数据保存到本地存储
                saveToLocalStorage();
                
                // 在创建默认记录本后立即渲染，确保在移动端能正确显示
                renderNotebooksList();
                if (notebooks.length > 0) {
                    switchToNotebook(notebooks[0].id);
                }
                
                console.log('默认记录本创建成功，已包含示例记录纸');
            } catch (error) {
                console.error('创建默认记录本失败:', error);
                // 即使保存失败，也至少设置一个包含默认数据的notebooks数组
                notebooks = [{
                    id: Date.now().toString(),
                    title: '我的第一个记录本',
                    papers: [{id: (Date.now() + 1).toString(), title: '示例记录纸', date: new Date().toLocaleDateString('zh-CN'), data: [[], [], []], style: {textAlignment: 'center', backgroundColor: '#ffffff'}}],
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                }];
                
                // 强制渲染
                renderNotebooksList();
                if (notebooks.length > 0) {
                    switchToNotebook(notebooks[0].id);
                }
            }
        }
        
        // 保存回收站数据到本地存储
        function saveRecycleBinToLocalStorage() {
            try {
                localStorage.setItem('recycleBinData', JSON.stringify(recycleBinData));
            } catch (error) {
                console.error('保存回收站数据失败:', error);
            }
        }
        
        // 保存样式设置到本地存储
        function saveStyleToLocalStorage() {
            try {
                localStorage.setItem('currentStyle', JSON.stringify(currentStyle));
            }
            catch (error) {
                console.error('保存样式设置失败:', error);
            }
        }
        
        // 导入数据功能
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.style.display = 'none';
            
            input.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        try {
                            const importData = JSON.parse(e.target.result);
                            
                            // 验证数据结构
                            if (importData.notebooks && Array.isArray(importData.notebooks)) {
                                // 备份当前数据
                                const backupData = {
                                    notebooks: notebooks,
                                    recycleBinData: recycleBinData,
                                    currentStyle: currentStyle
                                };
                                
                                // 导入数据
                                notebooks = importData.notebooks || [];
                                if (importData.recycleBinData && Array.isArray(importData.recycleBinData)) {
                                    recycleBinData = importData.recycleBinData;
                                }
                                if (importData.currentStyle && typeof importData.currentStyle === 'object') {
                                    currentStyle = importData.currentStyle;
                                }
                                
                                // 保存导入的数据
                                saveToLocalStorage();
                                saveRecycleBinToLocalStorage();
                                saveStyleToLocalStorage();
                                
                                // 更新UI
                                renderNotebooksList();
                                if (notebooks.length > 0) {
                                    switchToNotebook(notebooks[0].id);
                                }
                                updateRecycleBinUI();
                                applyThemeToUI();
                                
                                showToast('数据导入成功');
                            } else {
                                showToast('无效的数据文件，请选择正确的三格记录本数据文件');
                            }
                        } catch (error) {
                            console.error('导入数据失败:', error);
                            showToast('数据解析失败，请检查文件格式');
                        }
                    };
                    
                    reader.readAsText(file);
                }
            });
            
            document.body.appendChild(input);
            input.click();
            
            // 移除临时元素
            setTimeout(() => {
                document.body.removeChild(input);
            }, 100);
        }
        
        // 注意：存储设置中的导入导出功能已移至同步与备份菜单，此处不再添加这些功能
        
        // 将记录纸移至回收站
        function moveToRecycleBin(paperId) {
            showDeleteConfirmModal(
                '确认删除记录纸',
                '确定要将此记录纸移至回收站吗？',
                function() {
                    const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
                    if (!currentNotebook) return;
                    
                    const paperIndex = currentNotebook.papers.findIndex(p => p.id === paperId);
                    if (paperIndex === -1) return;
                    
                    const paper = currentNotebook.papers[paperIndex];
                    // 从记录本中移除
                    currentNotebook.papers.splice(paperIndex, 1);
                    currentNotebook.updatedAt = new Date().toISOString(); // 更新修改时间

                    // 添加到回收站
                    const recycleItem = {
                        id: Date.now().toString(),
                        type: 'paper', // 标记为记录纸类型
                        paper: paper,
                        notebookId: currentNotebookId,
                        deletedAt: new Date().toLocaleString('zh-CN')
                    };
                    recycleBinData.push(recycleItem);
                    
                    // 保存数据
                    saveToLocalStorage();
                    saveRecycleBinToLocalStorage();
                    
                    // 更新UI
                    renderPapers();
                    updateRecycleBinUI();
                    window.updateMobileRecycleBin();
                }
            );
        }
        
        // 从回收站恢复项目
        function restoreFromRecycleBin(recycleId) {
            const recycleItemIndex = recycleBinData.findIndex(item => item.id === recycleId);
            if (recycleItemIndex === -1) return;
            
            const recycleItem = recycleBinData[recycleItemIndex];
            
            // 根据类型恢复不同的项目
            if (recycleItem.type === 'paper') {
                // 恢复记录纸
                const notebook = notebooks.find(n => n.id === recycleItem.notebookId);
                
                if (notebook) {
                    // 将记录纸添加回记录本
                    notebook.papers.unshift(recycleItem.paper);
                    // 更新记录本的修改时间
                    notebook.updatedAt = new Date().toISOString();
                    
                    // 从回收站移除
                    recycleBinData.splice(recycleItemIndex, 1);
                    
                    // 保存数据
                    saveToLocalStorage();
                    saveRecycleBinToLocalStorage();
                    
                    // 更新UI
                    renderPapers();
                    updateRecycleBinUI();
                } else {
                    alert('无法找到原始记录本，无法恢复记录纸。');
                }
            } else if (recycleItem.type === 'notebook') {
                // 恢复记录本
                // 检查是否存在同名记录本
                const existingNotebook = notebooks.find(n => n.title === recycleItem.notebook.title);
                if (existingNotebook) {
                    alert('已存在同名记录本，请先重命名现有记录本。');
                    return;
                }
                
                // 将记录本添加回记录本列表
                notebooks.push(recycleItem.notebook);
                
                // 从回收站移除
                recycleBinData.splice(recycleItemIndex, 1);
                
                // 保存数据
                saveToLocalStorage();
                saveRecycleBinToLocalStorage();
                
                // 更新UI
                renderNotebooksList();
                updateRecycleBinUI();
                window.updateMobileRecycleBin();
            }
        }
        
        // 清空回收站
        function clearRecycleBin() {
            recycleBinData = [];
            saveRecycleBinToLocalStorage();
            updateRecycleBinUI();
            window.updateMobileRecycleBin();
        }
        
        // 更新回收站UI
        function updateRecycleBinUI() {
            // 添加筛选按钮区域
            const recycleBinElement = document.querySelector('.recycle-bin');
            let filterButtons = recycleBinElement.querySelector('.recycle-filter-buttons');
            
            if (!filterButtons) {
                filterButtons = document.createElement('div');
                filterButtons.className = 'recycle-filter-buttons';
                filterButtons.style.display = 'flex';
                filterButtons.style.marginBottom = '15px';
                filterButtons.style.gap = '8px';
                filterButtons.innerHTML = `
                    <button class="filter-btn ${window.recycleFilterType === 'all' ? 'active' : ''}" data-filter="all">全部</button>
                    <button class="filter-btn ${window.recycleFilterType === 'paper' ? 'active' : ''}" data-filter="paper">记录纸</button>
                    <button class="filter-btn ${window.recycleFilterType === 'notebook' ? 'active' : ''}" data-filter="notebook">记录本</button>
                `;
                
                // 添加筛选按钮样式
                const style = document.createElement('style');
                style.textContent = `
                    .filter-btn {
                        flex: 1;
                        padding: 6px 12px;
                        border: 1px solid var(--border-light);
                        border-radius: var(--radius-small);
                        font-size: 0.85rem;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        /* 不设置固定背景色，由updateUIElementsStyles函数根据主题统一控制 */
                    }
                    .filter-btn:hover {
                        /* 不设置悬停背景色，由updateUIElementsStyles函数根据主题统一控制 */
                    }
                    .filter-btn.active {
                        border-color: var(--primary-color);
                        /* 不设置激活状态背景色和文字颜色，由updateUIElementsStyles函数根据主题统一控制 */
                    }
                    .recycle-item-type {
                        display: inline-block;
                        padding: 2px 8px;
                        margin-right: 8px;
                        background: var(--accent-color);
                        color: white;
                        border-radius: 12px;
                        font-size: 0.75rem;
                        vertical-align: middle;
                    }
                    /* 移动端弹窗中缩短标签长度 */
                    #mobile-recycle-modal .recycle-item-type {
                        max-width: 60px;
                        overflow: hidden;
                        text-overflow: ellipsis;
                        white-space: nowrap;
                        padding: 2px 6px;
                    }
                    .recycle-item-type.notebook {
                        background: #ff9800;
                    }
                    .recycle-item-type.paper {
                        background: #4caf50;
                    }
                `;
                document.head.appendChild(style);
                
                // 插入到回收站头部下方
                const recycleHeader = recycleBinElement.querySelector('.recycle-header');
                recycleHeader.parentNode.insertBefore(filterButtons, recycleHeader.nextSibling);
                
                // 添加筛选按钮事件监听
                filterButtons.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        window.recycleFilterType = this.dataset.filter;
                        // 更新按钮状态
                        filterButtons.querySelectorAll('.filter-btn').forEach(b => {
                            b.classList.remove('active');
                        });
                        this.classList.add('active');
                        updateRecycleBinUI();
                        // 重新应用主题样式，确保暗黑主题下按钮样式正确显示
                        updateUIElementsStyles();
                    });
                });
            }
            
            // 应用筛选
            let filteredItems = recycleBinData;
            if (window.recycleFilterType === 'paper') {
                filteredItems = recycleBinData.filter(item => item.type === 'paper' || !item.type);
            } else if (window.recycleFilterType === 'notebook') {
                filteredItems = recycleBinData.filter(item => item.type === 'notebook');
            }
            
            recycleCount.textContent = filteredItems.length;
            
            if (recycleBinData.length === 0) {
                recycleItems.innerHTML = '<div style="text-align: center; color: #999; font-size: 0.9rem;">回收站为空</div>';
                emptyRecycleBtn.disabled = true;
            } else {
                recycleItems.innerHTML = '';
                
                // 创建显示的项目列表
                let itemsToShow = filteredItems;
                let hasMore = false;
                
                // 只显示最后3个删除的项目
                if (filteredItems.length > 3) {
                    itemsToShow = filteredItems.slice(-3);
                    hasMore = true;
                }
                
                // 渲染显示的项目
                        itemsToShow.forEach(item => {
                            const recycleItem = document.createElement('div');
                            recycleItem.className = 'recycle-item';
                            recycleItem.setAttribute('data-recycle-id', item.id);
                            
                            // 创建恢复按钮
                            const restoreButton = document.createElement('button');
                            restoreButton.className = 'restore-btn';
                            restoreButton.textContent = '恢复';
                            restoreButton.addEventListener('click', (e) => {
                                e.stopPropagation(); // 阻止事件冒泡到父元素
                                // 使用自定义恢复确认模态框
                                showRestoreConfirmModal('确认恢复', '确定要恢复这个记录纸吗？', function() {
                                    restoreFromRecycleBin(item.id);
                                });
                            });
                            
                            // 创建项目内容容器
                            const contentContainer = document.createElement('div');
                            contentContainer.style.flex = '1';
                            
                            // 根据项目类型显示不同内容
                            if (item.type === 'notebook' || item.notebook) {
                                // 记录本项目
                                const notebook = item.notebook || item;
                                const paperCount = notebook.papers ? notebook.papers.length : 0;
                                contentContainer.innerHTML = `
                                    <div class="recycle-item-title">
                                        <span class="recycle-item-type notebook">记录本</span>
                                        ${notebook.title}
                                    </div>
                                    <div class="recycle-item-meta">${paperCount} 张记录纸</div>
                                    <div class="recycle-item-date">删除时间: ${item.deletedAt}</div>
                                `;
                            } else {
                                // 记录纸项目
                                const paper = item.paper || item;
                                contentContainer.innerHTML = `
                                    <div class="recycle-item-title">
                                        <span class="recycle-item-type paper">记录纸</span>
                                        ${paper.title}
                                    </div>
                                    <div class="recycle-item-date">删除时间: ${item.deletedAt}</div>
                                `;
                            }
                            
                            // 组织项目结构
                            recycleItem.appendChild(contentContainer);
                            recycleItem.appendChild(restoreButton);
                            
                            // 添加到列表
                            recycleItems.appendChild(recycleItem);
                        });
                
                // 添加展开按钮（如果有更多项目）
                if (hasMore) {
                    const showAllBtn = document.createElement('button');
                    showAllBtn.className = 'expand-recycle-btn';
                    showAllBtn.textContent = '查看剩余 ' + (filteredItems.length - 3) + ' 个项目';
                    showAllBtn.addEventListener('click', function() {
                        // 移除展开按钮
                        recycleItems.removeChild(showAllBtn);
                        
                        // 渲染所有剩余项目
                            const remainingItems = filteredItems.slice(0, -3);
                            
                            // 如果移动端回收站打开，也更新移动端回收站
                            if (isMobile() && document.getElementById('mobile-recycle-modal').style.display === 'flex') {
                                updateMobileRecycleBin();
                            }
                        remainingItems.forEach(item => {
                            const recycleItem = document.createElement('div');
                            recycleItem.className = 'recycle-item';
                            recycleItem.setAttribute('data-recycle-id', item.id);
                             
                            // 创建恢复按钮
                            const restoreButton = document.createElement('button');
                            restoreButton.className = 'restore-btn';
                            restoreButton.textContent = '恢复';
                            restoreButton.addEventListener('click', (e) => {
                                e.stopPropagation(); // 阻止事件冒泡到父元素
                                // 使用自定义恢复确认模态框
                                showRestoreConfirmModal('确认恢复', '确定要恢复这个记录本吗？', function() {
                                    restoreFromRecycleBin(item.id);
                                });
                            });
                             
                            // 创建项目内容容器
                            const contentContainer = document.createElement('div');
                            contentContainer.style.flex = '1';
                             
                            // 根据项目类型显示不同内容
                            if (item.type === 'notebook' || item.notebook) {
                                // 记录本项目
                                const notebook = item.notebook || item;
                                const paperCount = notebook.papers ? notebook.papers.length : 0;
                                contentContainer.innerHTML = `
                                    <div class="recycle-item-title">
                                        <span class="recycle-item-type notebook">记录本</span>
                                        ${notebook.title}
                                    </div>
                                    <div class="recycle-item-meta">${paperCount} 张记录纸</div>
                                    <div class="recycle-item-date">删除时间: ${item.deletedAt}</div>
                                `;
                            } else {
                                // 记录纸项目
                                const paper = item.paper || item;
                                contentContainer.innerHTML = `
                                    <div class="recycle-item-title">
                                        <span class="recycle-item-type paper">记录纸</span>
                                        ${paper.title}
                                    </div>
                                    <div class="recycle-item-date">删除时间: ${item.deletedAt}</div>
                                `;
                            }
                             
                            // 组织项目结构
                            recycleItem.appendChild(contentContainer);
                            recycleItem.appendChild(restoreButton);
                             
                            // 添加到列表顶部
                            recycleItems.insertBefore(recycleItem, recycleItems.firstChild);
                        });
                    });
                    recycleItems.appendChild(showAllBtn);
                }
                
                emptyRecycleBtn.disabled = false;
            }
        }
        
        // 显示设置模态框
        function showSettingsModal() {
            // 加载当前纸张的样式或使用默认样式
            const paper = getCurrentPaper();
            if (paper && paper.style) {
                currentStyle = { ...paper.style };
            }
            
            // 更新样式选项的选中状态
            lineStyleOptions.forEach(option => {
                option.classList.remove('selected');
                if (option.dataset.style === currentStyle.lineStyle) {
                    option.classList.add('selected');
                }
            });
            
            // 更新竖线条样式选项的选中状态
            columnBorderStyleOptions.forEach(option => {
                option.classList.remove('selected');
                if (option.dataset.style === currentStyle.columnBorderStyle) {
                    option.classList.add('selected');
                }
            });
            
            colorOptions.forEach(option => {
                option.classList.remove('selected');
                if (option.dataset.color === currentStyle.lineColor) {
                    option.classList.add('selected');
                }
            });
            
            bgOptions.forEach(option => {
                option.classList.remove('selected');
                if (option.dataset.bg === currentStyle.backgroundColor) {
                    option.classList.add('selected');
                }
            });

            // 更新背景图片选项的选中状态
            const bgImageOptions = document.querySelectorAll('.bg-image-option');
            bgImageOptions.forEach(option => {
                option.classList.remove('active');
                if (option.dataset.image === currentStyle.backgroundImage) {
                    option.classList.add('active');
                }
            });

            // 显示或隐藏背景图片预览
            const backgroundImagePreview = document.getElementById('background-image-preview');
            const previewImage = document.getElementById('preview-image');
            if (currentStyle.customBackgroundImage) {
                previewImage.src = currentStyle.customBackgroundImage;
                backgroundImagePreview.style.display = 'block';
            } else {
                backgroundImagePreview.style.display = 'none';
            }
            
            // 更新主题选项的选中状态
            const themeOptions = document.querySelectorAll('.theme-option');
            themeOptions.forEach(option => {
                option.classList.remove('selected');
                if (option.dataset.theme === getCurrentTheme()) {
                    option.classList.add('selected');
                }
            });

            // 更新字体选项的选中状态
            const fontOptions = document.querySelectorAll('.font-option');
            const currentPaper = getCurrentPaper();
            let currentFont = '';
            
            // 如果有当前记录纸，获取其字体设置
            if (currentPaper) {
                const paperId = currentPaper.id;
                const settings = JSON.parse(localStorage.getItem('paperSettings_' + paperId) || '{}');
                currentFont = settings.fontFamily || '';
            }
            
            // 应用选中状态
            fontOptions.forEach(option => {
                option.classList.remove('selected');
                if (option.dataset.font === currentFont) {
                    option.classList.add('selected');
                }
            });
            
            // 更新对齐选项的选中状态
            const alignmentOptions = document.querySelectorAll('.alignment-option');
            alignmentOptions.forEach(option => {
                option.classList.remove('selected');
                if (option.dataset.alignment === currentStyle.textAlignment) {
                    option.classList.add('selected');
                }
            });
            
            // 更新存储设置
            const savedStorageType = localStorage.getItem('threeGridStorageType') || 'local';
            const storageOptions = document.querySelectorAll('input[name="storage-type"]');
            storageOptions.forEach(option => {
                option.checked = option.value === savedStorageType;
            });
            
            // 更新存储路径显示
            const storagePathInput = document.getElementById('storage-path');
            const storagePathNote = document.getElementById('storage-path-note');
            
            if (storagePathInput && savedStorageType === 'local') {
                // 重要说明：由于浏览器的安全限制，JavaScript无法直接获取或显示浏览器存储数据的实际文件系统路径
                // 浏览器将localStorage数据存储在其私有数据目录中，不同浏览器和操作系统的存储位置各不相同
                
                // 检测浏览器类型
                let browserName = '未知浏览器';
                let detailedStorageLocation = '';
                
                // 根据浏览器类型和操作系统提供更具体的存储位置信息
                if (navigator.userAgent.indexOf('Chrome') !== -1) {
                    browserName = 'Chrome';
                    if (navigator.platform.indexOf('Win') !== -1) {
                        detailedStorageLocation = 'C:\\Users\\[用户名]\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local Storage';
                    } else if (navigator.platform.indexOf('Mac') !== -1) {
                        detailedStorageLocation = '~/Library/Application Support/Google/Chrome/Default/Local Storage';
                    } else if (navigator.platform.indexOf('Linux') !== -1) {
                        detailedStorageLocation = '~/.config/google-chrome/Default/Local Storage';
                    }
                } else if (navigator.userAgent.indexOf('Firefox') !== -1) {
                    browserName = 'Firefox';
                    if (navigator.platform.indexOf('Win') !== -1) {
                        detailedStorageLocation = 'C:\\Users\\[用户名]\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\[配置文件]\\storage\\default';
                    } else if (navigator.platform.indexOf('Mac') !== -1) {
                        detailedStorageLocation = '~/Library/Application Support/Firefox/Profiles/[配置文件]/storage/default';
                    } else if (navigator.platform.indexOf('Linux') !== -1) {
                        detailedStorageLocation = '~/.mozilla/firefox/[配置文件]/storage/default';
                    }
                } else if (navigator.userAgent.indexOf('Safari') !== -1) {
                    browserName = 'Safari';
                    detailedStorageLocation = '~/Library/Safari/LocalStorage';
                } else if (navigator.userAgent.indexOf('Edge') !== -1) {
                    browserName = 'Edge';
                    if (navigator.platform.indexOf('Win') !== -1) {
                        detailedStorageLocation = 'C:\\Users\\[用户名]\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Local Storage';
                    } else if (navigator.platform.indexOf('Mac') !== -1) {
                        detailedStorageLocation = '~/Library/Application Support/Microsoft Edge/Default/Local Storage';
                    }
                }
                
                // 计算localStorage已使用空间（近似值）
                let usedSpace = 0;
                for (let key in localStorage) {
                    if (localStorage.hasOwnProperty(key)) {
                        usedSpace += key.length + localStorage.getItem(key).length;
                    }
                }
                usedSpace = Math.round(usedSpace / 1024); // 转换为KB
                
                // 显示浏览器存储类型，而不是硬编码的路径
                storagePathInput.value = `${browserName}浏览器localStorage`;
                
                // 添加详细说明文字，解释浏览器存储的实际情况
                if (!storagePathNote) {
                    const noteElement = document.createElement('p');
                    noteElement.id = 'storage-path-note';
                    noteElement.style.fontSize = '0.8rem';
                    noteElement.style.color = 'var(--text-secondary)';
                    noteElement.style.marginTop = '4px';
                    noteElement.style.marginBottom = '0';
                    noteElement.innerHTML = `实际存储位置: ${detailedStorageLocation}<br>已使用空间: 约${usedSpace}KB<br><small style="color: #666;">* [用户名]和[配置文件]需要替换为您的实际信息</small>`;
                    storagePathInput.parentNode.parentNode.appendChild(noteElement);
                } else {
                    storagePathNote.innerHTML = `实际存储位置: ${detailedStorageLocation}<br>已使用空间: 约${usedSpace}KB<br><small style="color: #666;">* [用户名]和[配置文件]需要替换为您的实际信息</small>`;
                }
            }
            
            // 检查是否为移动设备竖屏模式的函数
            function isMobilePortrait() {
                return window.innerWidth < 768 && window.innerHeight > window.innerWidth;
            }
            
            // 添加背景图片选项的点击事件处理逻辑
            bgImageOptions.forEach(option => {
                // 移除之前的事件监听器，避免重复添加
                const newOption = option.cloneNode(true);
                option.parentNode.replaceChild(newOption, option);
                
                // 添加新的事件监听器
                newOption.addEventListener('click', function(e) {
                    const bgType = this.dataset.image;
                    // 检查是否为移动设备竖屏模式，且用户尝试选择横线纸或网格纸
                    if (isMobilePortrait() && (bgType === 'lined' || bgType === 'grid')) {
                        e.preventDefault();
                        e.stopPropagation();
                        showToast('移动端竖屏模式禁用此背景');
                        return;
                    }
                    
                    // 正常的选择逻辑 - 使用this.parentNode.querySelectorAll获取当前所有的背景图片选项
                    this.parentNode.querySelectorAll('.bg-image-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    this.classList.add('active');
                    currentStyle.backgroundImage = bgType;
                    
                    // 隐藏自定义背景图片预览
                    if (backgroundImagePreview) {
                        backgroundImagePreview.style.display = 'none';
                    }
                    if (previewImage) {
                        previewImage.src = '';
                    }
                });
            });
            
            // 根据设备类型设置不同的弹窗最大高度
            const modalContent = document.querySelector('#settings-modal .modal-content');
            if (isMobilePortrait()) {
                // 移动设备竖屏 - 更小的高度以确保最佳显示效果
                modalContent.style.maxHeight = '75vh';
            } else if (isMobile()) {
                // 移动设备横屏 - 中等高度
                modalContent.style.maxHeight = '80vh';
            } else {
                // PC设备 - 保持较大高度
                modalContent.style.maxHeight = '85vh';
            }

            // 为字号设置按钮添加事件监听器
            const applyFontSizeCurrentBtn = document.getElementById('apply-font-size-current');
            const applyFontSizeAllBtn = document.getElementById('apply-font-size-all');
            const fontSizeSelect = document.getElementById('font-size-select');
            
            if (applyFontSizeCurrentBtn) {
                // 移除之前的事件监听器，避免重复添加
                const newApplyFontSizeCurrentBtn = applyFontSizeCurrentBtn.cloneNode(true);
                applyFontSizeCurrentBtn.parentNode.replaceChild(newApplyFontSizeCurrentBtn, applyFontSizeCurrentBtn);
                
                // 添加新的事件监听器
                newApplyFontSizeCurrentBtn.addEventListener('click', function() {
                    const fontSize = fontSizeSelect.value;
                    const currentPaper = getCurrentPaper();
                    if (currentPaper) {
                        applyFontSizeToPaper(currentPaper, fontSize);
                        showToast('字号已应用到当前记录纸');
                    } else {
                        showToast('请先选择一张记录纸');
                    }
                });
            }
            
            if (applyFontSizeAllBtn) {
                // 移除之前的事件监听器，避免重复添加
                const newApplyFontSizeAllBtn = applyFontSizeAllBtn.cloneNode(true);
                applyFontSizeAllBtn.parentNode.replaceChild(newApplyFontSizeAllBtn, applyFontSizeAllBtn);
                
                // 添加新的事件监听器
                newApplyFontSizeAllBtn.addEventListener('click', function() {
                    const fontSize = fontSizeSelect.value;
                    applyFontSizeToAllPapers(fontSize);
                    showToast('字号已应用到所有记录纸');
                });
            }
            
            // 为字体设置按钮添加事件监听器
            const applyFontCurrentBtn = document.getElementById('apply-font-current');
            const applyFontAllBtn = document.getElementById('apply-font-all');
            
            if (applyFontCurrentBtn) {
                // 移除之前的事件监听器，避免重复添加
                const newApplyFontCurrentBtn = applyFontCurrentBtn.cloneNode(true);
                applyFontCurrentBtn.parentNode.replaceChild(newApplyFontCurrentBtn, applyFontCurrentBtn);
                
                // 添加新的事件监听器
                newApplyFontCurrentBtn.addEventListener('click', function() {
                    const selectedFontOption = document.querySelector('.font-option.selected');
                    if (selectedFontOption) {
                        const font = selectedFontOption.dataset.font;
                        const currentPaper = getCurrentPaper();
                        if (currentPaper) {
                            applyFontToPaper(currentPaper, font);
                            showToast('字体已应用到当前记录纸');
                        } else {
                            showToast('请先选择一张记录纸');
                        }
                    }
                });
            }
            
            if (applyFontAllBtn) {
                // 移除之前的事件监听器，避免重复添加
                const newApplyFontAllBtn = applyFontAllBtn.cloneNode(true);
                applyFontAllBtn.parentNode.replaceChild(newApplyFontAllBtn, applyFontAllBtn);
                
                // 添加新的事件监听器
                newApplyFontAllBtn.addEventListener('click', function() {
                    const selectedFontOption = document.querySelector('.font-option.selected');
                    if (selectedFontOption) {
                        const font = selectedFontOption.dataset.font;
                        applyFontToAllPapers(font);
                        showToast('字体已应用到所有记录纸');
                    }
                });
            }
            
            // 为字体选项添加点击事件
            fontOptions.forEach(option => {
                // 移除之前的事件监听器，避免重复添加
                const newOption = option.cloneNode(true);
                option.parentNode.replaceChild(newOption, option);
                
                // 添加新的事件监听器
                newOption.addEventListener('click', function() {
                    fontOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
            
            // 显示模态框
            settingsModal.style.display = 'flex';
        }
        
        // 初始化对齐方式应用按钮
        function initAlignmentApplyButtons() {
            const applyToCurrentBtn = document.getElementById('apply-to-current-paper');
            const applyToAllBtn = document.getElementById('apply-to-all-papers');
            
            if (applyToCurrentBtn && applyToAllBtn) {
                applyToCurrentBtn.addEventListener('click', function() {
                    applyAlignmentToCurrentPaper();
                });
                
                applyToAllBtn.addEventListener('click', function() {
                    applyAlignmentToAllPapers();
                });
            }
        }
        
        // 应用对齐方式到当前记录纸
        function applyAlignmentToCurrentPaper() {
            const paper = getCurrentPaper();
            const selectedAlignment = document.querySelector('.alignment-option.selected');
            
            if (paper && selectedAlignment) {
                paper.style = paper.style || {};
                paper.style.textAlignment = selectedAlignment.dataset.alignment;
                
                // 保存数据
                debouncedSaveToLocalStorage();
                
                // 更新UI
                renderPapers();
                
                // 显示提示
                showToast(`已将当前记录纸文本设置为${selectedAlignment.dataset.label}`);
            }
        }
        
        // 应用对齐方式到所有记录纸
        function applyAlignmentToAllPapers() {
            const selectedAlignment = document.querySelector('.alignment-option.selected');
            
            if (selectedAlignment) {
                const alignment = selectedAlignment.dataset.alignment;
                const alignmentLabel = selectedAlignment.dataset.label;
                
                // 应用到所有笔记本的所有记录纸
                notebooks.forEach(notebook => {
                    notebook.papers.forEach(paper => {
                        paper.style = paper.style || {};
                        paper.style.textAlignment = alignment;
                    });
                });
                
                // 保存数据
                debouncedSaveToLocalStorage();
                
                // 更新UI
                renderPapers();
                
                // 显示提示
                showToast(`已将所有记录纸文本设置为${alignmentLabel}`);
            }
        }
        
        // 应用设置
        function applySettings() {
            const paper = getCurrentPaper();
            
            // 保存记录纸样式设置
            if (paper) {
                paper.style = { ...currentStyle };
                
                // 处理背景图片设置
            const backgroundImagePreview = document.getElementById('background-image-preview');
            const previewImage = document.getElementById('preview-image');
            const selectedBgOption = document.querySelector('.bg-image-option.active');
                
                // 检查是否有自定义背景图片
                if (backgroundImagePreview && backgroundImagePreview.style.display === 'block' && previewImage && previewImage.src) {
                    paper.style.backgroundImage = null; // 清除预设背景
                    paper.style.customBackgroundImage = previewImage.src; // 设置自定义背景图片
                } else if (selectedBgOption) {
                    // 使用预设背景或无背景
                    const bgType = selectedBgOption.dataset.image;
                    paper.style.backgroundImage = bgType === 'none' ? null : bgType;
                    paper.style.customBackgroundImage = null; // 清除自定义背景
                }
            }
            
            // 保存主题设置
            saveTheme();
            
            // 检查选择的主题并显示相应提示
            const selectedTheme = document.querySelector('.theme-option.selected')?.dataset.theme || 'default';
            if (selectedTheme === 'dark') {
                showToast('暗黑主题并不会改变或覆盖已使用的背景图');
            } else if (selectedTheme === 'pastel') {
                showToast('柔和主题并不会改变或覆盖已使用的背景图');
            } else if (selectedTheme === 'vibrant') {
                showToast('鲜艳主题并不会改变或覆盖已使用的背景图');
            }
            
            // 保存存储设置
            const selectedStorageType = document.querySelector('input[name="storage-type"]:checked')?.value || 'local';
            localStorage.setItem('threeGridStorageType', selectedStorageType);
            
            // 保存数据
            saveToLocalStorage();
            
            // 更新UI
            renderPapers();
            applyThemeToUI();
            
            // 显示对齐设置提示
            const selectedAlignmentOption = document.querySelector('.alignment-option.selected');
            if (selectedAlignmentOption && currentStyle.textAlignment) {
                showToast(`文本已设置为${selectedAlignmentOption.dataset.label}`);
            }
            
            // 关闭设置模态框
            settingsModal.style.display = 'none';
        }
        
        // 获取当前主题
        function getCurrentTheme() {
            return localStorage.getItem('threeGridTheme') || 'default';
        }
        
        // 保存主题
        function saveTheme() {
            const selectedTheme = document.querySelector('.theme-option.selected')?.dataset.theme || 'default';
            localStorage.setItem('threeGridTheme', selectedTheme);
        }
        
        // 应用主题到UI
        function applyThemeToUI() {
            const theme = getCurrentTheme();
            const root = document.documentElement;
            
            // 移除所有主题类
            root.classList.remove('theme-default', 'theme-dark', 'theme-pastel', 'theme-vibrant');
            
            // 添加当前主题类
            root.classList.add(`theme-${theme}`);
            
            // 获取所有需要更新颜色的元素
            const textElements = document.querySelectorAll('h1, h2, h3, h4, h5, h6, p, span, a, li, td, th, label');
            const inputElements = document.querySelectorAll('input, textarea, select');
            const sidebarElements = document.querySelectorAll('.sidebar, .notebook-item, .paper-item');
            const headerElements = document.querySelectorAll('.header, .menu-btn, .search-btn');
            
            // 根据主题设置不同的颜色变量
            if (theme === 'dark') {
                // 暗黑主题
                root.style.setProperty('--primary-color', '#4a5568');
                root.style.setProperty('--secondary-color', '#2d3748');
                root.style.setProperty('--text-color', '#e2e8f0');
                root.style.setProperty('--bg-color', '#1a202c');
                document.body.style.backgroundColor = '#1a202c';
                document.body.style.color = '#e2e8f0';
                
                // 重置元素样式，确保输入元素背景透明
                resetElementStyles(textElements, inputElements, sidebarElements, headerElements);
                
                // 更新所有文本元素颜色
                textElements.forEach(el => {
                    el.style.color = '#e2e8f0';
                });
                
                // 在暗黑主题下，特别加深span元素的文字颜色
                const spanElements = document.querySelectorAll('span');
                spanElements.forEach(span => {
                    span.style.color = '#a0aec0';
                });
                
                // 更新输入元素的颜色和边框，但保持背景透明
                inputElements.forEach(el => {
                    if (el.tagName === 'TEXTAREA') {
                        // 暗黑主题下的输入区textarea文字颜色改为带10%金色的薄荷绿
                        el.style.color = '#b8e6cf';
                    } else {
                        el.style.color = '#e2e8f0';
                    }
                    el.style.borderColor = '#4a5568';
                });
                
                // 更新记录纸的行线条颜色为浅灰
                const gridLines = document.querySelectorAll('.grid-line');
                gridLines.forEach(line => {
                    line.style.setProperty('--grid-line-color', '#718096'); // 浅灰色
                    line.style.borderBottomColor = '#718096'; // 浅灰色
                });
                
                // 更新记录纸的竖线条颜色为浅灰
                const columns = document.querySelectorAll('.column');
                columns.forEach(col => {
                    col.style.setProperty('--column-border-color', '#718096'); // 浅灰色
                });
                
                // 更新侧边栏
                sidebarElements.forEach(el => {
                    el.style.backgroundColor = '#2d3748';
                });
                
                // 更新头部 - 暗黑主题专用背景
                headerElements.forEach(el => {
                    el.style.background = 'linear-gradient(135deg, #4a5568, #2d3748)';
                    el.style.color = '#ffffff';
                });
                
                // 更新笔记本列表h3标题 - 添加黑色遮罩
                const notebookListHeaders = document.querySelectorAll('.notebook-list h3');
                notebookListHeaders.forEach(h3 => {
                    h3.style.background = 'rgba(0, 0, 0, 0.3)';
                    h3.style.padding = '10px 15px';
                    h3.style.borderRadius = 'var(--radius-small)';
                });
                
                // 更新所有记录纸背景 - 暗黑主题专用（直接设置背景色，不使用覆盖层）
                const papers = document.querySelectorAll('.paper');
                papers.forEach(paper => {
                    // 移除可能存在的覆盖层
                    const existingOverlay = paper.querySelector('.theme-overlay');
                    if (existingOverlay) {
                        paper.removeChild(existingOverlay);
                    }
                    
                    // 直接设置记录纸的背景色，确保线条和内容清晰可见
                    paper.style.backgroundColor = '#2d3748'; // 暗黑主题的记录纸背景色
                    
                    // 确保记录纸内容元素清晰可见
                    const contentElements = paper.querySelectorAll('.cell-input, .paper-content, .editable-content, .paper-header, .paper-title, button');
                    contentElements.forEach(el => {
                        // 如果是textarea元素，保持之前设置的特殊颜色(#b8e6cf)
                        if (el.tagName !== 'TEXTAREA' && (el.classList.contains('cell-input') || el.classList.contains('paper-content') || el.classList.contains('editable-content'))) {
                            el.style.color = '#e2e8f0'; // 浅色文字确保在深色背景上的可读性
                        }
                    });
                });
            } else if (theme === 'pastel') {
                // 柔和主题
                root.style.setProperty('--primary-color', '#ff9e9e');
                root.style.setProperty('--secondary-color', '#ffd9c0');
                root.style.setProperty('--text-color', '#6b7280');
                root.style.setProperty('--bg-color', '#ffffff');
                document.body.style.backgroundColor = '#ffffff';
                document.body.style.color = '#6b7280';
                
                // 重置元素样式
                resetElementStyles(textElements, inputElements, sidebarElements, headerElements);
                
                // 更新头部 - 柔和主题专用背景
                headerElements.forEach(el => {
                    el.style.background = 'linear-gradient(135deg, #ff9e9e, #ffd9c0)';
                    el.style.color = '#6b7280';
                });
                
                // 更新笔记本列表h3标题 - 柔和主题专用
                const notebookListHeaders = document.querySelectorAll('.notebook-list h3');
                notebookListHeaders.forEach(h3 => {
                    // 使用柔和的浅粉色背景，与柔和主题协调
                    h3.style.background = '#ffedec';
                    h3.style.padding = '10px 15px';
                    h3.style.borderRadius = 'var(--radius-small)';
                    h3.style.color = '#6b7280'; // 深灰色文字，确保可读性
                });
                
                // 应用到本记录纸和应用到全部按钮的样式已在updateUIElementsStyles函数中统一处理
                
                // 更新所有记录纸背景 - 柔和主题专用（直接设置背景色，不使用覆盖层）
                const papers = document.querySelectorAll('.paper');
                papers.forEach(paper => {
                    // 移除可能存在的覆盖层
                    const existingOverlay = paper.querySelector('.theme-overlay');
                    if (existingOverlay) {
                        paper.removeChild(existingOverlay);
                    }
                    
                    // 直接设置记录纸的背景色，确保线条和内容清晰可见
                    paper.style.backgroundColor = '#fff7e6'; // 柔和主题的记录纸背景色
                    
                    // 确保记录纸内容元素清晰可见
                    const contentElements = paper.querySelectorAll('.cell-input, .paper-content, .editable-content, .paper-header, .paper-title, button');
                    contentElements.forEach(el => {
                        if (el.classList.contains('cell-input') || el.classList.contains('paper-content') || el.classList.contains('editable-content')) {
                            el.style.color = '#6b7280'; // 深色文字确保在浅色背景上的可读性
                        }
                    });
                });
            } else if (theme === 'vibrant') {
                // 鲜艳主题 - 修复为真正鲜艳的配色方案
                root.style.setProperty('--primary-color', '#ff4d4d'); // 鲜艳红色作为主色调
                root.style.setProperty('--secondary-color', '#4d79ff'); // 鲜艳蓝色作为辅助色
                root.style.setProperty('--text-color', '#333333'); // 深色文字确保可读性
                root.style.setProperty('--bg-color', '#ffffff'); // 白色背景
                document.body.style.backgroundColor = '#ffffff';
                document.body.style.color = '#333333';
                
                // 重置元素样式，确保输入元素背景透明
                resetElementStyles(textElements, inputElements, sidebarElements, headerElements);
                
                // 更新所有文本元素颜色为深色，确保可读性
                textElements.forEach(el => {
                    el.style.color = '#333333';
                });
                
                // 更新输入元素的边框颜色，但保持背景透明
                inputElements.forEach(el => {
                    el.style.borderColor = '#ff4d4d'; // 使用鲜艳红色作为边框
                });
                
                // 更新侧边栏 - 使用浅灰色背景
                sidebarElements.forEach(el => {
                    el.style.backgroundColor = '#f9f9f9';
                });
                
                // 更新头部 - 鲜艳主题专用背景
                headerElements.forEach(el => {
                    el.style.background = 'linear-gradient(135deg, #ff4d4d, #4d79ff)';
                    el.style.color = '#ffffff'; // 头部文字保持白色以配合渐变色
                });
                
                // 更新笔记本列表h3标题 - 鲜艳主题专用
                const notebookListHeaders = document.querySelectorAll('.notebook-list h3');
                notebookListHeaders.forEach(h3 => {
                    // 使用鲜艳的浅蓝色背景，与鲜艳主题协调
                    h3.style.background = '#e6f3ff';
                    h3.style.padding = '10px 15px';
                    h3.style.borderRadius = 'var(--radius-small)';
                    h3.style.color = '#333333'; // 深灰色文字，确保可读性
                });
                
                // 应用到本记录纸和应用到全部按钮的样式已在updateUIElementsStyles函数中统一处理
                
                // 更新所有记录纸背景 - 鲜艳主题专用（直接设置背景色，不使用覆盖层）
                const papers = document.querySelectorAll('.paper');
                papers.forEach(paper => {
                    // 移除可能存在的覆盖层
                    const existingOverlay = paper.querySelector('.theme-overlay');
                    if (existingOverlay) {
                        paper.removeChild(existingOverlay);
                    }
                    
                    // 直接设置记录纸的背景色，确保线条和内容清晰可见
                    paper.style.backgroundColor = '#90caf9'; // 鲜艳主题的记录纸背景色（鲜艳亮蓝色，避免使用黄色）
                    
                    // 直接设置记录纸的行线条颜色为纯白色（鲜艳主题专用）
                    const gridLines = paper.querySelectorAll('.grid-line');
                    gridLines.forEach(line => {
                        line.style.setProperty('--grid-line-color', '#FFFFFF'); // 纯白色
                        line.style.borderBottomColor = '#FFFFFF'; // 纯白色
                    });
                    
                    // 直接设置记录纸的竖线条颜色为纯白色（鲜艳主题专用）
                    const columns = paper.querySelectorAll('.column');
                    columns.forEach(col => {
                        col.style.setProperty('--column-border-color', '#FFFFFF'); // 纯白色
                    });
                    
                    // 确保记录纸内容元素清晰可见
                    const contentElements = paper.querySelectorAll('.cell-input, .paper-content, .editable-content, .paper-header, .paper-title, button');
                    contentElements.forEach(el => {
                        if (el.classList.contains('cell-input') || el.classList.contains('paper-content') || el.classList.contains('editable-content')) {
                            el.style.color = '#333333'; // 深色文字确保在浅色背景上的可读性
                        }
                    });
                });
            } else {
                // 默认主题
                root.style.removeProperty('--primary-color');
                root.style.removeProperty('--secondary-color');
                root.style.removeProperty('--text-color');
                root.style.removeProperty('--bg-color');
                document.body.style.backgroundColor = '';
                document.body.style.color = '';
                
                // 重置元素样式
                resetElementStyles(textElements, inputElements, sidebarElements, headerElements);
                
                // 更新头部 - 默认主题专用背景
                headerElements.forEach(el => {
                    el.style.background = 'linear-gradient(135deg, #f3f4f6, #e5e7eb)';
                    el.style.color = '#333333';
                });
                
                // 更新笔记本列表h3标题 - 默认主题专用
                const notebookListHeaders = document.querySelectorAll('.notebook-list h3');
                notebookListHeaders.forEach(h3 => {
                    // 设置为白色背景
                    h3.style.background = '#ffffff';
                    h3.style.padding = '10px 15px';
                    h3.style.borderRadius = 'var(--radius-small)';
                    h3.style.color = '#333333'; // 深灰色文字，确保可读性
                });
                
                // 在默认主题下，恢复用户自定义的记录纸背景
                const papers = document.querySelectorAll('.paper');
                papers.forEach(paper => {
                    // 移除主题覆盖层
                    const existingOverlay = paper.querySelector('.theme-overlay');
                    if (existingOverlay) {
                        paper.removeChild(existingOverlay);
                    }
                    
                    // 获取paperId
                    const paperId = paper.dataset.paperId;
                    if (paperId) {
                        // 获取记录纸的设置
                        const settings = JSON.parse(localStorage.getItem('paperSettings_' + paperId) || '{}');
                        // 如果有自定义背景颜色，应用它；否则移除内联样式，使用CSS默认值
                        if (settings.backgroundColor) {
                            paper.style.backgroundColor = settings.backgroundColor;
                        } else {
                            paper.style.removeProperty('background-color');
                        }
                    }
                });
            }
            
            // 更新控制栏按钮和其他UI元素的样式
            updateUIElementsStyles();
        }
        
        // 重置元素样式
        function resetElementStyles(textElements, inputElements, sidebarElements, headerElements) {
            // 重置文本元素
            textElements.forEach(el => {
                el.style.removeProperty('color');
            });
            
            // 重置输入元素
            inputElements.forEach(el => {
                el.style.removeProperty('background-color');
                el.style.removeProperty('color');
                el.style.removeProperty('border-color');
            });
            
            // 重置侧边栏
            sidebarElements.forEach(el => {
                el.style.removeProperty('background-color');
            });
            
            // 重置头部
            headerElements.forEach(el => {
                el.style.removeProperty('background-color');
                el.style.removeProperty('background');
                el.style.removeProperty('color');
            });
            
            // 重置记录纸的行线条样式
            const gridLines = document.querySelectorAll('.grid-line');
            gridLines.forEach(line => {
                line.style.removeProperty('--grid-line-color');
                line.style.removeProperty('border-bottom-color');
            });
            
            // 重置记录纸的竖线条样式
            const columns = document.querySelectorAll('.column');
            columns.forEach(col => {
                col.style.removeProperty('--column-border-color');
            });
        }
        
        // 应用行线条样式到指定记录纸
        function applyLineStyleToPaper(paperData, lineStyle) {
            if (!paperData || !lineStyle) return;
            
            // 确定paperId - 检查传入的是数据对象还是DOM元素
            let paperId;
            if (paperData.id) {
                // 如果传入的是数据对象
                paperId = paperData.id;
            } else if (paperData.dataset && paperData.dataset.paperId) {
                // 如果传入的是DOM元素，从data-paper-id属性获取
                paperId = paperData.dataset.paperId;
            } else {
                return;
            }
            
            // 查找对应的DOM元素
            const paperElement = document.querySelector(`.paper[data-paper-id="${paperId}"]`);
            if (!paperElement) return;
            
            // 设置data-line-style属性，供重新渲染时使用
            paperElement.setAttribute('data-line-style', lineStyle);
            
            // 获取所有网格行
            const gridLines = paperElement.querySelectorAll('.grid-line');
            
            // 应用行线条样式
            gridLines.forEach(line => {
                line.style.borderBottomStyle = lineStyle;
            });
            
            // 保存到本地存储
            const settings = JSON.parse(localStorage.getItem('paperSettings_' + paperId) || '{}');
            settings.lineStyle = lineStyle;
            localStorage.setItem('paperSettings_' + paperId, JSON.stringify(settings));
        }
        
        // 应用行线条样式到所有记录纸
        function applyLineStyleToAllPapers(lineStyle) {
            if (!lineStyle) return;
            
            // 获取所有记录纸
            const allPapers = document.querySelectorAll('.paper');
            
            allPapers.forEach(paper => {
                applyLineStyleToPaper(paper, lineStyle);
            });
        }
        
        // 应用竖线条样式到指定记录纸
        function applyColumnStyleToPaper(paperData, columnStyle) {
            if (!paperData || !columnStyle) return;
            
            // 确定paperId - 检查传入的是数据对象还是DOM元素
            let paperId;
            if (paperData.id) {
                // 如果传入的是数据对象
                paperId = paperData.id;
            } else if (paperData.dataset && paperData.dataset.paperId) {
                // 如果传入的是DOM元素，从data-paper-id属性获取
                paperId = paperData.dataset.paperId;
            } else {
                return;
            }
            
            // 查找对应的DOM元素
            const paperElement = document.querySelector(`.paper[data-paper-id="${paperId}"]`);
            if (!paperElement) return;
            
            // 设置data-column-style属性，供重新渲染时使用
            paperElement.setAttribute('data-column-style', columnStyle);
            
            // 获取所有列
            const columns = paperElement.querySelectorAll('.column');
            
            // 应用竖线条样式
            columns.forEach(col => {
                col.style.borderRightStyle = columnStyle;
            });
            
            // 保存到本地存储
            const settings = JSON.parse(localStorage.getItem('paperSettings_' + paperId) || '{}');
            settings.columnStyle = columnStyle;
            localStorage.setItem('paperSettings_' + paperId, JSON.stringify(settings));
        }
        
        // 应用竖线条样式到所有记录纸
        function applyColumnStyleToAllPapers(columnStyle) {
            if (!columnStyle) return;
            
            // 获取所有记录纸
            const allPapers = document.querySelectorAll('.paper');
            
            allPapers.forEach(paper => {
                applyColumnStyleToPaper(paper, columnStyle);
            });
        }
        
        // 应用线条颜色到指定记录纸
        function applyLineColorToPaper(paperData, lineColor) {
            if (!paperData || !lineColor) return;
            
            // 确定paperId - 检查传入的是数据对象还是DOM元素
            let paperId;
            if (paperData.id) {
                // 如果传入的是数据对象
                paperId = paperData.id;
            } else if (paperData.dataset && paperData.dataset.paperId) {
                // 如果传入的是DOM元素，从data-paper-id属性获取
                paperId = paperData.dataset.paperId;
            } else {
                return;
            }
            
            // 查找对应的DOM元素
            const paperElement = document.querySelector(`.paper[data-paper-id="${paperId}"]`);
            if (!paperElement) return;
            
            // 设置data-line-color属性，供重新渲染时使用
            paperElement.setAttribute('data-line-color', lineColor);
            
            // 获取所有网格行和列
            const gridLines = paperElement.querySelectorAll('.grid-line');
            const columns = paperElement.querySelectorAll('.column');
            
            // 应用线条颜色到行
            gridLines.forEach(line => {
                line.style.borderBottomColor = lineColor;
            });
            
            // 应用线条颜色到列
            columns.forEach(col => {
                col.style.borderRightColor = lineColor;
            });
            
            // 保存到本地存储
            const settings = JSON.parse(localStorage.getItem('paperSettings_' + paperId) || '{}');
            settings.lineColor = lineColor;
            localStorage.setItem('paperSettings_' + paperId, JSON.stringify(settings));
        }
        
        // 应用线条颜色到所有记录纸
        function applyLineColorToAllPapers(lineColor) {
            if (!lineColor) return;
            
            // 获取所有记录纸
            const allPapers = document.querySelectorAll('.paper');
            
            allPapers.forEach(paper => {
                applyLineColorToPaper(paper, lineColor);
            });
        }
        
        // 应用背景颜色到指定记录纸
        function applyBgColorToPaper(paperData, bgColor) {
            if (!paperData || !bgColor) return;
            
            // 确定paperId - 检查传入的是数据对象还是DOM元素
            let paperId;
            if (paperData.id) {
                // 如果传入的是数据对象
                paperId = paperData.id;
            } else if (paperData.dataset && paperData.dataset.paperId) {
                // 如果传入的是DOM元素，从data-paper-id属性获取
                paperId = paperData.dataset.paperId;
            } else {
                return;
            }
            
            // 查找对应的DOM元素
            const paperElement = document.querySelector(`.paper[data-paper-id="${paperId}"]`);
            if (!paperElement) return;
            
            // 应用背景颜色
            paperElement.style.backgroundColor = bgColor;
            
            // 保存到本地存储
            const settings = JSON.parse(localStorage.getItem('paperSettings_' + paperId) || '{}');
            settings.backgroundColor = bgColor;
            localStorage.setItem('paperSettings_' + paperId, JSON.stringify(settings));
            
            // 同时更新notebooks数据结构中的背景颜色
            const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
            if (currentNotebook) {
                const paper = currentNotebook.papers.find(p => p.id === paperId);
                if (paper) {
                    if (!paper.style) {
                        paper.style = {};
                    }
                    paper.style.backgroundColor = bgColor;
                    currentNotebook.updatedAt = new Date().toISOString();
                    debouncedSaveToLocalStorage();
                }
            }
        }
        
        // 应用背景颜色到所有记录纸
        function applyBgColorToAllPapers(bgColor) {
            if (!bgColor) return;
            
            // 获取所有记录纸
            const allPapers = document.querySelectorAll('.paper');
            
            allPapers.forEach(paper => {
                applyBgColorToPaper(paper, bgColor);
            });
        }
        
        // 应用文字颜色到指定记录纸
        function applyTextColorToPaper(paperData, textColor) {
            if (!paperData || !textColor) return;
            
            // 确定paperId - 检查传入的是数据对象还是DOM元素
            let paperId;
            if (paperData.id) {
                // 如果传入的是数据对象
                paperId = paperData.id;
            } else if (paperData.dataset && paperData.dataset.paperId) {
                // 如果传入的是DOM元素，从data-paper-id属性获取
                paperId = paperData.dataset.paperId;
            } else {
                return;
            }
            
            // 查找对应的DOM元素
            const paperElement = document.querySelector(`.paper[data-paper-id="${paperId}"]`);
            if (!paperElement) return;
            
            // 设置data-text-color属性，供重新渲染时使用
            paperElement.setAttribute('data-text-color', textColor);
            
            // 获取所有单元格输入框和内容区域
            const inputElements = paperElement.querySelectorAll('.cell-input');
            const contentAreas = paperElement.querySelectorAll('.paper-content, .editable-content');
            
            // 应用文字颜色到输入框
            inputElements.forEach(input => {
                input.style.color = textColor;
            });
            
            // 应用文字颜色到其他内容区域
            contentAreas.forEach(area => {
                area.style.color = textColor;
            });
            
            // 保存到本地存储
            const settings = JSON.parse(localStorage.getItem('paperSettings_' + paperId) || '{}');
            settings.textColor = textColor;
            localStorage.setItem('paperSettings_' + paperId, JSON.stringify(settings));
            console.log('Saved textColor to localStorage:', textColor);
        }
        
        // 应用文字颜色到所有记录纸
        function applyTextColorToAllPapers(textColor) {
            if (!textColor) return;
            
            // 保存当前的线条样式设置，防止在重新渲染时被全局应用
            const tempLineStyle = currentStyle.lineStyle;
            const tempColumnBorderStyle = currentStyle.columnBorderStyle;
            
            // 获取所有记录纸
            const allPapers = document.querySelectorAll('.paper');
            
            allPapers.forEach(paper => {
                applyTextColorToPaper(paper, textColor);
            });
            
            // 恢复原始的线条样式设置
            currentStyle.lineStyle = tempLineStyle;
            currentStyle.columnBorderStyle = tempColumnBorderStyle;
        }
        
        // 应用字体到指定记录纸
        function applyFontToPaper(paperData, font) {
            if (!paperData || !font) return;
            
            // 确定paperId - 检查传入的是数据对象还是DOM元素
            let paperId;
            if (paperData.id) {
                // 如果传入的是数据对象
                paperId = paperData.id;
            } else if (paperData.dataset && paperData.dataset.paperId) {
                // 如果传入的是DOM元素，从data-paper-id属性获取
                paperId = paperData.dataset.paperId;
            } else {
                // 没有有效的paperData，提示用户
                alert('请先选择一个记录纸');
                return;
            }
            
            // 查找对应的DOM元素
            const paperElement = document.querySelector(`.paper[data-paper-id="${paperId}"]`);
            if (!paperElement) {
                // 找不到记录纸元素，提示用户
                alert('请先选择一个记录纸');
                return;
            }
            
            // 设置data-font属性，供重新渲染时使用
            paperElement.setAttribute('data-font', font);
            
            // 获取所有单元格输入框和内容区域
            const inputElements = paperElement.querySelectorAll('.cell-input');
            const contentAreas = paperElement.querySelectorAll('.paper-content, .editable-content');
            
            // 应用字体到输入框
            inputElements.forEach(input => {
                input.style.fontFamily = font;
            });
            
            // 应用字体到其他内容区域
            contentAreas.forEach(area => {
                area.style.fontFamily = font;
            });
            
            // 保存到本地存储
            const settings = JSON.parse(localStorage.getItem('paperSettings_' + paperId) || '{}');
            settings.font = font;
            localStorage.setItem('paperSettings_' + paperId, JSON.stringify(settings));
        }
        
        // 应用字体到所有记录纸
        function applyFontToAllPapers(font) {
            if (!font) return;
            
            // 获取所有记录纸
            const allPapers = document.querySelectorAll('.paper');
            
            allPapers.forEach(paper => {
                applyFontToPaper(paper, font);
            });
        }
        
        // 应用字号到指定记录纸
        function applyFontSizeToPaper(paperData, fontSize) {
            if (!paperData || !fontSize) return;
            
            // 确定paperId - 检查传入的是数据对象还是DOM元素
            let paperId;
            if (paperData.id) {
                // 如果传入的是数据对象
                paperId = paperData.id;
            } else if (paperData.dataset && paperData.dataset.paperId) {
                // 如果传入的是DOM元素，从data-paper-id属性获取
                paperId = paperData.dataset.paperId;
            } else {
                // 没有有效的paperData，提示用户
                alert('请先选择一个记录纸');
                return;
            }
            
            // 查找对应的DOM元素
            const paperElement = document.querySelector(`.paper[data-paper-id="${paperId}"]`);
            if (!paperElement) {
                // 找不到记录纸元素，提示用户
                alert('请先选择一个记录纸');
                return;
            }
            
            // 设置data-font-size属性，供重新渲染时使用
            paperElement.setAttribute('data-font-size', fontSize);
            
            // 获取所有单元格输入框和内容区域
            const inputElements = paperElement.querySelectorAll('.cell-input');
            const contentAreas = paperElement.querySelectorAll('.paper-content, .editable-content');
            
            // 应用字号到输入框
            inputElements.forEach(input => {
                input.style.fontSize = fontSize;
            });
            
            // 应用字号到其他内容区域
            contentAreas.forEach(area => {
                area.style.fontSize = fontSize;
            });
            
            // 保存到本地存储
            const settings = JSON.parse(localStorage.getItem('paperSettings_' + paperId) || '{}');
            settings.fontSize = fontSize;
            localStorage.setItem('paperSettings_' + paperId, JSON.stringify(settings));
        }
        
        // 应用字号到所有记录纸
        function applyFontSizeToAllPapers(fontSize) {
            if (!fontSize) return;
            
            // 获取所有记录纸
            const allPapers = document.querySelectorAll('.paper');
            
            allPapers.forEach(paper => {
                applyFontSizeToPaper(paper, fontSize);
            });
        }
        
        // 更新UI元素的样式
        function updateUIElementsStyles() {
            const theme = getCurrentTheme();
            const buttons = document.querySelectorAll('.btn');
            const modals = document.querySelectorAll('.modal');
            const recycleBins = document.querySelectorAll('.recycle-bin');
            const mobileRecycleModals = document.querySelectorAll('.mobile-recycle-modal');
            const bgImageOptions = document.querySelectorAll('.bg-image-option');
            const fontOptions = document.querySelectorAll('.font-option');
            
            // 处理背景选项的样式
            bgImageOptions.forEach(option => {
                if (theme === 'dark') {
                    // 暗黑主题下，使用较浅的灰色文字，确保清晰可见但不过于显眼
                    option.style.color = '#a0aec0';
                    // 对于选中状态的选项，可以使用更亮的颜色
                    if (option.classList.contains('selected')) {
                        option.style.color = '#e2e8f0';
                    }
                } else {
                    // 其他主题，移除内联样式
                    option.style.removeProperty('color');
                }
            });
            
            // 处理字体选项的样式
            fontOptions.forEach(option => {
                if (theme === 'dark') {
                    // 暗黑主题下，使用较浅的灰色文字，确保清晰可见但不过于显眼
                    option.style.color = '#a0aec0';
                    // 对于选中状态的选项，可以使用更亮的颜色
                    if (option.classList.contains('selected')) {
                        option.style.color = '#e2e8f0';
                    }
                }
            });

            // 统一处理所有按钮的样式，包括控制栏和侧边栏的菜单按钮
            buttons.forEach(btn => {
                // 先重置所有样式
                btn.style.removeProperty('background-color');
                btn.style.removeProperty('background');
                btn.style.removeProperty('color');
                btn.style.removeProperty('border');
                btn.style.removeProperty('border-color');
                
                // 特殊处理"应用到本记录纸"和"应用到全部"按钮
                const isApplyButton = btn.id.includes('apply-text-color') || 
                                     btn.id.includes('apply-font') || 
                                     btn.id.includes('apply-font-size') || 
                                     btn.id.includes('apply-to') ||
                                     btn.id.includes('apply-bg-color') ||
                                     btn.id.includes('apply-line-style') ||
                                     btn.id.includes('apply-column-style') ||
                                     btn.id.includes('apply-line-color');
                
                // 根据主题设置样式
                if (isApplyButton) {
                    // 对齐设置按钮的样式 - 统一三个主题下的样式
                    if (theme === 'dark') {
                        // 暗黑主题下的特殊样式
                        btn.style.backgroundColor = '#4a5568';
                        btn.style.background = '#4a5568';
                        btn.style.color = '#e2e8f0';
                        btn.style.border = 'none';
                    } else if (theme === 'vibrant') {
                        // 鲜艳主题下的特殊样式
                        btn.style.backgroundColor = '#6666cc';
                        btn.style.background = '#6666cc';
                        btn.style.color = '#ffffff';
                        btn.style.border = 'none';
                    } else if (theme === 'pastel') {
                        // 柔和主题下的特殊样式
                        btn.style.backgroundColor = '#ffc2c2';
                        btn.style.background = '#ffc2c2';
                        btn.style.color = '#6b7280';
                        btn.style.border = 'none';
                    }
                } else if (theme === 'dark') {
                    // 暗黑主题 - 保持原有的灰色系
                    if (btn.classList.contains('btn-primary')) {
                        btn.style.backgroundColor = '#4a5568';
                        btn.style.background = '#4a5568'; // 覆盖任何可能的渐变背景
                    } else if (btn.classList.contains('btn-secondary') || btn.classList.contains('btn-tertiary')) {
                        btn.style.backgroundColor = '#2d3748';
                        btn.style.background = '#2d3748'; // 覆盖任何可能的渐变背景
                        // 为取消按钮添加灰色外框
                        btn.style.border = '1px solid #4a5568';
                        btn.style.borderColor = '#4a5568';
                    }
                    btn.style.color = '#e2e8f0';
                } else if (theme === 'vibrant') {
                    // 鲜艳主题 - 使用鲜艳的颜色方案
                    if (btn.classList.contains('btn-primary')) {
                        btn.style.backgroundColor = '#ff4d4d'; // 鲜艳红色作为主按钮背景
                        btn.style.background = '#ff4d4d'; // 覆盖任何可能的渐变背景
                    } else if (btn.classList.contains('btn-secondary')) {
                        btn.style.backgroundColor = '#4d79ff'; // 鲜艳蓝色作为次要按钮背景
                        btn.style.background = '#4d79ff'; // 覆盖任何可能的渐变背景
                    } else if (btn.classList.contains('btn-tertiary')) {
                        btn.style.backgroundColor = '#ffd166'; // 鲜艳黄色作为第三级按钮背景
                        btn.style.background = '#ffd166'; // 覆盖任何可能的渐变背景
                        btn.style.color = '#333333'; // 深色文字确保可读性
                    } else {
                        btn.style.color = '#ffffff'; // 其他按钮使用白色文字
                    }
                } else if (theme === 'pastel') {
                    if (btn.classList.contains('btn-primary')) {
                        btn.style.backgroundColor = '#ff9e9e';
                        btn.style.background = '#ff9e9e'; // 覆盖任何可能的渐变背景
                    } else if (btn.classList.contains('btn-secondary')) {
                        btn.style.backgroundColor = '#ffd9c0';
                        btn.style.background = '#ffd9c0'; // 覆盖任何可能的渐变背景
                    } else if (btn.classList.contains('btn-tertiary')) {
                        btn.style.backgroundColor = '#fff1d0'; // 柔和黄色作为第三级按钮背景
                        btn.style.background = '#fff1d0'; // 覆盖任何可能的渐变背景
                        btn.style.color = '#6b7280'; // 灰色文字确保可读性
                    } else {
                        btn.style.color = '#6b7280'; // 其他按钮使用灰色文字
                    }
                } else {
                    // 默认主题，移除所有内联样式，包括background属性
                    btn.style.removeProperty('background-color');
                    btn.style.removeProperty('background'); // 移除背景属性，确保恢复默认样式
                    btn.style.removeProperty('color');
                }
            });
            
            modals.forEach(modal => {
                if (theme === 'dark') {
                    modal.querySelector('.modal-content').style.backgroundColor = '#2d3748';
                    modal.querySelector('.modal-content').style.color = '#e2e8f0';
                    
                    // 处理模态框头部
                    const modalHeader = modal.querySelector('.modal-header');
                    if (modalHeader) {
                        modalHeader.style.backgroundColor = '#2d3748';
                        modalHeader.style.color = '#e2e8f0';
                    }
                    
                    // 处理设置标签按钮
                    const tabBtns = modal.querySelectorAll('.tab-btn');
                    tabBtns.forEach(btn => {
                        btn.style.color = '#e2e8f0';
                    });
                    
                    // 处理模态框底部按钮区域
                    const modalActions = modal.querySelector('.modal-actions');
                    if (modalActions) {
                        modalActions.style.backgroundColor = '#2d3748';
                    }
                } else if (theme === 'vibrant') {
                    modal.querySelector('.modal-content').style.backgroundColor = '#ffffff';
                    modal.querySelector('.modal-content').style.color = '#333333';
                    
                    // 处理模态框头部
                    const modalHeader = modal.querySelector('.modal-header');
                    if (modalHeader) {
                        modalHeader.style.backgroundColor = '#ffffff';
                        modalHeader.style.color = '#333333';
                    }
                    
                    // 处理设置标签按钮
                    const tabBtns = modal.querySelectorAll('.tab-btn');
                    tabBtns.forEach(btn => {
                        btn.style.color = '#333333';
                    })
                    
                    // 重置模态框底部按钮区域样式
                    const modalActions = modal.querySelector('.modal-actions');
                    if (modalActions) {
                        modalActions.style.removeProperty('background-color');
                    };
                } else if (theme === 'pastel') {
                    modal.querySelector('.modal-content').style.backgroundColor = '#ffffff';
                    modal.querySelector('.modal-content').style.color = '#6b7280';
                    
                    // 处理模态框头部
                    const modalHeader = modal.querySelector('.modal-header');
                    if (modalHeader) {
                        modalHeader.style.backgroundColor = '#ffffff';
                        modalHeader.style.color = '#6b7280';
                    }
                    
                    // 处理设置标签按钮
                    const tabBtns = modal.querySelectorAll('.tab-btn');
                    tabBtns.forEach(btn => {
                        btn.style.color = '#6b7280';
                    })
                    
                    // 重置模态框底部按钮区域样式
                    const modalActions = modal.querySelector('.modal-actions');
                    if (modalActions) {
                        modalActions.style.removeProperty('background-color');
                    };
                } else {
                    // 默认主题，移除内联样式
                    modal.querySelector('.modal-content').style.removeProperty('background-color');
                    modal.querySelector('.modal-content').style.removeProperty('color');
                    
                    // 处理模态框头部
                    const modalHeader = modal.querySelector('.modal-header');
                    if (modalHeader) {
                        modalHeader.style.removeProperty('background-color');
                        modalHeader.style.removeProperty('color');
                    }
                    
                    // 处理设置标签按钮
                    const tabBtns = modal.querySelectorAll('.tab-btn');
                    tabBtns.forEach(btn => {
                        btn.style.removeProperty('color');
                    })
                    
                    // 重置模态框底部按钮区域样式
                    const modalActions = modal.querySelector('.modal-actions');
                    if (modalActions) {
                        modalActions.style.removeProperty('background-color');
                    };
                }
            });

            // 处理回收站样式
            recycleBins.forEach(recycleBin => {
                if (theme === 'dark') {
                    // 暗黑主题下的回收站样式
                    recycleBin.style.backgroundColor = '#2d3748';
                    recycleBin.style.color = '#e2e8f0';
                    
                    // 处理回收站头部
                    const recycleHeader = recycleBin.querySelector('.recycle-header');
                    if (recycleHeader) {
                        recycleHeader.style.borderBottomColor = '#4a5568';
                        const headerTitle = recycleHeader.querySelector('h3');
                        if (headerTitle) {
                            headerTitle.style.color = '#e2e8f0';
                        }
                    }
                    
                    // 处理回收站内容项
                    const recycleItems = recycleBin.querySelectorAll('.recycle-item');
                    recycleItems.forEach(item => {
                        item.style.backgroundColor = '#1a202c';
                        const titleEl = item.querySelector('.recycle-item-title');
                        const metaEl = item.querySelector('.recycle-item-meta');
                        const dateEl = item.querySelector('.recycle-item-date');
                        
                        if (titleEl) titleEl.style.color = '#e2e8f0';
                        if (metaEl) metaEl.style.color = '#a0aec0';
                        if (dateEl) dateEl.style.color = '#718096';
                    });
                    
                    // 处理记录纸/记录本标签样式 - 暗黑主题
                    const paperTags = recycleBin.querySelectorAll('.recycle-item-type.paper');
                    paperTags.forEach(tag => {
                        tag.style.backgroundColor = '#4a5568';
                        tag.style.color = '#e2e8f0';
                        tag.style.border = '1px solid #4a5568';
                    });
                    
                    const notebookTags = recycleBin.querySelectorAll('.recycle-item-type.notebook');
                    notebookTags.forEach(tag => {
                        tag.style.backgroundColor = '#4a5568';
                        tag.style.color = '#e2e8f0';
                        tag.style.border = '1px solid #4a5568';
                    });
                    
                    // 处理底部边框
                    const recycleFooter = recycleBin.querySelector('.recycle-footer');
                    if (recycleFooter) {
                        recycleFooter.style.borderTopColor = '#4a5568';
                    }
                    
                    // 处理过滤器按钮
                    const filterBtns = recycleBin.querySelectorAll('.filter-btn');
                    filterBtns.forEach(btn => {
                        if (btn.classList.contains('active')) {
                            btn.style.backgroundColor = '#4a5568';
                            btn.style.color = '#e2e8f0';
                        } else {
                            btn.style.backgroundColor = '#1a202c';
                            btn.style.color = '#a0aec0';
                        }
                    });
                } else if (theme === 'vibrant') {
                    // 鲜艳主题下的回收站样式
                    recycleBin.style.removeProperty('background-color');
                    recycleBin.style.removeProperty('color');
                    
                    // 处理回收站头部
                    const recycleHeader = recycleBin.querySelector('.recycle-header');
                    if (recycleHeader) {
                        recycleHeader.style.removeProperty('border-bottom-color');
                        const headerTitle = recycleHeader.querySelector('h3');
                        if (headerTitle) {
                            headerTitle.style.removeProperty('color');
                        }
                    }
                    
                    // 处理回收站内容项
                    const recycleItems = recycleBin.querySelectorAll('.recycle-item');
                    recycleItems.forEach(item => {
                        item.style.removeProperty('background-color');
                        const titleEl = item.querySelector('.recycle-item-title');
                        const metaEl = item.querySelector('.recycle-item-meta');
                        const dateEl = item.querySelector('.recycle-item-date');
                        
                        if (titleEl) titleEl.style.removeProperty('color');
                        if (metaEl) metaEl.style.removeProperty('color');
                        if (dateEl) dateEl.style.removeProperty('color');
                    });
                    
                    // 处理记录纸/记录本标签样式 - 鲜艳主题
                    const paperTags = recycleBin.querySelectorAll('.recycle-item-type.paper');
                    paperTags.forEach(tag => {
                        tag.style.backgroundColor = '#ff6b6b'; // 鲜艳红色
                        tag.style.color = '#ffffff';
                        tag.style.border = '1px solid #ff6b6b';
                    });
                    
                    const notebookTags = recycleBin.querySelectorAll('.recycle-item-type.notebook');
                    notebookTags.forEach(tag => {
                        tag.style.backgroundColor = '#4d79ff'; // 鲜艳蓝色
                        tag.style.color = '#ffffff';
                        tag.style.border = '1px solid #4d79ff';
                    });
                    
                    // 处理底部边框
                    const recycleFooter = recycleBin.querySelector('.recycle-footer');
                    if (recycleFooter) {
                        recycleFooter.style.removeProperty('border-top-color');
                    }
                    
                    // 处理过滤器按钮
                    const filterBtns = recycleBin.querySelectorAll('.filter-btn');
                    filterBtns.forEach(btn => {
                        btn.style.removeProperty('background-color');
                        btn.style.removeProperty('color');
                    });
                } else if (theme === 'pastel') {
                    // 柔和主题下的回收站样式
                    recycleBin.style.removeProperty('background-color');
                    recycleBin.style.removeProperty('color');
                    
                    // 处理回收站头部
                    const recycleHeader = recycleBin.querySelector('.recycle-header');
                    if (recycleHeader) {
                        recycleHeader.style.removeProperty('border-bottom-color');
                        const headerTitle = recycleHeader.querySelector('h3');
                        if (headerTitle) {
                            headerTitle.style.removeProperty('color');
                        }
                    }
                    
                    // 处理回收站内容项
                    const recycleItems = recycleBin.querySelectorAll('.recycle-item');
                    recycleItems.forEach(item => {
                        item.style.removeProperty('background-color');
                        const titleEl = item.querySelector('.recycle-item-title');
                        const metaEl = item.querySelector('.recycle-item-meta');
                        const dateEl = item.querySelector('.recycle-item-date');
                        
                        if (titleEl) titleEl.style.removeProperty('color');
                        if (metaEl) metaEl.style.removeProperty('color');
                        if (dateEl) dateEl.style.removeProperty('color');
                    });
                    
                    // 处理记录纸/记录本标签样式 - 柔和主题
                    const paperTags = recycleBin.querySelectorAll('.recycle-item-type.paper');
                    paperTags.forEach(tag => {
                        tag.style.backgroundColor = '#b9e0ff'; // 柔和蓝色
                        tag.style.color = '#4b5563';
                        tag.style.border = '1px solid #b9e0ff';
                    });
                    
                    const notebookTags = recycleBin.querySelectorAll('.recycle-item-type.notebook');
                    notebookTags.forEach(tag => {
                        tag.style.backgroundColor = '#ffd6b9'; // 柔和橙色
                        tag.style.color = '#4b5563';
                        tag.style.border = '1px solid #ffd6b9';
                    });
                    
                    // 处理底部边框
                    const recycleFooter = recycleBin.querySelector('.recycle-footer');
                    if (recycleFooter) {
                        recycleFooter.style.removeProperty('border-top-color');
                    }
                    
                    // 处理过滤器按钮
                    const filterBtns = recycleBin.querySelectorAll('.filter-btn');
                    filterBtns.forEach(btn => {
                        btn.style.removeProperty('background-color');
                        btn.style.removeProperty('color');
                    });
                } else {
                    // 其他主题，移除内联样式
                    recycleBin.style.removeProperty('background-color');
                    recycleBin.style.removeProperty('color');
                    
                    // 处理回收站头部
                    const recycleHeader = recycleBin.querySelector('.recycle-header');
                    if (recycleHeader) {
                        recycleHeader.style.removeProperty('border-bottom-color');
                        const headerTitle = recycleHeader.querySelector('h3');
                        if (headerTitle) {
                            headerTitle.style.removeProperty('color');
                        }
                    }
                    
                    // 处理回收站内容项
                    const recycleItems = recycleBin.querySelectorAll('.recycle-item');
                    recycleItems.forEach(item => {
                        item.style.removeProperty('background-color');
                        const titleEl = item.querySelector('.recycle-item-title');
                        const metaEl = item.querySelector('.recycle-item-meta');
                        const dateEl = item.querySelector('.recycle-item-date');
                        
                        if (titleEl) titleEl.style.removeProperty('color');
                        if (metaEl) metaEl.style.removeProperty('color');
                        if (dateEl) dateEl.style.removeProperty('color');
                    });
                    
                    // 处理底部边框
                    const recycleFooter = recycleBin.querySelector('.recycle-footer');
                    if (recycleFooter) {
                        recycleFooter.style.removeProperty('border-top-color');
                    }
                    
                    // 处理过滤器按钮
                    const filterBtns = recycleBin.querySelectorAll('.filter-btn');
                    filterBtns.forEach(btn => {
                        btn.style.removeProperty('background-color');
                        btn.style.removeProperty('color');
                    });
                }
            });

            // 处理移动端回收站弹窗样式
            mobileRecycleModals.forEach(modal => {
                if (theme === 'dark') {
                    // 暗黑主题下的移动端回收站弹窗样式
                    const content = modal.querySelector('.mobile-recycle-content');
                    if (content) {
                        content.style.backgroundColor = '#2d3748';
                        content.style.color = '#e2e8f0';
                    }
                    
                    // 处理弹窗头部
                    const header = modal.querySelector('.mobile-recycle-header');
                    if (header) {
                        const headerTitle = header.querySelector('h3');
                        if (headerTitle) {
                            headerTitle.style.color = '#e2e8f0';
                        }
                        
                        const closeBtn = header.querySelector('.mobile-recycle-close');
                        if (closeBtn) {
                            closeBtn.style.color = '#e2e8f0';
                        }
                    }
                    
                    // 处理弹窗内容项
                    const items = modal.querySelectorAll('#mobile-recycle-items .recycle-item');
                    items.forEach(item => {
                        item.style.backgroundColor = '#1a202c';
                        const titleEl = item.querySelector('.recycle-item-title');
                        const metaEl = item.querySelector('.recycle-item-meta');
                        const dateEl = item.querySelector('.recycle-item-date');
                        
                        if (titleEl) titleEl.style.color = '#e2e8f0';
                        if (metaEl) metaEl.style.color = '#a0aec0';
                        if (dateEl) dateEl.style.color = '#718096';
                    });
                    
                    // 处理移动端记录纸/记录本标签样式 - 暗黑主题
                    const mobilePaperTags = modal.querySelectorAll('.recycle-item-type.paper');
                    mobilePaperTags.forEach(tag => {
                        tag.style.backgroundColor = '#4a5568';
                        tag.style.color = '#e2e8f0';
                        tag.style.border = '1px solid #4a5568';
                    });
                    
                    const mobileNotebookTags = modal.querySelectorAll('.recycle-item-type.notebook');
                    mobileNotebookTags.forEach(tag => {
                        tag.style.backgroundColor = '#4a5568';
                        tag.style.color = '#e2e8f0';
                        tag.style.border = '1px solid #4a5568';
                    });
                    
                    // 处理移动端过滤器按钮
                    const filterBtns = modal.querySelectorAll('#mobile-recycle-filter .filter-btn');
                    filterBtns.forEach(btn => {
                        if (btn.classList.contains('active')) {
                            btn.style.backgroundColor = '#4a5568';
                            btn.style.color = '#e2e8f0';
                        } else {
                            btn.style.backgroundColor = '#1a202c';
                            btn.style.color = '#a0aec0';
                        }
                    });
                    
                    // 处理移动端清空回收站按钮
                    const emptyRecycleBtn = modal.querySelector('#mobile-empty-recycle-btn');
                    if (emptyRecycleBtn) {
                        emptyRecycleBtn.style.backgroundColor = '#742a2a'; // 暗黑主题下的暗红色
                        emptyRecycleBtn.style.background = '#742a2a'; // 覆盖任何可能的渐变背景
                        emptyRecycleBtn.style.color = '#e2e8f0'; // 浅色文字确保可读性
                    }
                } else if (theme === 'vibrant') {
                    // 鲜艳主题下的移动端回收站弹窗样式
                    const content = modal.querySelector('.mobile-recycle-content');
                    if (content) {
                        content.style.removeProperty('background-color');
                        content.style.removeProperty('color');
                    }
                    
                    // 处理弹窗头部
                    const header = modal.querySelector('.mobile-recycle-header');
                    if (header) {
                        const headerTitle = header.querySelector('h3');
                        if (headerTitle) {
                            headerTitle.style.removeProperty('color');
                        }
                        
                        const closeBtn = header.querySelector('.mobile-recycle-close');
                        if (closeBtn) {
                            closeBtn.style.removeProperty('color');
                        }
                    }
                    
                    // 处理弹窗内容项
                    const items = modal.querySelectorAll('#mobile-recycle-items .recycle-item');
                    items.forEach(item => {
                        item.style.removeProperty('background-color');
                        const titleEl = item.querySelector('.recycle-item-title');
                        const metaEl = item.querySelector('.recycle-item-meta');
                        const dateEl = item.querySelector('.recycle-item-date');
                        
                        if (titleEl) titleEl.style.removeProperty('color');
                        if (metaEl) metaEl.style.removeProperty('color');
                        if (dateEl) dateEl.style.removeProperty('color');
                    });
                    
                    // 处理移动端记录纸/记录本标签样式 - 鲜艳主题
                    const mobilePaperTags = modal.querySelectorAll('.recycle-item-type.paper');
                    mobilePaperTags.forEach(tag => {
                        tag.style.backgroundColor = '#ff6b6b'; // 鲜艳红色
                        tag.style.color = '#ffffff';
                        tag.style.border = '1px solid #ff6b6b';
                    });
                    
                    const mobileNotebookTags = modal.querySelectorAll('.recycle-item-type.notebook');
                    mobileNotebookTags.forEach(tag => {
                        tag.style.backgroundColor = '#4d79ff'; // 鲜艳蓝色
                        tag.style.color = '#ffffff';
                        tag.style.border = '1px solid #4d79ff';
                    });
                    
                    // 处理移动端过滤器按钮
                    const filterBtns = modal.querySelectorAll('#mobile-recycle-filter .filter-btn');
                    filterBtns.forEach(btn => {
                        btn.style.removeProperty('background-color');
                        btn.style.removeProperty('color');
                    });
                    
                    // 处理移动端清空回收站按钮
                    const emptyRecycleBtn = modal.querySelector('#mobile-empty-recycle-btn');
                    if (emptyRecycleBtn) {
                        emptyRecycleBtn.style.removeProperty('background-color');
                        emptyRecycleBtn.style.removeProperty('background');
                        emptyRecycleBtn.style.removeProperty('color');
                    }
                } else if (theme === 'pastel') {
                    // 柔和主题下的移动端回收站弹窗样式
                    const content = modal.querySelector('.mobile-recycle-content');
                    if (content) {
                        content.style.removeProperty('background-color');
                        content.style.removeProperty('color');
                    }
                    
                    // 处理弹窗头部
                    const header = modal.querySelector('.mobile-recycle-header');
                    if (header) {
                        const headerTitle = header.querySelector('h3');
                        if (headerTitle) {
                            headerTitle.style.removeProperty('color');
                        }
                        
                        const closeBtn = header.querySelector('.mobile-recycle-close');
                        if (closeBtn) {
                            closeBtn.style.removeProperty('color');
                        }
                    }
                    
                    // 处理弹窗内容项
                    const items = modal.querySelectorAll('#mobile-recycle-items .recycle-item');
                    items.forEach(item => {
                        item.style.removeProperty('background-color');
                        const titleEl = item.querySelector('.recycle-item-title');
                        const metaEl = item.querySelector('.recycle-item-meta');
                        const dateEl = item.querySelector('.recycle-item-date');
                        
                        if (titleEl) titleEl.style.removeProperty('color');
                        if (metaEl) metaEl.style.removeProperty('color');
                        if (dateEl) dateEl.style.removeProperty('color');
                    });
                    
                    // 处理移动端记录纸/记录本标签样式 - 柔和主题
                    const mobilePaperTags = modal.querySelectorAll('.recycle-item-type.paper');
                    mobilePaperTags.forEach(tag => {
                        tag.style.backgroundColor = '#b9e0ff'; // 柔和蓝色
                        tag.style.color = '#4b5563';
                        tag.style.border = '1px solid #b9e0ff';
                    });
                    
                    const mobileNotebookTags = modal.querySelectorAll('.recycle-item-type.notebook');
                    mobileNotebookTags.forEach(tag => {
                        tag.style.backgroundColor = '#ffd6b9'; // 柔和橙色
                        tag.style.color = '#4b5563';
                        tag.style.border = '1px solid #ffd6b9';
                    });
                    
                    // 处理移动端过滤器按钮
                    const filterBtns = modal.querySelectorAll('#mobile-recycle-filter .filter-btn');
                    filterBtns.forEach(btn => {
                        btn.style.removeProperty('background-color');
                        btn.style.removeProperty('color');
                    });
                    
                    // 处理移动端清空回收站按钮
                    const emptyRecycleBtn = modal.querySelector('#mobile-empty-recycle-btn');
                    if (emptyRecycleBtn) {
                        emptyRecycleBtn.style.removeProperty('background-color');
                        emptyRecycleBtn.style.removeProperty('background');
                        emptyRecycleBtn.style.removeProperty('color');
                    }
                } else {
                    // 其他主题，移除内联样式
                    const content = modal.querySelector('.mobile-recycle-content');
                    if (content) {
                        content.style.removeProperty('background-color');
                        content.style.removeProperty('color');
                    }
                    
                    // 处理弹窗头部
                    const header = modal.querySelector('.mobile-recycle-header');
                    if (header) {
                        const headerTitle = header.querySelector('h3');
                        if (headerTitle) {
                            headerTitle.style.removeProperty('color');
                        }
                        
                        const closeBtn = header.querySelector('.mobile-recycle-close');
                        if (closeBtn) {
                            closeBtn.style.removeProperty('color');
                        }
                    }
                    
                    // 处理弹窗内容项
                    const items = modal.querySelectorAll('#mobile-recycle-items .recycle-item');
                    items.forEach(item => {
                        item.style.removeProperty('background-color');
                        const titleEl = item.querySelector('.recycle-item-title');
                        const metaEl = item.querySelector('.recycle-item-meta');
                        const dateEl = item.querySelector('.recycle-item-date');
                        
                        if (titleEl) titleEl.style.removeProperty('color');
                        if (metaEl) metaEl.style.removeProperty('color');
                        if (dateEl) dateEl.style.removeProperty('color');
                    });
                    
                    // 处理移动端过滤器按钮
                    const filterBtns = modal.querySelectorAll('#mobile-recycle-filter .filter-btn');
                    filterBtns.forEach(btn => {
                        btn.style.removeProperty('background-color');
                        btn.style.removeProperty('color');
                    });
                }
            });
        }

        // 防抖函数，用于优化频繁调用的操作
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // 创建防抖版的保存函数
        // 保存数据到本地存储
        function saveToLocalStorage() {
            try {
                // 仅保存数据到localStorage作为主存储
                localStorage.setItem('threeGridNotebooks', JSON.stringify(notebooks));
                console.log('数据已成功保存到浏览器本地存储');
            } catch (error) {
                console.error('保存数据失败:', error);
                showToast('数据保存失败，请稍后重试');
            }
        }
        
        // 获取设备自适应的最小高度
        function getDeviceAdaptiveMinHeight() {
            // 获取当前设备类型和屏幕尺寸
            const isMobile = window.matchMedia('(max-width: 768px)').matches;
            const isLandscapeSmall = window.matchMedia('(max-height: 480px) and (orientation: landscape)').matches;
            const isFourColumn = document.querySelector('.paper.selected')?.querySelector('.grid-container.four-column') !== null;
            
            let baseHeight;
            
            // 根据设备和布局类型设置基础高度
            if (isLandscapeSmall) {
                // 横屏小屏设备：1.75rem
                baseHeight = 28; // 1.75rem * 16px/rem = 28px
            } else if (isMobile && isFourColumn) {
                // 移动端四列布局：2.1rem - 1px边框
                baseHeight = 32.6; // (2.1rem * 16px/rem) - 1px = 32.6px
            } else if (isMobile) {
                // 移动端普通布局：2.8125rem
                baseHeight = 45; // 2.8125rem * 16px/rem = 45px
            } else {
                // PC端：2.8125rem
                baseHeight = 45; // 2.8125rem * 16px/rem = 45px
            }
            
            // 根据字体大小进行微调（确保有足够的点击区域）
            const fontSize = parseFloat(getComputedStyle(document.documentElement).fontSize);
            const adjustedHeight = Math.max(baseHeight, fontSize * 1.75); // 最小为字体大小的1.75倍
            
            return Math.round(adjustedHeight);
        }
        
        // 防抖版本的保存函数
        const debouncedSaveToLocalStorage = debounce(function() {
            try {
                // 防抖版本只保存到localStorage，不触发导出
                localStorage.setItem('threeGridNotebooks', JSON.stringify(notebooks));
            } catch (error) {
                console.error('防抖保存数据失败:', error);
            }
        }, 300); // 300毫秒的延迟
        
        // 导出数据到用户选择的路径
        function exportDataToSelectedPath() {
            try {
                // 创建包含所有数据的导出对象
                const exportData = {
                    notebooks: notebooks,
                    recycleBinData: recycleBinData,
                    currentStyle: currentStyle,
                    exportTime: new Date().toISOString()
                };
                
                // 将数据转换为JSON字符串
                const jsonString = JSON.stringify(exportData, null, 2);
                
                // 创建Blob对象
                const blob = new Blob([jsonString], { type: 'application/json' });
                
                // 创建下载链接
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                
                // 设置文件名
                const fileName = `三格记录本数据_${new Date().toLocaleDateString('zh-CN').replace(/\//g, '-')}.json`;
                a.download = fileName;
                
                // 触发下载
                document.body.appendChild(a);
                a.click();
                
                // 清理
                setTimeout(() => {
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 100);
                
                showToast(`数据已导出到: ${fileName}`);
            } catch (error) {
                console.error('导出数据失败:', error);
                showToast('数据导出失败，请稍后重试');
            }
        }

        // 创建新记录纸
        function createNewPaper(title) {
            // 检查是否有记录本
            if (notebooks.length === 0) {
                showToast('请先创建一个记录本');
                return;
            }
            
            const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
            if (!currentNotebook) return;

            // 检测设备类型，PC端默认15行，移动端默认9行
            const isMobile = window.matchMedia('(max-width: 768px)').matches;
            const defaultRows = isMobile ? 9 : 15;

            // 获取当前主题，确保主题优先
            const currentTheme = getCurrentTheme();
            let themeBackgroundColor = '#ffffff'; // 默认白色背景
            
            // 根据当前主题设置相应的背景色
            if (currentTheme === 'dark') {
                themeBackgroundColor = '#2d3748'; // 暗黑主题的记录纸背景色
            } else if (currentTheme === 'pastel') {
                themeBackgroundColor = '#fff7e6'; // 柔和主题的记录纸背景色
            } else if (currentTheme === 'vibrant') {
                themeBackgroundColor = '#90caf9'; // 鲜艳主题的记录纸背景色
            }

            const newPaper = {
                id: Date.now().toString(),
                title: title || `记录纸 ${currentNotebook.papers.length + 1}`,
                date: new Date().toLocaleDateString('zh-CN'),
                data: Array(3).fill().map(() => Array(defaultRows).fill('')),
                style: { 
                    ...currentStyle, 
                    textAlignment: 'center', 
                    backgroundColor: themeBackgroundColor, 
                    backgroundImage: null, 
                    customBackgroundImage: null, // 主题优先，使用当前主题的背景色
                    lineHeights: {} // 存储行高信息，格式：{ rowIndex: height }
                }
            };

            currentNotebook.papers.unshift(newPaper);
            currentNotebook.updatedAt = new Date().toISOString(); // 更新修改时间
            
            // 使用防抖保存，减少频繁读写localStorage
            debouncedSaveToLocalStorage();
            
            // 增量渲染：只添加新记录纸到DOM，不重新渲染所有记录纸
            const newPaperElement = createPaperElement(newPaper);
            const firstPaperElement = papersContainer.firstChild;
            if (firstPaperElement) {
                papersContainer.insertBefore(newPaperElement, firstPaperElement);
            } else {
                papersContainer.appendChild(newPaperElement);
            }
            
            // 设置为当前选中的记录纸
            currentPaperId = newPaper.id;
            
            // 更新选中状态
            document.querySelectorAll('.paper').forEach(p => {
                p.classList.remove('selected');
            });
            newPaperElement.classList.add('selected');
            
            // 更新记录本列表显示的纸张数量
            updateNotebookPaperCount(currentNotebookId);
        }
        
        // 更新记录本显示的纸张数量
        function updateNotebookPaperCount(notebookId) {
            const notebookItem = document.querySelector(`.notebook-item[data-notebook-id="${notebookId}"]`);
            if (notebookItem) {
                const countDiv = notebookItem.querySelector('div[style*="fontSize: 0.85rem"]');
                if (countDiv) {
                    const currentNotebook = notebooks.find(n => n.id === notebookId);
                    if (currentNotebook) {
                        countDiv.textContent = `${currentNotebook.papers.length} 张记录纸`;
                    }
                }
            }
        }
        
        // 创建四格记录纸
        function createFourColumnPaper(title) {
            // 检查是否有记录本
            if (notebooks.length === 0) {
                showToast('请先创建一个记录本');
                return;
            }
            
            const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
            if (!currentNotebook) return;

            // 检测设备类型，PC端默认15行，移动端默认9行
            const isMobile = window.matchMedia('(max-width: 768px)').matches;
            const defaultRows = isMobile ? 9 : 15;

            const newPaper = {
                id: Date.now().toString(),
                title: title || `四格记录 ${currentNotebook.papers.length + 1}`,
                date: new Date().toLocaleDateString('zh-CN'),
                data: Array(4).fill().map(() => Array(defaultRows).fill('')),
                style: { ...currentStyle, textAlignment: 'center', backgroundColor: '#ffffff', backgroundImage: null, customBackgroundImage: null }, // 强制设置居中对齐、白色背景和无背景图片
                isFourColumn: true // 标记为四列记录纸，以便在渲染时识别
            };

            currentNotebook.papers.unshift(newPaper);
            currentNotebook.updatedAt = new Date().toISOString(); // 更新修改时间
            
            // 使用防抖保存，减少频繁读写localStorage
            debouncedSaveToLocalStorage();
            
            // 增量渲染：只添加新记录纸到DOM，不重新渲染所有记录纸
            const newPaperElement = createPaperElement(newPaper);
            const firstPaperElement = papersContainer.firstChild;
            if (firstPaperElement) {
                papersContainer.insertBefore(newPaperElement, firstPaperElement);
            } else {
                papersContainer.appendChild(newPaperElement);
            }
            
            // 设置为当前选中的记录纸
            currentPaperId = newPaper.id;
            
            // 更新选中状态
            document.querySelectorAll('.paper').forEach(p => {
                p.classList.remove('selected');
            });
            newPaperElement.classList.add('selected');
            
            // 更新记录本列表显示的纸张数量
            updateNotebookPaperCount(currentNotebookId);
        }

        // 创建新记录本
        function createNewNotebook(title) {
            const newNotebook = {
                id: Date.now().toString(),
                title: title || `记录本 ${notebooks.length + 1}`,
                papers: [],
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            notebooks.push(newNotebook);
            saveToLocalStorage();
            renderNotebooksList();
            // 始终切换到新创建的记录本
            switchToNotebook(newNotebook.id);
        }

        // 切换到指定记录本 - 优化版
        function switchToNotebook(notebookId) {
            // 防止重复切换到同一个记录本
            if (currentNotebookId === notebookId) return;
            
            currentNotebookId = notebookId;
            
            // 使用防抖来延迟渲染，避免频繁切换时的多次渲染
            debouncedRenderPapers();
            
            // 只更新记录本列表的选中状态，不重新渲染整个列表
            updateNotebooksSelection();
        }
        
        // 只更新记录本列表的选中状态
        function updateNotebooksSelection() {
            document.querySelectorAll('.notebook-item').forEach(item => {
                const id = item.getAttribute('data-notebook-id');
                if (id === currentNotebookId) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }
        
        // 防抖版的renderPapers
        const debouncedRenderPapers = debounce(renderPapers, 50);

        // 渲染所有记录纸 - 优化版
        function renderPapers() {
            const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
            if (!currentNotebook) return;

            // 创建文档片段来减少DOM重排次数
            const fragment = document.createDocumentFragment();

            // 清空容器
            papersContainer.innerHTML = '';

            if (currentNotebook.papers.length === 0) {
                papersContainer.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">还没有记录纸，点击"新建记录纸"开始记录吧！</p>';
                return;
            }

            // 注意：handleCellInput函数已经在外部定义，这里不再重新定义

            // 批量渲染记录纸
            currentNotebook.papers.forEach(paper => {
                const paperElement = createPaperElement(paper, currentNotebook);
                fragment.appendChild(paperElement);
            });

            // 一次性添加到DOM
            papersContainer.appendChild(fragment);

            // 事件监听器已经在DOMContentLoaded中添加，这里不再重复添加
            
            // 记录纸渲染完成后，再次应用主题，确保主题背景色在刷新后也能正确显示
            applyThemeToUI();
        }

        // 创建单个记录纸元素
        function createPaperElement(paper, currentNotebook) {
            const paperElement = document.createElement('div');
            paperElement.className = 'paper';
            paperElement.setAttribute('data-paper-id', paper.id);
            
            // 应用样式设置
            if (paper.style) {
                // 应用背景颜色
                if (paper.style.backgroundColor) {
                    paperElement.style.backgroundColor = paper.style.backgroundColor;
                } else {
                    paperElement.style.backgroundColor = 'transparent'; // 默认无背景
                }
                
                // 移除之前的背景图片类
                paperElement.classList.remove('bg-image-lined', 'bg-image-grid', 'bg-image-dot', 'bg-image-custom');
                paperElement.style.backgroundImage = '';
                
                // 应用背景图片
                if (paper.style.customBackgroundImage) {
                    // 自定义背景图片
                    paperElement.classList.add('bg-image-custom');
                    paperElement.style.backgroundImage = `url(${paper.style.customBackgroundImage})`;
                } else if (paper.style.backgroundImage) {
                    // 预设背景图片类型
                    const bgImageMap = {
                        'lined': 'bg-image-lined',
                        'grid': 'bg-image-grid',
                        'dot': 'bg-image-dot',
                        'speaker': 'bg-image-speaker'
                    };
                    const bgClass = bgImageMap[paper.style.backgroundImage];
                    if (bgClass) {
                        paperElement.classList.add(bgClass);
                    }
                }
                
                // 从本地存储恢复文字颜色和字体设置
                const paperId = paper.id;
                const settings = JSON.parse(localStorage.getItem('paperSettings_' + paperId) || '{}');
                if (settings.textColor) {
                    paperElement.setAttribute('data-text-color', settings.textColor);
                }
                if (settings.fontFamily) {
                    paperElement.setAttribute('data-font-family', settings.fontFamily);
                }
            } else {
                paperElement.style.backgroundColor = 'transparent'; // 默认无背景
            }
            
            // 选中样式
            if (paper.id === currentPaperId) {
                paperElement.classList.add('selected');
            }

            // 记录纸头部
            const header = document.createElement('div');
            header.className = 'paper-header';
            
            // 打印按钮
            const printBtn = document.createElement('button');
            printBtn.className = 'print-btn';
            printBtn.innerHTML = '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>';
            printBtn.title = '导出为图片';
            printBtn.dataset.paperId = paper.id;
            header.appendChild(printBtn);
            
            // 可编辑标题
            const titleElement = createTitleElement(paper);
            header.appendChild(titleElement);
            
            // 日期
            const dateElement = document.createElement('div');
            dateElement.className = 'paper-date';
            dateElement.textContent = paper.date;
            header.appendChild(dateElement);
            
            // 删除按钮
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'delete-btn';
            deleteBtn.innerHTML = '×';
            deleteBtn.title = '删除记录纸';
            header.appendChild(deleteBtn);
            
            paperElement.appendChild(header);

            // 渲染标签
            if (paper.tags && paper.tags.length > 0) {
                const tagsContainer = document.createElement('div');
                tagsContainer.className = 'paper-tags';
                paper.tags.forEach(tag => {
                    const tagSpan = document.createElement('span');
                    tagSpan.className = 'tag';
                    tagSpan.textContent = tag;
                    tagSpan.dataset.tag = tag;
                    tagsContainer.appendChild(tagSpan);
                });
                paperElement.appendChild(tagsContainer);
            }

            // 网格容器
            const gridContainer = document.createElement('div');
            gridContainer.className = paper.isFourColumn ? 'grid-container four-column' : 'grid-container';

            // 创建网格内容
            createGridContent(gridContainer, paper);

            paperElement.appendChild(gridContainer);

            // 创建加号按钮（右下角添加行数按钮）
            const addRowBtn = document.createElement('button');
            addRowBtn.className = 'add-row-btn';
            addRowBtn.innerHTML = '+';
            addRowBtn.title = '增加一行';
            addRowBtn.dataset.paperId = paper.id;
            addRowBtn.style.cssText = `
                position: absolute;
                bottom: 10px;
                right: 10px;
                width: 32px;
                height: 32px;
                border: none;
                border-radius: 50%;
                background-color: var(--success-color);
                color: white;
                font-size: 18px;
                font-weight: bold;
                cursor: pointer;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10;
                transition: all 0.2s ease;
            `;
            addRowBtn.onmouseover = function() {
                this.style.transform = 'scale(1.1)';
                this.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.2)';
            };
            addRowBtn.onmouseout = function() {
                this.style.transform = 'scale(1)';
                this.style.boxShadow = '0 2px 8px rgba(0, 0, 0, 0.15)';
            };
            addRowBtn.onclick = function() {
                const paperId = this.dataset.paperId;
                addRowToPaper(paperId);
            };
            paperElement.appendChild(addRowBtn);

            return paperElement;
        }

        // 创建可编辑标题元素
        function createTitleElement(paper) {
            const titleElement = document.createElement('div');
            titleElement.className = 'paper-title';
            titleElement.textContent = paper.title;
            titleElement.setAttribute('contenteditable', 'false');
            titleElement.dataset.paperId = paper.id;
            
            // 双击标题可编辑 - 将事件处理移至外部委托
            titleElement.setAttribute('data-editable', 'true');
            
            return titleElement;
        }

        // 为记录纸增加一行的函数
        function addRowToPaper(paperId) {
            const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
            if (!currentNotebook) return;
            
            const paper = currentNotebook.papers.find(p => p.id === paperId);
            if (!paper) return;
            
            // 确定记录纸的列数
            const columnCount = paper.isFourColumn ? 4 : 3;
            
            // 确保数据结构存在
            if (!paper.data) paper.data = Array(columnCount).fill().map(() => []);
            
            // 为每一列增加一个空值（即一行）
            for (let colIndex = 0; colIndex < columnCount; colIndex++) {
                if (!paper.data[colIndex]) paper.data[colIndex] = [];
                paper.data[colIndex].push(''); // 添加空字符串作为新行的内容
            }
            
            // 更新记录本的修改时间
            currentNotebook.updatedAt = new Date().toISOString();
            debouncedSaveToLocalStorage();
            
            // 只更新当前记录纸，不重新渲染所有记录纸
            const paperElement = document.querySelector(`.paper[data-paper-id="${paper.id}"]`);
            if (paperElement) {
                const gridContainer = paperElement.querySelector('.grid-container');
                if (gridContainer) {
                    // 清空并重新创建网格内容
                    gridContainer.innerHTML = '';
                    createGridContent(gridContainer, paper);
                }
                
                // 重新应用主题样式，确保使用最新的主题设置
                applyThemeToUI();
            }
        }

        // 创建网格内容
        function createGridContent(gridContainer, paper) {
            // 确定记录纸的列数
            const columnCount = paper.isFourColumn ? 4 : 3;
            
            // 应用样式
            let borderStyle = currentStyle.lineStyle || 'dashed';
            // 考虑当前主题设置线条颜色
                const currentTheme = getCurrentTheme();
                let borderColor;
                if (currentTheme === 'dark') {
                    borderColor = '#718096'; // 暗黑主题的线条颜色
                } else if (currentTheme === 'vibrant') {
                    borderColor = '#FFFFFF'; // 鲜艳主题的线条颜色，设置为纯白色
                } else {
                    borderColor = currentStyle.lineColor || '#000000'; // 其他主题的线条颜色，默认黑色
                }
            
            // 为每一列创建行
            for (let colIndex = 0; colIndex < columnCount; colIndex++) {
                const column = document.createElement('div');
                column.className = 'column';
                
                // 应用列样式
                let columnBorderStyle = currentStyle.columnBorderStyle || 'solid';
                column.style.setProperty('--column-border-style', columnBorderStyle);
                column.style.setProperty('--column-border-color', borderColor);

                // 获取当前列的实际行数
                // 检测设备类型，确保移动设备上默认显示9行，PC端默认显示15行
                const isMobile = window.matchMedia('(max-width: 768px)').matches;
                const defaultRows = isMobile ? 9 : 15;
                const rowCount = paper.data[colIndex]?.length || defaultRows;
                
                // 使用文档片段来减少DOM操作
                const columnFragment = document.createDocumentFragment();
                
                for (let rowIndex = 0; rowIndex < rowCount; rowIndex++) {
                    const gridLine = document.createElement('div');
                    gridLine.className = 'grid-line';
                    
                    // 设置线条样式
                    if (borderStyle === 'double') {
                        gridLine.classList.add('double-line');
                    } else {
                        gridLine.style.borderBottom = `1px ${borderStyle} ${borderColor}`;
                    }
                    
                    gridLine.style.setProperty('--grid-line-color', borderColor);

                    const cellValue = paper.data[colIndex][rowIndex] || '';
                    
                    // 渲染单元格内容
                    if (cellValue.startsWith('<img')) {
                        gridLine.innerHTML = cellValue;
                    } else {
                        // 使用textarea替代input以支持自动换行
                        const input = document.createElement('textarea');
                          input.value = cellValue;
                          // 设置为单行显示，避免默认的多行高度
                          input.rows = 1;
                        // 启用自动换行功能
                        input.style.whiteSpace = 'pre-wrap';
                        input.style.wordWrap = 'break-word';
                        input.style.overflowWrap = 'break-word';
                        input.style.resize = 'none'; // 禁用手动调整大小
                        input.style.overflow = 'hidden'; // 隐藏滚动条
                        
                        // 不设置初始高度，完全使用CSS默认值，确保未换行时保持原有间距
                        
                        // 剪贴板权限状态管理
                          let clipboardPermissionGranted = false;

                          // 安全的剪贴板粘贴处理函数
                          async function handleSecurePaste(event) {
                              try {
                                  // 只有在用户主动粘贴时才请求权限
                                  if (!clipboardPermissionGranted) {
                                      // 请求剪贴板读取权限
                                      const permission = await navigator.permissions.query({name: 'clipboard-read'});
                                      if (permission.state === 'denied') {
                                          console.log('剪贴板权限被拒绝');
                                          return;
                                      }
                                      clipboardPermissionGranted = true;
                                  }

                                  // 读取剪贴板内容
                                  if (navigator.clipboard && navigator.clipboard.readText) {
                                      const clipboardText = await navigator.clipboard.readText();
                                      if (clipboardText.trim()) {
                                          // 将剪贴板内容插入到当前光标位置
                                          const textarea = event.target;
                                          const start = textarea.selectionStart;
                                          const end = textarea.selectionEnd;
                                          const currentValue = textarea.value;
                                          
                                          // 插入文本
                                          textarea.value = currentValue.substring(0, start) + clipboardText + currentValue.substring(end);
                                          
                                          // 设置光标位置
                                          const newCursorPos = start + clipboardText.length;
                                          textarea.setSelectionRange(newCursorPos, newCursorPos);
                                          
                                          // 触发input事件以更新高度
                                          textarea.dispatchEvent(new Event('input', { bubbles: true }));
                                          
                                          // 阻止默认粘贴行为
                                          event.preventDefault();
                                      }
                                  }
                              } catch (error) {
                                  console.log('剪贴板访问失败:', error);
                                  // 如果剪贴板API失败，允许默认粘贴行为
                              }
                          }

                          // 添加粘贴事件监听器（仅在用户主动粘贴时触发）
                          input.addEventListener('paste', handleSecurePaste);

                          // 添加键盘快捷键监听（Ctrl+V）
                          input.addEventListener('keydown', function(event) {
                              if ((event.ctrlKey || event.metaKey) && event.key === 'v') {
                                  // 用户按下Ctrl+V，准备处理粘贴
                                  // paste事件会自动触发handleSecurePaste
                              }
                          });

                          // 添加输入事件监听器，实现同步行高功能
                          input.addEventListener('input', function() {
                            try {
                                // 获取父元素grid-line
                                const gridLine = this.parentElement;
                                
                                if (!gridLine) return;
                                
                                // 获取当前行的索引
                                const rowIndex = parseInt(this.getAttribute('data-row'));
                                
                                // 获取当前纸张元素
                                const paperElement = this.closest('.paper');
                                
                                // 查找同一行的所有grid-line元素
                                const sameRowGridLines = [];
                                if (paperElement && !isNaN(rowIndex)) {
                                    // 获取所有列
                                    const columns = paperElement.querySelectorAll('.column');
                                    columns.forEach(column => {
                                        // 在每一列中查找对应行索引的grid-line
                                        const gridLines = column.querySelectorAll('.grid-line');
                                        if (gridLines[rowIndex]) {
                                            sameRowGridLines.push(gridLines[rowIndex]);
                                        }
                                    });
                                }
                                
                                // 重置当前输入框高度以获取实际内容高度
                                this.style.height = 'auto';
                                const contentHeight = this.scrollHeight;
                                
                                // 获取设备自适应的最小高度
                                const minHeight = getDeviceAdaptiveMinHeight();
                                
                                // 计算一行文本的理论高度（基于字体大小和行高）
                                const computedStyle = window.getComputedStyle(this);
                                const fontSize = parseFloat(computedStyle.fontSize);
                                const lineHeight = parseFloat(computedStyle.lineHeight) || fontSize * 1.4;
                                const paddingTop = parseFloat(computedStyle.paddingTop);
                                const paddingBottom = parseFloat(computedStyle.paddingBottom);
                                const theoreticalLineHeight = lineHeight + paddingTop + paddingBottom;
                                
                                // 判断是否为单行内容
                                const isSingleLine = this.value.trim() !== '' && contentHeight <= theoreticalLineHeight * 1.2;
                                
                                // 如果内容为空，使用最小高度；如果有内容（无论单行还是多行），使用内容高度
                                const targetHeight = this.value.trim() === '' ? minHeight : contentHeight;
                                
                                // 应用到当前输入框和grid-line
                                this.style.height = targetHeight + 'px';
                                gridLine.style.height = targetHeight + 'px';
                                gridLine.style.minHeight = targetHeight + 'px';
                                
                                // 同步调整同一行的其他列，确保高度一致
                                sameRowGridLines.forEach(line => {
                                    if (line !== gridLine) {
                                        const otherInput = line.querySelector('.cell-input');
                                        if (otherInput) {
                                            // 重置其他输入框高度
                                            otherInput.style.height = 'auto';
                                            const otherContentHeight = otherInput.scrollHeight;
                                            const otherMinHeight = getDeviceAdaptiveMinHeight();
                                            
                                            // 计算一行文本的理论高度（基于字体大小和行高）
                                            const computedStyle = window.getComputedStyle(otherInput);
                                            const fontSize = parseFloat(computedStyle.fontSize);
                                            const lineHeight = parseFloat(computedStyle.lineHeight) || fontSize * 1.4;
                                            const paddingTop = parseFloat(computedStyle.paddingTop);
                                            const paddingBottom = parseFloat(computedStyle.paddingBottom);
                                            const theoreticalLineHeight = lineHeight + paddingTop + paddingBottom;
                                            
                                            // 判断是否为单行内容
                                            const isSingleLine = otherInput.value.trim() !== '' && otherContentHeight <= theoreticalLineHeight * 1.2;
                                            
                                            // 如果内容为空，使用最小高度；如果有内容（无论单行还是多行），使用内容高度
                                            const otherTargetHeight = otherInput.value.trim() === '' ? otherMinHeight : otherContentHeight;
                                            
                                            // 如果当前输入框需要更高，同步调整其他列
                                            if (targetHeight > otherTargetHeight) {
                                                otherInput.style.height = targetHeight + 'px';
                                                line.style.height = targetHeight + 'px';
                                                line.style.minHeight = targetHeight + 'px';
                                            }
                                        }
                                    }
                                });
                                
                                // 重新计算整行的最大高度
                                let finalMaxHeight = targetHeight;
                                sameRowGridLines.forEach(line => {
                                    const input = line.querySelector('.cell-input');
                                    if (input) {
                                        // 获取设备自适应的最小高度
                                        const minHeight = getDeviceAdaptiveMinHeight();
                                        
                                        // 计算一行文本的理论高度（基于字体大小和行高）
                                        const computedStyle = window.getComputedStyle(input);
                                        const fontSize = parseFloat(computedStyle.fontSize);
                                        const lineHeight = parseFloat(computedStyle.lineHeight) || fontSize * 1.4;
                                        const paddingTop = parseFloat(computedStyle.paddingTop);
                                        const paddingBottom = parseFloat(computedStyle.paddingBottom);
                                        const theoreticalLineHeight = lineHeight + paddingTop + paddingBottom;
                                    
                                        // 重置高度以获取实际内容高度
                                        const tempHeight = input.style.height;
                                        input.style.height = 'auto';
                                        const contentHeight = input.scrollHeight;
                                        input.style.height = tempHeight; // 恢复原始高度
                                        
                                        // 判断是否为单行内容
                                        const isSingleLine = input.value.trim() !== '' && contentHeight <= theoreticalLineHeight * 1.2;
                                        
                                        // 如果内容为空，使用最小高度；如果有内容（无论单行还是多行），使用实际高度
                                        const inputHeight = input.value.trim() === '' ?
                                            minHeight :
                                            contentHeight;
                                        finalMaxHeight = Math.max(finalMaxHeight, inputHeight);
                                    }
                                });
                                
                                // 确保所有列都有相同的最小高度
                                sameRowGridLines.forEach(line => {
                                    const input = line.querySelector('.cell-input');
                                    if (input) {
                                        input.style.height = finalMaxHeight + 'px';
                                        line.style.height = finalMaxHeight + 'px';
                                        line.style.minHeight = finalMaxHeight + 'px';
                                    }
                                });
                                
                                // 保存行高信息到paper对象
                                if (paperElement && paperElement.style) {
                                    paperElement.style.lineHeights = paperElement.style.lineHeights || {};
                                    paperElement.style.lineHeights[rowIndex] = finalMaxHeight;
                                    // 触发防抖保存
                                    debouncedSaveToLocalStorage();
                                }
                            } catch (error) {
                                // 忽略错误，确保应用正常运行
                                console.log('调整输入框高度时出错:', error);
                            }
                        });
                        
                        // 初始化时不自动调整高度，保持原始样式
                        // 根据单元格位置设置提示文字
                        let placeholderText = '';
                        let paperElement;
                        if (input) {
                            // 获取当前纸张元素
                            paperElement = input.closest('.paper');
                            // 只在示例记录纸中显示占位符文字
                            if (paperElement && paperElement.title === '示例记录纸') {
                            if (colIndex === 0 && rowIndex === 1) placeholderText = '这里可以记录你的灵感、创意和想法';
                            if (colIndex === 1 && rowIndex === 1) placeholderText = '这里可以记录待办事项、计划和目标';
                            if (colIndex === 2 && rowIndex === 1) placeholderText = '这里可以记录反思、总结和收获';
                            if (colIndex === 0 && rowIndex === 3) placeholderText = '💡 点击右下角\"+\"按钮可以添加更多内容';
                            if (colIndex === 1 && rowIndex === 3) placeholderText = '✅ 完成的任务可以标记出来';
                            if (colIndex === 2 && rowIndex === 3) placeholderText = '📚 随时回顾和完善你的思考';
                        }
                        }
                        if (input) {
                            input.placeholder = placeholderText;
                            input.setAttribute('data-col', colIndex);
                            input.setAttribute('data-row', rowIndex);
                            input.classList.add('cell-input');

                            // 应用文本对齐设置
                            const alignment = paperElement && paperElement.style && paperElement.style.textAlignment ? paperElement.style.textAlignment : currentStyle.textAlignment;
                            input.style.textAlign = alignment;
                            
                            // 应用保存的行高信息
                            if (paperElement && paperElement.style && paperElement.style.lineHeights && paperElement.style.lineHeights[rowIndex]) {
                                const savedHeight = paperElement.style.lineHeights[rowIndex];
                                input.style.height = savedHeight + 'px';
                                gridLine.style.height = savedHeight + 'px';
                                gridLine.style.minHeight = savedHeight + 'px';
                            }
                            
                            // 应用文字颜色设置
                            if (paperElement) {
                                const textColor = paperElement.getAttribute('data-text-color');
                                if (textColor) {
                                    input.style.color = textColor;
                                }
                                
                                // 应用字体设置
                                const paperId = paperElement.getAttribute('data-paper-id');
                                const settings = JSON.parse(localStorage.getItem('paperSettings_' + paperId) || '{}');
                                if (settings.fontFamily) {
                                    input.style.fontFamily = settings.fontFamily;
                                }
                                
                                // 应用字号设置
                                if (settings.fontSize) {
                                    input.style.fontSize = settings.fontSize;
                                }
                            }
                            
                            // 第一行特殊样式
                            if (rowIndex === 0 && paperElement && paperElement.data && paperElement.data[colIndex] && paperElement.data[colIndex][0]) {
                                input.style.fontWeight = 'bold';
                            }

                            gridLine.appendChild(input);
                        }
                    }
                    
                    columnFragment.appendChild(gridLine);
                }

                column.appendChild(columnFragment);
                gridContainer.appendChild(column);
            }
        }

        // 事件委托 - 处理记录纸点击
        function handlePaperClick(e) {
            const paperElement = e.target.closest('.paper');
            if (!paperElement) return;
            
            // 避免点击删除按钮或加号按钮时触发选择
            if (e.target.classList.contains('delete-btn') || e.target.classList.contains('add-row-btn')) {
                return;
            }
            
            // 处理标签点击
            if (e.target.classList.contains('tag')) {
                const tag = e.target.dataset.tag;
                if (tag) {
                    searchByTag(tag);
                }
                return;
            }
            
            // 处理标题双击编辑
            if (e.type === 'dblclick' && e.target.classList.contains('paper-title')) {
                // 阻止事件冒泡到document级别，避免全局双击事件的干扰
                e.stopPropagation();
                
                e.target.setAttribute('contenteditable', 'true');
                e.target.focus();
                
                // 选中所有文本
                const range = document.createRange();
                range.selectNodeContents(e.target);
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);
                return;
            }
            
            // 处理标题保存
            if (e.type === 'blur' && e.target.classList.contains('paper-title')) {
                saveTitle(e.target);
                return;
            }
            
            // 处理键盘事件
            if (e.type === 'keydown' && e.target.classList.contains('paper-title')) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    saveTitle(e.target);
                } else if (e.key === 'Escape') {
                    const paperId = e.target.dataset.paperId;
                    const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
                    const paper = currentNotebook.papers.find(p => p.id === paperId);
                    if (paper) {
                        e.target.textContent = paper.title;
                    }
                    e.target.setAttribute('contenteditable', 'false');
                }
                return;
            }
            
            // 普通点击事件 - 设置当前记录纸
            const paperId = paperElement.getAttribute('data-paper-id');
            currentPaperId = paperId;
            
            // 更新记录纸选中状态
            document.querySelectorAll('.paper').forEach(p => {
                p.classList.remove('selected');
            });
            paperElement.classList.add('selected');
        }

        // 事件委托 - 处理容器内输入
        function handleContainerInput(e) {
            if (e.target.classList.contains('cell-input')) {
                // 使用防抖处理单元格输入
                handleCellInput(e.target);
            }
        }

        // 保存标题函数
        function saveTitle(titleElement) {
            const newTitle = titleElement.textContent.trim() || '新记录纸';
            const paperId = titleElement.dataset.paperId;
            
            const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
            if (!currentNotebook) return;
            
            const paper = currentNotebook.papers.find(p => p.id === paperId);
            if (!paper) return;
            
            if (newTitle !== paper.title) {
                paper.title = newTitle;
                // 更新记录本的修改时间
                currentNotebook.updatedAt = new Date().toISOString();
                debouncedSaveToLocalStorage();
            }
            titleElement.setAttribute('contenteditable', 'false');
        }

        // 单元格输入防抖处理
        function handleCellInput(inputElement) {
            const col = parseInt(inputElement.getAttribute('data-col'));
            const row = parseInt(inputElement.getAttribute('data-row'));
            const paperElement = inputElement.closest('.paper');
            const paperId = paperElement.getAttribute('data-paper-id');
            
            const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
            if (!currentNotebook) return;
            
            const paper = currentNotebook.papers.find(p => p.id === paperId);
            if (!paper) return;
            
            // 确保数据结构存在
            if (!paper.data) paper.data = [[], [], []];
            if (!paper.data[col]) paper.data[col] = [];
            
            paper.data[col][row] = inputElement.value;
            
            // 更新记录本的修改时间
            currentNotebook.updatedAt = new Date().toISOString();
            debouncedSaveToLocalStorage();
        }

        // 防抖版的单元格输入处理
        const debouncedCellInputHandler = debounce(handleCellInput, 100);

        // 为所有已存在的事件监听器添加事件委托
        document.addEventListener('DOMContentLoaded', function() {
            // 监听标题双击事件
            papersContainer.addEventListener('dblclick', handlePaperClick);
            // 监听标题失去焦点事件
            papersContainer.addEventListener('blur', handlePaperClick, true);
            // 监听标题键盘事件
            papersContainer.addEventListener('keydown', handlePaperClick, true);
            // 监听单元格输入事件
            papersContainer.addEventListener('input', function(e) {
                if (e.target.classList.contains('cell-input')) {
                    debouncedCellInputHandler(e.target);
                }
            });
            // 监听记录纸点击事件 - 支持移动端选中
            papersContainer.addEventListener('click', handlePaperClick);
            // 移动端触摸事件支持
            papersContainer.addEventListener('touchstart', function(e) {
                // 对于触摸设备，确保点击输入区或记录纸外框时选中记录纸
                const target = e.target;
                const paperElement = target.closest('.paper');
                if (paperElement) {
                    // 阻止事件冒泡，避免触发其他点击事件
                    e.stopPropagation();
                    // 对于输入框和记录纸外框，延迟触发点击事件以确保聚焦输入框
                    if (target.classList.contains('cell-input') || target.classList.contains('paper')) {
                        setTimeout(() => handlePaperClick(e), 50);
                    }
                }
            }, { passive: true });
        });

        // 图片插入功能
        // 打开图片插入模态框
        addImageBtn.addEventListener('click', function() {
            if (!currentPaperId) {
                alert('请先选择一个记录纸');
                return;
            }
            
            // 重置选择
            imageColumnSelect.selectedIndex = 0;
            
            // 清空并重新填充行选项
            imageRowSelect.innerHTML = '';
            for (let i = 0; i < 25; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `第${i + 1}行`;
                imageRowSelect.appendChild(option);
            }
            
            imageUrlInput.value = '';
            imageModal.style.display = 'flex';
        });

        // 确认插入图片
            confirmImageBtn.addEventListener('click', function() {
                if (!currentPaperId) return;
                
                const paper = getCurrentPaper();
                if (!paper) return;
                
                const column = parseInt(imageColumnSelect.value);
                const row = parseInt(imageRowSelect.value);
                const imageUrl = imageUrlInput.value.trim();
                
                if (!imageUrl) {
                    alert('请输入有效的图片URL');
                    return;
                }
                
                // 确保数据结构存在
                if (!paper.data) {
                    paper.data = [[], [], []];
                }
                
                // 设置图片HTML
                paper.data[column][row] = `<img src="${imageUrl}" alt="记录图片" class="image-preview">`;
                
                // 更新记录本的修改时间
                const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
                if (currentNotebook) {
                    currentNotebook.updatedAt = new Date().toISOString();
                }
                
                debouncedSaveToLocalStorage();
                
                // 只更新当前记录纸，不重新渲染所有记录纸
                const paperElement = document.querySelector(`.paper[data-paper-id="${paper.id}"]`);
                if (paperElement) {
                    const gridContainer = paperElement.querySelector('.grid-container');
                    if (gridContainer) {
                        // 清空并重新创建网格内容
                        gridContainer.innerHTML = '';
                        createGridContent(gridContainer, paper);
                    }
                }
                
                imageModal.style.display = 'none';
            });

        // 获取当前选中的记录纸
        function getCurrentPaper() {
            const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
            if (!currentNotebook) return null;
            return currentNotebook.papers.find(p => p.id === currentPaperId);
        }

        // 富文本编辑功能
        // 打开富文本编辑模态框
        richTextEditBtn.addEventListener('click', function() {
            if (!currentPaperId) {
                alert('请先选择一个记录纸');
                return;
            }
            
            // 重置选择
            richTextColumnSelect.selectedIndex = 0;
            
            // 清空并重新填充行选项
            richTextRowSelect.innerHTML = '';
            for (let i = 0; i < 25; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `第${i + 1}行`;
                richTextRowSelect.appendChild(option);
            }
            
            richTextContent.value = '';
            richTextModal.style.display = 'flex';
        });

        // 富文本格式化工具
        formatBoldBtn.addEventListener('click', function() {
            try {
                document.execCommand('bold', false, null);
            } catch (error) {
                // 忽略开发者工具打开时的错误
            }
            richTextContent.focus();
        });

        formatItalicBtn.addEventListener('click', function() {
            try {
                document.execCommand('italic', false, null);
            } catch (error) {
                // 忽略开发者工具打开时的错误
            }
            richTextContent.focus();
        });

        formatUnderlineBtn.addEventListener('click', function() {
            try {
                document.execCommand('underline', false, null);
            } catch (error) {
                // 忽略开发者工具打开时的错误
            }
            richTextContent.focus();
        });

        formatColorSelect.addEventListener('change', function() {
            try {
                document.execCommand('foreColor', false, this.value);
            } catch (error) {
                // 忽略开发者工具打开时的错误
            }
            richTextContent.focus();
        });

        // 确认应用富文本内容
            confirmRichTextBtn.addEventListener('click', function() {
                if (!currentPaperId) return;
                
                const paper = getCurrentPaper();
                if (!paper) return;
                
                const column = parseInt(richTextColumnSelect.value);
                const row = parseInt(richTextRowSelect.value);
                const richText = richTextContent.innerHTML;
                
                // 确保数据结构存在
                if (!paper.data) {
                    paper.data = [[], [], []];
                }
                
                // 保存富文本内容
                paper.data[column][row] = richText;
                
                // 更新记录本的修改时间
                const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
                if (currentNotebook) {
                    currentNotebook.updatedAt = new Date().toISOString();
                }
                
                debouncedSaveToLocalStorage();
                
                // 只更新当前记录纸，不重新渲染所有记录纸
                const paperElement = document.querySelector(`.paper[data-paper-id="${paper.id}"]`);
                if (paperElement) {
                    const gridContainer = paperElement.querySelector('.grid-container');
                    if (gridContainer) {
                        // 清空并重新创建网格内容
                        gridContainer.innerHTML = '';
                        createGridContent(gridContainer, paper);
                    }
                }
                
                richTextModal.style.display = 'none';
            });

        // 删除记录纸功能 - 使用统一的删除确认模态框
            deletePaperBtn.addEventListener('click', function() {
                if (!currentPaperId) return;
                
                showDeleteConfirmModal(
                    '确认删除记录纸',
                    '确定要删除这个记录纸吗？此操作将无法撤销。',
                    function() {
                        const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
                        if (currentNotebook) {
                            // 保存被删除的记录纸ID以便从DOM中移除
                            const deletedPaperId = currentPaperId;
                            
                            currentNotebook.papers = currentNotebook.papers.filter(p => p.id !== currentPaperId);
                            currentNotebook.updatedAt = new Date().toISOString(); // 更新修改时间
                            currentPaperId = null;
                            debouncedSaveToLocalStorage();
                            
                            // 只从DOM中移除被删除的记录纸，不重新渲染所有记录纸
                            const deletedPaperElement = document.querySelector(`.paper[data-paper-id="${deletedPaperId}"]`);
                            if (deletedPaperElement) {
                                deletedPaperElement.remove();
                            }
                            
                            // 如果没有记录纸了，显示空状态提示
                            if (currentNotebook.papers.length === 0) {
                                papersContainer.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">还没有记录纸，点击"新建记录纸"开始记录吧！</p>';
                            }
                            
                            // 更新记录本列表显示的纸张数量
                            updateNotebookPaperCount(currentNotebookId);
                        }
                    }
                );
                
                paperMenuModal.style.display = 'none';
            });

        // 模态框关闭事件
        cancelSyncBtn.addEventListener('click', function() { 
            syncModal.style.display = 'none'; 
            // 恢复原始z-index值，避免影响其他功能
            syncModal.style.zIndex = '1000'; 
        });
        cancelTemplateBtn.addEventListener('click', function() { templateModal.style.display = 'none'; });
        closePaperMenuBtn.addEventListener('click', function() { paperMenuModal.style.display = 'none'; });
        cancelImageBtn.addEventListener('click', function() { imageModal.style.display = 'none'; });
        cancelRichTextBtn.addEventListener('click', function() { richTextModal.style.display = 'none'; });
        cancelTagsBtn.addEventListener('click', function() { tagsModal.style.display = 'none'; });

        // 创建隐藏的文件输入元素用于数据导入
        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.accept = '.json';
        fileInput.style.display = 'none';
        document.body.appendChild(fileInput);

        // 本地备份功能 - 导出所有数据
        function createLocalBackup() {
            if (!notebooks || notebooks.length === 0) {
                alert('没有可导出的数据');
                return;
            }

            // 准备导出所有数据
            const allData = {
                version: '1.0',
                exportTime: new Date().toISOString(),
                data: {
                    threeGridNotebooks: notebooks,
                    recycleBinData: recycleBinData || [],
                    currentStyle: currentStyle || {},
                    threeGridTheme: localStorage.getItem('threeGridTheme') || 'default',
                    skipOrientationPrompt: localStorage.getItem('skipOrientationPrompt') === 'true'
                }
            };

            // 创建并下载文件
            const blob = new Blob([JSON.stringify(allData, null, 2)], { type: 'application/json;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `三格记录本_完整备份_${new Date().toISOString().replace(/[:.]/g, '-').split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            showToast('本地备份创建成功！');
        }

        // 从备份恢复功能
        function handleImportData() {
            const file = fileInput.files[0];
            if (!file) return;

            // 检查文件扩展名
            const fileExtension = file.name.split('.').pop().toLowerCase();
            if (fileExtension !== 'json') {
                alert('请选择正确的JSON格式备份文件');
                return;
            }

            // 读取文件内容
            const reader = new FileReader();
            reader.onload = function(event) {
                processImportData(event.target.result);
            };
            
            reader.onerror = function() {
                alert('文件读取失败');
            };
            
            reader.readAsText(file);
        }
        
        // 处理导入数据的核心函数
        function processImportData(dataStr) {
            try {
                // 解析JSON数据
                const importData = JSON.parse(dataStr);
                
                // 标准化数据格式 - 支持完整版和紧凑版
                let standardData;
                
                // 检查是否是紧凑版格式（二维码分享使用）
                if (importData.v && importData.d) {
                    // 转换紧凑版到标准版
                    standardData = {
                        version: importData.v,
                        data: {
                            threeGridNotebooks: importData.d.n ? importData.d.n.map(compactNotebook => ({
                                id: compactNotebook.i,
                                title: compactNotebook.t,
                                color: compactNotebook.c,
                                coverIndex: compactNotebook.co,
                                createTime: new Date().toISOString(), // 为紧凑版数据添加创建时间
                                updateTime: new Date().toISOString(), // 为紧凑版数据添加更新时间
                                pages: compactNotebook.p ? compactNotebook.p.map(compactPage => ({
                                    id: compactPage.i,
                                    title: compactPage.t,
                                    content: compactPage.c,
                                    createTime: new Date().toISOString(),
                                    updateTime: new Date().toISOString(),
                                    tags: [] // 紧凑版不包含tags
                                })) : []
                            })) : [],
                            threeGridTheme: importData.d.th || 'default'
                        }
                    };
                } else if (importData.version && importData.data) {
                    // 标准版格式（传统备份文件）
                    standardData = importData;
                } else {
                    alert('无效的备份文件格式');
                    return;
                }

                // 显示导入选项
                const mergeOption = confirm('数据导入选项：\n\n[确定] - 合并数据（将保留现有数据并添加新数据）\n\n[取消] - 替换数据（将完全覆盖现有数据）\n\n导入前建议先备份当前数据！');
                
                if (mergeOption) {
                    // 合并数据
                    mergeImportedData(standardData.data);
                } else {
                    // 替换数据
                    replaceImportedData(standardData.data);
                }

                // 重新加载应用数据
                location.reload();
                
                // 显示成功消息
                alert('数据导入成功！');
            } catch (error) {
                // 尝试处理Base64编码的数据（二维码扫描结果）
                try {
                    // 检查是否是base64编码的URL格式
                    if (dataStr.startsWith('data:text/plain;charset=utf-8;base64,')) {
                        const base64Data = dataStr.replace('data:text/plain;charset=utf-8;base64,', '');
                        const decodedData = decodeURIComponent(escape(atob(base64Data)));
                        processImportData(decodedData);
                    } else {
                        // 直接尝试Base64解码
                        const decodedData = decodeURIComponent(escape(atob(dataStr)));
                        processImportData(decodedData);
                    }
                } catch (innerError) {
                    alert('导入失败：文件格式错误或数据损坏');
                    console.error('Import error:', error);
                    console.error('Base64 decode error:', innerError);
                }
            }
        }
        
        // 合并导入的数据
        function mergeImportedData(importData) {
            if (importData.threeGridNotebooks) {
                // 为每个导入的笔记本生成新的ID，避免冲突
                const importedNotebooks = importData.threeGridNotebooks.map(notebook => {
                    const newNotebook = {...notebook};
                    newNotebook.id = generateNotebookId();
                    
                    // 处理记录纸数据 - 支持papers和pages两种属性名
                    if (newNotebook.papers) {
                        newNotebook.papers = newNotebook.papers.map(paper => {
                            const newPaper = {...paper};
                            newPaper.id = generatePaperId();
                            return newPaper;
                        });
                    } else if (newNotebook.pages) {
                        // 兼容优化后的分享数据结构
                        newNotebook.pages = newNotebook.pages.map(page => {
                            const newPage = {...page};
                            newPage.id = generatePaperId();
                            return newPage;
                        });
                    }
                    
                    return newNotebook;
                });
                
                // 合并笔记本
                notebooks = [...notebooks, ...importedNotebooks];
                saveToLocalStorage();
            }
            
            // 其他数据可以选择性合并或提示用户
            if (importData.recycleBinData && importData.recycleBinData.length > 0) {
                if (confirm('是否合并回收站数据？')) {
                    recycleBinData = [...recycleBinData, ...importData.recycleBinData];
                    saveRecycleBinToLocalStorage();
                }
            }
        }
        
        // 替换导入的数据
        function replaceImportedData(importData) {
            if (importData.threeGridNotebooks) {
                notebooks = importData.threeGridNotebooks;
                saveToLocalStorage();
            }
            
            if (importData.recycleBinData) {
                recycleBinData = importData.recycleBinData;
                saveRecycleBinToLocalStorage();
            }
            
            if (importData.currentStyle) {
                currentStyle = importData.currentStyle;
                saveStyleToLocalStorage();
            }
            
            if (importData.threeGridTheme !== undefined) {
                localStorage.setItem('threeGridTheme', importData.threeGridTheme);
            }
            
            if (importData.skipOrientationPrompt !== undefined) {
                localStorage.setItem('skipOrientationPrompt', importData.skipOrientationPrompt ? 'true' : 'false');
            }
        }

        // 为文件输入元素添加事件监听器
        fileInput.addEventListener('change', handleImportData);

        // 获取本地备份与恢复按钮并添加事件监听器
        const localBackupBtn = document.getElementById('local-backup-btn');
        const localRestoreBtn = document.getElementById('local-restore-btn');
        
        if (localBackupBtn) {
            localBackupBtn.addEventListener('click', function() {
                createLocalBackup();
            });
        }
        
        if (localRestoreBtn) {
            localRestoreBtn.addEventListener('click', function() {
                fileInput.value = ''; // 重置文件输入
                fileInput.click(); // 触发文件选择对话框
            });
        }
        
        // 二维码功能 - 生成与扫描
        const generateQrBtn = document.getElementById('generate-qr-btn');
        const scanQrBtn = document.getElementById('scan-qr-btn');
        const qrModal = document.getElementById('qr-modal');
        const scanModal = document.getElementById('scan-modal');
        const cancelQrBtn = document.getElementById('cancel-qr-btn');
        const refreshQrBtn = document.getElementById('refresh-qr-btn');
        const cancelScanBtn = document.getElementById('cancel-scan-btn');
        const qrCodeContainer = document.getElementById('qr-code-container');
        const qrExpireCountdown = document.getElementById('qr-expire-countdown');
        const scannerContainer = document.getElementById('scanner-container');
        const scanningIndicator = document.getElementById('scanning-indicator');
        
        let qrCountdownTimer = null;
        let currentQrCode = null;
        
        // 生成分享二维码
        function generateShareQrCode() {
            // 二维码生成功能已禁用
            showToast('二维码生成功能已禁用');
        }
        
        // 开始二维码倒计时
        function startQrCountdown() {
            // 二维码功能已禁用，此函数不再需要
        }

        // 检测是否为PC端设备
        function detectIsPC() {
            // 优先使用isMobile函数的反向判断，这是更可靠的移动设备检测
            return !isMobile();
        }
        
        // 当用户尝试使用扫描功能时显示友好提示
        function showScanFallbackMessage() {
            // 二维码功能已禁用，此函数不再需要
        }
        
        // 本地备选方案：建议用户下载jsQR库文件到本地 - 已禁用二维码功能，此函数不再需要
        window.showLocalFallbackInstructions = function() {
            // 二维码功能已禁用，此函数不再需要
            showToast('二维码功能已禁用');
        };
        
        // 扫描二维码功能
        function scanQrCode() {
            // 二维码扫描功能已禁用
            showToast('二维码扫描功能已禁用');
        }
        
        // 显示PC端摄像头权限确认对话框
        function showPcCameraPermissionDialog() {
            // 二维码功能已禁用，此函数不再需要
        }
        
        // 继续扫描流程
        function proceedWithScanning() {
            // 二维码功能已禁用，此函数不再需要
        }
        
        // 启动扫描器
        function startScanner() {
            // 二维码功能已禁用，此函数不再需要
        }
        
        // 扫描过程
        function startScanningProcess(video, stream) {
            // 二维码功能已禁用，此函数不再需要
        }
        
        // 处理扫描结果
        function handleScanResult(result) {
            // 二维码功能已禁用，此函数不再需要
        }
        
        // 关闭扫描模态框
        function closeScanModal() {
            // 二维码功能已禁用，此函数不再需要
        }
        
        // 显示手动输入选项
        function showManualInputOption() {
            // 创建手动输入模态框
            const manualInputModal = document.createElement('div');
            manualInputModal.style.position = 'fixed';
            manualInputModal.style.top = '0';
            manualInputModal.style.left = '0';
            manualInputModal.style.width = '100%';
            manualInputModal.style.height = '100%';
            manualInputModal.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
            manualInputModal.style.display = 'flex';
            manualInputModal.style.alignItems = 'center';
            manualInputModal.style.justifyContent = 'center';
            manualInputModal.style.zIndex = '1000';
            manualInputModal.style.padding = '20px';
            
            // 创建对话框
            const dialog = document.createElement('div');
            dialog.style.backgroundColor = 'white';
            dialog.style.borderRadius = '12px';
            dialog.style.padding = '24px';
            dialog.style.width = '100%';
            dialog.style.maxWidth = '400px';
            dialog.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.15)';
            
            // 添加标题
            const title = document.createElement('h3');
            title.textContent = '手动输入数据';
            title.style.color = '#333';
            title.style.margin = '0 0 16px 0';
            title.style.fontSize = '18px';
            
            // 添加说明文字
            const description = document.createElement('p');
            description.innerHTML = '由于网络原因，二维码扫描功能暂时不可用。您可以尝试以下操作：<br><br>1. 手动输入二维码中的内容（通常是一串Base64编码的文本）<br>2. 将二维码图片保存到设备，通过其他二维码扫描应用获取内容后再输入<br><br>提示：Base64编码的文本通常包含字母、数字和+/=等特殊字符。';
            description.style.color = '#666';
            description.style.margin = '0 0 20px 0';
            description.style.fontSize = '14px';
            description.style.lineHeight = '1.5';
            description.style.whiteSpace = 'pre-line';
            
            // 添加文本输入框
            const textarea = document.createElement('textarea');
            textarea.placeholder = '请输入二维码中的内容...';
            textarea.style.width = '100%';
            textarea.style.height = '120px';
            textarea.style.padding = '12px';
            textarea.style.border = '1px solid #ddd';
            textarea.style.borderRadius = '6px';
            textarea.style.fontSize = '14px';
            textarea.style.resize = 'vertical';
            textarea.style.boxSizing = 'border-box';
            
            // 添加按钮容器
            const buttonContainer = document.createElement('div');
            buttonContainer.style.display = 'flex';
            buttonContainer.style.justifyContent = 'flex-end';
            buttonContainer.style.marginTop = '16px';
            buttonContainer.style.gap = '12px';
            
            // 添加取消按钮
            const cancelButton = document.createElement('button');
            cancelButton.textContent = '取消';
            cancelButton.style.padding = '8px 20px';
            cancelButton.style.backgroundColor = '#f5f5f5';
            cancelButton.style.color = '#666';
            cancelButton.style.border = 'none';
            cancelButton.style.borderRadius = '6px';
            cancelButton.style.cursor = 'pointer';
            cancelButton.style.fontSize = '14px';
            cancelButton.onclick = () => {
                document.body.removeChild(manualInputModal);
            };
            
            // 添加确认按钮
            const confirmButton = document.createElement('button');
            confirmButton.textContent = '确认';
            confirmButton.style.padding = '8px 20px';
            confirmButton.style.backgroundColor = '#009688';
            confirmButton.style.color = 'white';
            confirmButton.style.border = 'none';
            confirmButton.style.borderRadius = '6px';
            confirmButton.style.cursor = 'pointer';
            confirmButton.style.fontSize = '14px';
            confirmButton.onclick = () => {
                const inputText = textarea.value.trim();
                if (inputText) {
                    try {
                        // 使用现有的processImportData函数处理输入的数据
                        processImportData(inputText);
                        document.body.removeChild(manualInputModal);
                    } catch (error) {
                        console.error('处理手动输入数据失败:', error);
                        alert('输入的数据格式不正确，请确认输入的是有效的三格记录本数据。');
                    }
                } else {
                    alert('请输入内容后再确认。');
                }
            };
            
            // 组装对话框
            buttonContainer.appendChild(cancelButton);
            buttonContainer.appendChild(confirmButton);
            
            dialog.appendChild(title);
            dialog.appendChild(description);
            dialog.appendChild(textarea);
            dialog.appendChild(buttonContainer);
            
            manualInputModal.appendChild(dialog);
            
            // 添加到页面
            document.body.appendChild(manualInputModal);
        }
        
        // 解码二维码数据演示功能 - 用于开发测试和模拟扫描效果
        function decodeQrCodeDemo() {
            // 二维码功能已禁用，此函数不再需要
            showToast('二维码功能已禁用');
        }
        
        // 关闭二维码模态框
        function closeQrModal() {
            // 二维码功能已禁用，此函数不再需要
        }
        
        // 添加事件监听器 - 已禁用二维码功能，移除相关事件监听
        // if (generateQrBtn) {
        //     generateQrBtn.addEventListener('click', generateShareQrCode);
        // }
        // 
        // if (scanQrBtn) {
        //     scanQrBtn.addEventListener('click', scanQrCode);
        // }
        // 
        // if (cancelQrBtn) {
        //     cancelQrBtn.addEventListener('click', closeQrModal);
        // }
        // 
        // if (cancelScanBtn) {
        //     cancelScanBtn.addEventListener('click', closeScanModal);
        // }
        // 
        // if (refreshQrBtn) {
        //     refreshQrBtn.addEventListener('click', generateShareQrCode);
        // }
        
        // 点击模态框外部关闭 - 已禁用二维码功能，移除相关事件监听
        // window.addEventListener('click', function(event) {
        //     if (event.target === qrModal) {
        //         closeQrModal();
        //     }
        // });

        // 使searchByTag函数可从HTML中访问
        window.searchByTag = searchByTag;

        // 渲染记录本列表 - 优化版
        function renderNotebooksList() {
            // 使用文档片段减少DOM重排次数
            const fragment = document.createDocumentFragment();

            notebooks.forEach(notebook => {
                const notebookItem = document.createElement('div');
                notebookItem.className = `notebook-item ${notebook.id === currentNotebookId ? 'active' : ''}`;
                notebookItem.setAttribute('data-notebook-id', notebook.id);
                
                // 创建记录本标题
                const titleDiv = document.createElement('div');
                titleDiv.style.fontWeight = 'bold';
                titleDiv.textContent = notebook.title;
                
                // 创建记录纸数量显示
                const countDiv = document.createElement('div');
                countDiv.style.fontSize = '0.85rem';
                countDiv.style.color = '#666';
                countDiv.style.marginRight = '25px'; // 往左移动一点，为删除图标留出空间
                countDiv.textContent = `${notebook.papers.length} 张记录纸`;
                
                // 创建删除图标按钮
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'notebook-delete-btn';
                deleteBtn.innerHTML = '🗑️';
                deleteBtn.title = '删除记录本';
                deleteBtn.addEventListener('click', function(e) {
                    e.stopPropagation(); // 阻止事件冒泡，避免触发记录本切换
                    const currentNotebook = notebook;
                    
                    showDeleteConfirmModal(
                        '确认删除记录本',
                        '确定要将这个记录本移至回收站吗？',
                        function() {
                            // 从记录本列表中移除
                            const notebookIndex = notebooks.findIndex(n => n.id === currentNotebook.id);
                            const deletedNotebook = notebooks.splice(notebookIndex, 1)[0];
                              
                            // 添加到回收站
                            const recycleItem = {
                                id: Date.now().toString(),
                                type: 'notebook', // 标记为记录本类型
                                notebook: deletedNotebook,
                                deletedAt: new Date().toLocaleString('zh-CN')
                            };
                            recycleBinData.push(recycleItem);
                              
                            // 保存数据
                            saveToLocalStorage();
                            saveRecycleBinToLocalStorage();
                              
                            // 更新UI
                            renderNotebooksList();
                            updateRecycleBinUI();
                              
                            if (notebooks.length > 0) {
                                switchToNotebook(notebooks[0].id);
                            } else {
                                papersContainer.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">还没有记录本，点击"新建记录本"开始创建吧！</p>';
                                currentNotebookId = null;
                            }
                        }
                    );
                });
                
                // 组织布局
                const rightSection = document.createElement('div');
                rightSection.style.display = 'flex';
                rightSection.style.alignItems = 'center';
                rightSection.appendChild(countDiv);
                rightSection.appendChild(deleteBtn);
                
                notebookItem.appendChild(titleDiv);
                notebookItem.appendChild(rightSection);

                // 不再为每个元素单独添加事件监听器
                fragment.appendChild(notebookItem);
            });

            // 清空容器并一次性添加所有元素
            notebooksContainer.innerHTML = '';
            notebooksContainer.appendChild(fragment);
        }

        // 事件委托 - 处理记录本点击
        function handleNotebookClick(e) {
            const notebookItem = e.target.closest('.notebook-item');
            if (!notebookItem || e.target.classList.contains('notebook-delete-btn')) return;
            
            const notebookId = notebookItem.getAttribute('data-notebook-id');
            switchToNotebook(notebookId);
        }

        // 事件委托 - 处理删除按钮点击
        function handleNotebookDelete(e) {
            if (!e.target.classList.contains('notebook-delete-btn')) return;
            
            e.stopPropagation(); // 阻止事件冒泡，避免触发记录本切换
            const notebookId = e.target.closest('[data-notebook-id]').getAttribute('data-notebook-id');
            const currentNotebook = notebooks.find(n => n.id === notebookId);
            
            if (currentNotebook) {
                showDeleteConfirmModal(
                    '确认删除记录本',
                    '确定要将这个记录本移至回收站吗？',
                    function() {
                        // 从记录本列表中移除
                        const notebookIndex = notebooks.findIndex(n => n.id === currentNotebook.id);
                        const deletedNotebook = notebooks.splice(notebookIndex, 1)[0];
                           
                        // 添加到回收站
                        const recycleItem = {
                            id: Date.now().toString(),
                            type: 'notebook', // 标记为记录本类型
                            notebook: deletedNotebook,
                            deletedAt: new Date().toLocaleString('zh-CN')
                        };
                        recycleBinData.push(recycleItem);
                           
                        // 保存数据
                        saveToLocalStorage();
                        saveRecycleBinToLocalStorage();
                           
                        // 更新UI
                        renderNotebooksList();
                        updateRecycleBinUI();
                           
                        if (notebooks.length > 0) {
                            switchToNotebook(notebooks[0].id);
                        } else {
                            papersContainer.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">还没有记录本，点击"新建记录本"开始创建吧！</p>';
                            currentNotebookId = null;
                        }
                    }
                );
            }
        }

        // 为所有已存在的事件监听器添加事件委托
        document.addEventListener('DOMContentLoaded', function() {
            // 监听记录本容器的点击事件
            notebooksContainer.addEventListener('click', handleNotebookClick);
            // 监听删除按钮点击事件
            notebooksContainer.addEventListener('click', handleNotebookDelete);
            
            // 为移动设备优化二维码扫描功能
            optimizeForMobileScanning();
        });
        
        // 为移动设备优化扫描功能
        function optimizeForMobileScanning() {
            // 检测是否是移动设备
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            
            if (isMobile) {
                // 为移动设备添加扫描相关的CSS样式
                const mobileScanStyle = document.createElement('style');
                mobileScanStyle.textContent = `
                    /* 优化扫描模态框在移动设备上的显示 */
                    #scan-modal {
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: rgba(0, 0, 0, 0.9);
                        z-index: 1000;
                        display: none;
                    }
                    
                    #scanner-container {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        display: flex;
                        flex-direction: column;
                        justify-content: center;
                        align-items: center;
                    }
                    
                    #scan-video {
                        max-width: 100%;
                        max-height: 80vh;
                        object-fit: contain;
                    }
                    
                    #scan-overlay {
                        position: absolute;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                    }
                    
                    /* 适配横屏和竖屏模式 */
                    @media (orientation: landscape) {
                        #scan-frame {
                            width: 250px;
                            height: 250px;
                        }
                        
                        #scan-tip {
                            font-size: 14px;
                            padding: 0 15px;
                        }
                    }
                    
                    @media (orientation: portrait) {
                        #scan-frame {
                            width: 80vw;
                            max-width: 300px;
                            height: 80vw;
                            max-height: 300px;
                        }
                        
                        #scan-tip {
                            font-size: 16px;
                            padding: 0 20px;
                        }
                    }
                `;
                document.head.appendChild(mobileScanStyle);
                
                // 监听屏幕方向变化，优化扫描体验
                window.addEventListener('orientationchange', function() {
                    // 如果扫描模态框正在显示，重新调整尺寸
                    if (scanModal && scanModal.style.display === 'flex') {
                        setTimeout(() => {
                            // 这里可以添加调整扫描区域大小的逻辑
                        }, 300);
                    }
                });
            }
        }

        // 导出记录
        function exportRecords() {
            const currentNotebook = notebooks.find(n => n.id === currentNotebookId);
            if (!currentNotebook || currentNotebook.papers.length === 0) {
                alert('没有可导出的记录');
                return;
            }

            let exportContent = `=== ${currentNotebook.title} ===\n`;
            exportContent += `导出时间: ${new Date().toLocaleString('zh-CN')}\n\n`;

            currentNotebook.papers.forEach((paper, paperIndex) => {
                exportContent += `--- ${paper.title} (${paper.date}) ---
`;
                
                // 找出每一列的最大内容行数
                const maxRows = Math.max(...paper.data.map(col => 
                    col.filter(row => row.trim() !== '').length
                ));
                
                // 逐行导出三列内容
                for (let i = 0; i < maxRows; i++) {
                    const rowContent = paper.data.map(col => col[i] || '').join('\t');
                    exportContent += rowContent + '\n';
                }
                
                exportContent += '\n';
            });

            // 创建Blob并下载
            const blob = new Blob([exportContent], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${currentNotebook.title}_${new Date().toLocaleDateString('zh-CN').replace(/\//g, '-')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // 事件监听
        newPaperBtn.addEventListener('click', function() {
            paperTitle.value = '';
            newPaperModal.querySelector('h3').textContent = '新建记录纸';
            newPaperModal.style.display = 'flex';
        });
        
        // 创建一个临时标志来区分当前是创建哪种记录纸
        let isCreatingFourColumnPaper = false;

        newNotebookBtn.addEventListener('click', function() {
            notebookTitle.value = '';
            newNotebookModal.style.display = 'flex';
        });

        cancelPaperBtn.addEventListener('click', function() {
            newPaperModal.style.display = 'none';
        });

        confirmPaperBtn.addEventListener('click', function() {
            const title = paperTitle.value.trim();
            if (!title) {
                showToast('请输入记录纸标题');
                paperTitle.focus();
                return;
            }
            
            if (isCreatingFourColumnPaper) {
                createFourColumnPaper(title);
                isCreatingFourColumnPaper = false;
            } else {
                createNewPaper(title);
            }
            newPaperModal.style.display = 'none';
        });
        
        cancelPaperBtn.addEventListener('click', function() {
            isCreatingFourColumnPaper = false;
            newPaperModal.style.display = 'none';
        });

        cancelNotebookBtn.addEventListener('click', function() {
            newNotebookModal.style.display = 'none';
        });

        confirmNotebookBtn.addEventListener('click', function() {
            const title = notebookTitle.value.trim();
            if (!title) {
                showToast('请输入记录本标题');
                notebookTitle.focus();
                return;
            }
            createNewNotebook(title);
            newNotebookModal.style.display = 'none';
        });

        // 点击模态框外部关闭
        window.addEventListener('click', function(event) {
            if (event.target === newPaperModal) {
                newPaperModal.style.display = 'none';
            }
            if (event.target === newNotebookModal) {
                newNotebookModal.style.display = 'none';
            }
        });
        
        // 四格记录按钮事件监听
        const sidebarFourColumnBtn = document.getElementById('sidebar-four-column-btn');
        if (sidebarFourColumnBtn) {
            sidebarFourColumnBtn.addEventListener('click', function() {
                paperTitle.value = '';
                newPaperModal.querySelector('h3').textContent = '新建四格记录';
                isCreatingFourColumnPaper = true;
                newPaperModal.style.display = 'flex';
            });
        }
        
        const fourColumnBtn = document.getElementById('four-column-btn');
        if (fourColumnBtn) {
            fourColumnBtn.addEventListener('click', function() {
                paperTitle.value = '';
                newPaperModal.querySelector('h3').textContent = '新建四格记录';
                isCreatingFourColumnPaper = true;
                newPaperModal.style.display = 'flex';
            });
        }

        // 打印按钮点击事件 - 使用事件委托
        papersContainer.addEventListener('click', function(e) {
            if (e.target.closest('.print-btn')) {
                const printBtn = e.target.closest('.print-btn');
                const paperId = printBtn.dataset.paperId;
                exportPaperAsImage(paperId);
            }
        });

        // 导出记录纸为图片
        function exportPaperAsImage(paperId) {
            // 确保全局状态变量已初始化
            if (window.exportCount === undefined) {
                window.exportCount = 0;
            }
            
            // 添加导出状态标记，防止连续点击
            if (window.isExporting) {
                showToast('正在处理上一次导出，请稍候...');
                return;
            }
            window.isExporting = true;
            
            // 增加导出计数
            window.exportCount++;
            
            // 每三次导出后提示用户等待片刻，以避免浏览器限制
            if (window.exportCount % 3 === 0) {
                showToast('已连续导出多张图片，为确保功能正常，请稍等2秒...');
            }
            
            // 立即显示高对比度的加载提示
            const loadingToast = document.createElement('div');
            loadingToast.className = 'export-loading-toast';
            loadingToast.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: #ff3e3e;
                color: white;
                padding: 20px 30px;
                border-radius: 8px;
                font-size: 18px;
                font-weight: bold;
                z-index: 9999;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                text-align: center;
                transition: opacity 0.3s ease;
            `;
            loadingToast.textContent = '正在准备导出...';
            document.body.appendChild(loadingToast);

            // 立即检查并退出全屏模式
            const wasFullscreen = document.fullscreenElement !== null;
            if (wasFullscreen && typeof window.exitFullscreen === 'function') {
                window.exitFullscreen();
                // 显示提示，告知用户正在退出全屏以准备下载
                showToast('正在退出全屏以准备下载...');
            }

            // 查找对应的记录纸元素
            const paperElement = document.querySelector(`.paper[data-paper-id="${paperId}"]`);
            if (!paperElement) {
                alert('未找到记录纸元素');
                window.isExporting = false;
                loadingToast.remove();
                return;
            }

            // 获取记录纸标题作为文件名
            const titleElement = paperElement.querySelector('.paper-title');
            const fileName = titleElement ? titleElement.textContent.trim() : '记录纸';

            // 显示加载提示
            showToast('正在生成图片，请稍候...');

            // 隐藏打印图标和删除图标
            const printBtn = paperElement.querySelector('.print-btn');
            const deleteBtn = paperElement.querySelector('.delete-btn');
            const originalPrintBtnStyle = printBtn ? printBtn.style.display : '';
            const originalDeleteBtnStyle = deleteBtn ? deleteBtn.style.display : '';
            
            if (printBtn) printBtn.style.display = 'none';
            if (deleteBtn) deleteBtn.style.display = 'none';
            
            // 临时将伪元素竖线转换为实际DOM元素，以确保导出图片时竖线位置正确
            const tempVerticalLines = [];
            const columns = paperElement.querySelectorAll('.column:not(:last-child)');
            columns.forEach(column => {
                const verticalLine = document.createElement('div');
                verticalLine.className = 'temp-vertical-line';
                
                // 获取列边框样式和颜色
                const columnBorderStyle = column.style.getPropertyValue('--column-border-style') || 'solid';
                const columnBorderColor = column.style.getPropertyValue('--column-border-color') || '#a0d4e6';
                
                // 设置竖线样式
                verticalLine.style.cssText = `
                    position: absolute;
                    top: 0;
                    right: -20px;
                    height: 100%;
                    width: 1px;
                    background-color: ${columnBorderColor};
                    z-index: 5;
                `;
                
                // 根据边框样式调整
                if (columnBorderStyle === 'dashed') {
                    verticalLine.style.backgroundImage = `repeating-linear-gradient(
                        to bottom,
                        transparent 0px,
                        transparent 19px,
                        ${columnBorderColor} 19px,
                        ${columnBorderColor} 20px
                    )`;
                    verticalLine.style.backgroundColor = 'transparent';
                } else if (columnBorderStyle === 'dotted') {
                    verticalLine.style.backgroundImage = `repeating-linear-gradient(
                        to bottom,
                        transparent 0px,
                        transparent 5px,
                        ${columnBorderColor} 5px,
                        ${columnBorderColor} 6px
                    )`;
                    verticalLine.style.backgroundColor = 'transparent';
                }
                
                // 添加到父元素中
                column.parentNode.appendChild(verticalLine);
                tempVerticalLines.push(verticalLine);
            });

            // 保存所有需要清理的资源引用
            const resourcesToClean = {
                tempElements: [],
                urls: []
            };
            
            // 确保资源清理的函数
            function cleanupResources() {
                // 恢复打印图标和删除图标显示
                if (printBtn) printBtn.style.display = originalPrintBtnStyle;
                if (deleteBtn) deleteBtn.style.display = originalDeleteBtnStyle;
                
                // 移除临时添加的竖线元素
                tempVerticalLines.forEach(line => {
                    if (line && line.parentNode) line.parentNode.removeChild(line);
                });
                
                // 移除所有临时创建的元素
                resourcesToClean.tempElements.forEach(element => {
                    if (element && element.parentNode) {
                        try {
                            element.parentNode.removeChild(element);
                        } catch (e) {
                            console.warn('移除元素失败:', e);
                        }
                    }
                });
                
                // 释放所有创建的URL对象
                resourcesToClean.urls.forEach(url => {
                    try {
                        URL.revokeObjectURL(url);
                    } catch (e) {
                        console.warn('释放URL对象失败:', e);
                    }
                });
                
                // 清空资源列表
                resourcesToClean.tempElements = [];
                resourcesToClean.urls = [];
                
                // 移除加载提示
                if (loadingToast && loadingToast.parentNode) {
                    loadingToast.style.opacity = '0';
                    setTimeout(() => {
                        if (loadingToast.parentNode) {
                            loadingToast.parentNode.removeChild(loadingToast);
                        }
                    }, 300);
                }
                
                // 重置导出状态标记
                window.isExporting = false;
                
                // 每五次导出后重置计数，帮助防止长时间累积的问题
                if (window.exportCount >= 5) {
                    window.exportCount = 0;
                }
            }

            // 使用html2canvas将记录纸转换为图片
            if (typeof html2canvas === 'undefined') {
                console.error('❌ html2canvas库不可用，无法生成图片');
                alert('很抱歉，图片生成功能暂时不可用，请刷新页面重试。');
                cleanupResources();
                return;
            }
            
            // 更新加载提示
            loadingToast.textContent = '正在生成图片...';
            
            html2canvas(paperElement, {
                scale: 2, // 提高图片质量
                useCORS: true, // 允许跨域图片
                logging: false,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                // APP专属的图片下载弹窗
                function showAppDownloadDialog(dataUrl, fileName) {
                    // 创建遮罩层
                    const overlay = document.createElement('div');
                    overlay.style.cssText = `
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: rgba(0,0,0,0.7);
                        z-index: 10000;
                        display: flex;
                        justify-content: center;
                        align-items: center;
                    `;
                    
                    // 创建弹窗
                    const dialog = document.createElement('div');
                    dialog.style.cssText = `
                        background: white;
                        border-radius: 12px;
                        padding: 30px;
                        max-width: 90%;
                        max-height: 90%;
                        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                        text-align: center;
                        position: relative;
                    `;
                    
                    // 创建标题
                    const title = document.createElement('h3');
                    title.textContent = '图片导出成功';
                    title.style.cssText = `
                        margin: 0 0 20px 0;
                        color: #333;
                        font-size: 24px;
                        font-weight: bold;
                    `;
                    
                    // 创建图片预览
                    const img = document.createElement('img');
                    img.src = dataUrl;
                    img.style.cssText = `
                        max-width: 100%;
                        max-height: 300px;
                        object-fit: contain;
                        border: 2px solid #e0e0e0;
                        border-radius: 8px;
                        margin-bottom: 20px;
                    `;
                    
                    // 创建按钮容器
                    const buttonContainer = document.createElement('div');
                    buttonContainer.style.cssText = `
                        display: flex;
                        gap: 15px;
                        justify-content: center;
                        flex-wrap: wrap;
                    `;
                    
                    // 创建下载按钮
                    const downloadBtn = document.createElement('button');
                    downloadBtn.textContent = '下载到本地';
                    downloadBtn.style.cssText = `
                        background: #4CAF50;
                        color: white;
                        border: none;
                        padding: 12px 24px;
                        border-radius: 6px;
                        font-size: 16px;
                        font-weight: bold;
                        cursor: pointer;
                        transition: background 0.3s ease;
                    `;
                    downloadBtn.onmouseover = () => downloadBtn.style.background = '#45a049';
                    downloadBtn.onmouseout = () => downloadBtn.style.background = '#4CAF50';
                    
                    // 创建分享按钮
                    const shareBtn = document.createElement('button');
                    shareBtn.textContent = '分享图片';
                    shareBtn.style.cssText = `
                        background: #2196F3;
                        color: white;
                        border: none;
                        padding: 12px 24px;
                        border-radius: 6px;
                        font-size: 16px;
                        font-weight: bold;
                        cursor: pointer;
                        transition: background 0.3s ease;
                    `;
                    shareBtn.onmouseover = () => shareBtn.style.background = '#1976D2';
                    shareBtn.onmouseout = () => shareBtn.style.background = '#2196F3';
                    
                    // 创建关闭按钮
                    const closeBtn = document.createElement('button');
                    closeBtn.textContent = '关闭';
                    closeBtn.style.cssText = `
                        background: #f44336;
                        color: white;
                        border: none;
                        padding: 12px 24px;
                        border-radius: 6px;
                        font-size: 16px;
                        font-weight: bold;
                        cursor: pointer;
                        transition: background 0.3s ease;
                    `;
                    closeBtn.onmouseover = () => closeBtn.style.background = '#d32f2f';
                    closeBtn.onmouseout = () => closeBtn.style.background = '#f44336';
                    
                    // 添加按钮事件
                    downloadBtn.onclick = () => {
                        // 申请本地存储权限并下载
                        requestStoragePermissionAndDownload(dataUrl, fileName);
                        closeDialog();
                    };
                    
                    shareBtn.onclick = () => {
                        // 分享功能
                        shareImage(dataUrl, fileName);
                        closeDialog();
                    };
                    
                    closeBtn.onclick = closeDialog;
                    
                    // 组装弹窗
                    buttonContainer.appendChild(downloadBtn);
                    buttonContainer.appendChild(shareBtn);
                    buttonContainer.appendChild(closeBtn);
                    
                    dialog.appendChild(title);
                    dialog.appendChild(img);
                    dialog.appendChild(buttonContainer);
                    overlay.appendChild(dialog);
                    
                    // 添加到页面
                    document.body.appendChild(overlay);
                    
                    // 添加到资源清理列表
                    resourcesToClean.tempElements.push(overlay);
                    
                    // 关闭弹窗函数
                    function closeDialog() {
                        if (overlay && overlay.parentNode) {
                            overlay.parentNode.removeChild(overlay);
                        }
                    }
                }
                
                // 申请本地存储权限并下载
                function requestStoragePermissionAndDownload(dataUrl, fileName) {
                    // 检查是否是移动设备
                    const isMobile = /iPhone|iPad|iPod|Android|webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                    
                    if (isMobile) {
                        // 移动设备：显示权限申请说明
                        showPermissionDialog(() => {
                            // 用户同意后执行下载
                            performDownload(dataUrl, fileName);
                        });
                    } else {
                        // 桌面设备：直接下载
                        performDownload(dataUrl, fileName);
                    }
                }
                
                // 显示权限申请说明
                function showPermissionDialog(onGranted) {
                    const permissionOverlay = document.createElement('div');
                    permissionOverlay.style.cssText = `
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: rgba(0,0,0,0.8);
                        z-index: 10001;
                        display: flex;
                        justify-content: center;
                        align-items: center;
                    `;
                    
                    const permissionDialog = document.createElement('div');
                    permissionDialog.style.cssText = `
                        background: white;
                        border-radius: 12px;
                        padding: 25px;
                        max-width: 80%;
                        text-align: center;
                        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    `;
                    
                    permissionDialog.innerHTML = `
                        <h3 style="margin: 0 0 15px 0; color: #333; font-size: 20px;">存储权限申请</h3>
                        <p style="margin: 0 0 20px 0; color: #666; font-size: 16px; line-height: 1.5;">
                            为了将图片保存到您的设备，我们需要访问本地存储权限。
                            请点击允许以确保下载功能正常工作。
                        </p>
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button id="permission-allow" style="
                                background: #4CAF50;
                                color: white;
                                border: none;
                                padding: 10px 20px;
                                border-radius: 6px;
                                font-size: 16px;
                                font-weight: bold;
                                cursor: pointer;
                            ">允许</button>
                            <button id="permission-deny" style="
                                background: #f44336;
                                color: white;
                                border: none;
                                padding: 10px 20px;
                                border-radius: 6px;
                                font-size: 16px;
                                font-weight: bold;
                                cursor: pointer;
                            ">拒绝</button>
                        </div>
                    `;
                    
                    permissionOverlay.appendChild(permissionDialog);
                    document.body.appendChild(permissionOverlay);
                    
                    // 添加事件监听
                    document.getElementById('permission-allow').onclick = () => {
                        document.body.removeChild(permissionOverlay);
                        onGranted();
                    };
                    
                    document.getElementById('permission-deny').onclick = () => {
                        document.body.removeChild(permissionOverlay);
                        showToast('您拒绝了存储权限，无法下载图片');
                    };
                }
                
                // 执行下载
                function performDownload(dataUrl, fileName) {
                    try {
                        const link = document.createElement('a');
                        link.download = fileName;
                        link.href = dataUrl;
                        
                        // 添加到资源清理列表
                        resourcesToClean.tempElements.push(link);
                        
                        document.body.appendChild(link);
                        link.click();
                        
                        // 移除链接元素
                        setTimeout(() => {
                            if (link.parentNode) {
                                link.parentNode.removeChild(link);
                            }
                        }, 100);
                        
                        showToast('图片下载成功！请检查下载文件夹');
                    } catch (e) {
                        console.error('下载失败:', e);
                        showToast('图片下载失败，请重试');
                    }
                }
                
                // 分享图片功能
                function shareImage(dataUrl, fileName) {
                    if (navigator.share) {
                        // 使用Web Share API
                        fetch(dataUrl)
                            .then(res => res.blob())
                            .then(blob => {
                                const file = new File([blob], fileName, { type: 'image/png' });
                                navigator.share({
                                    title: '三格记录本导出图片',
                                    text: '这是我用三格记录本导出的图片',
                                    files: [file]
                                }).then(() => {
                                    showToast('分享成功！');
                                }).catch(err => {
                                    console.error('分享失败:', err);
                                    showToast('分享失败，请重试');
                                });
                            });
                    } else {
                        // 复制图片到剪贴板（需要用户交互）
                        showToast('您的设备不支持直接分享，请手动保存图片后分享');
                    }
                }
                
                // 获取图片数据
                let dataUrl;
                try {
                    // 尝试获取图片数据，如果数据过大则降级处理
                    dataUrl = canvas.toDataURL('image/png');
                    
                    // 检查数据URL大小，如果过大可能在移动设备上出问题
                    if (dataUrl.length > 5 * 1024 * 1024) { // 5MB
                        // 降级处理：降低图片质量
                        dataUrl = canvas.toDataURL('image/jpeg', 0.8);
                    }
                } catch (e) {
                    console.error('获取图片数据失败:', e);
                    showToast('图片生成失败，请重试');
                    cleanupResources();
                    return;
                }
                
                const downloadFileName = `${fileName || '未命名记录纸'}.png`;
                
                // 显示APP专属下载弹窗
                showAppDownloadDialog(dataUrl, downloadFileName);
                
                // 如果之前是全屏模式，提供用户选项恢复全屏
                if (wasFullscreen && typeof document.requestFullscreen === 'function') {
                    // 全屏模式需要用户明确交互才能恢复，添加提示让用户手动点击恢复
                    setTimeout(() => {
                        // 创建一个提示按钮让用户主动点击恢复全屏
                        const fullscreenHint = document.createElement('div');
                        fullscreenHint.className = 'fullscreen-hint';
                        fullscreenHint.style.cssText = `
                            position: fixed;
                            bottom: 20px;
                            right: 20px;
                            background: rgba(0,0,0,0.7);
                            color: white;
                            padding: 10px 15px;
                            border-radius: 20px;
                            font-size: 14px;
                            z-index: 9999;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        `;
                        fullscreenHint.textContent = '恢复全屏模式';
                        fullscreenHint.onclick = function() {
                            try {
                                document.requestFullscreen();
                                this.parentNode.removeChild(this);
                            } catch (e) {
                                console.warn('恢复全屏失败:', e);
                                showToast('无法恢复全屏，请手动点击全屏按钮');
                            }
                        };
                        
                        // 添加到资源清理列表
                        resourcesToClean.tempElements.push(fullscreenHint);
                        document.body.appendChild(fullscreenHint);
                        
                        // 10秒后自动移除提示
                        setTimeout(() => {
                            if (fullscreenHint.parentNode) {
                                fullscreenHint.style.opacity = '0';
                                setTimeout(() => {
                                    if (fullscreenHint.parentNode) {
                                        fullscreenHint.parentNode.removeChild(fullscreenHint);
                                    }
                                }, 300);
                            }
                        }, 10000);
                    }, 3000);
                }
            }).catch(error => {
                console.error('导出图片失败:', error);
                showToast('导出图片失败，请重试');
                cleanupResources();
            });
        }

        // 设置排序功能
        function setupSortToggle() {
            const sortBtn = document.getElementById('sort-toggle-btn');
            const sortOptions = [
                { sortBy: 'createdAt', sortOrder: 'desc', text: '按创建时间排序（最新在前）' },
                { sortBy: 'title', sortOrder: 'asc', text: '按名称A-Z排序' },
                { sortBy: 'title', sortOrder: 'desc', text: '按名称Z-A排序' },
                { sortBy: 'updatedAt', sortOrder: 'desc', text: '按修改时间排序（最新修改在前）' }
            ];
            let currentSortIndex = 0;
            
            // 创建排序选项菜单
            let sortMenu = null;
            
            function toggleSortMenu() {
                if (sortMenu) {
                    // 如果菜单已存在，则移除它
                    document.body.removeChild(sortMenu);
                    sortMenu = null;
                    return;
                }
                
                // 创建菜单元素
                sortMenu = document.createElement('div');
                sortMenu.className = 'sort-menu';
                sortMenu.style.position = 'absolute';
                sortMenu.style.top = `${sortBtn.getBoundingClientRect().bottom + window.pageYOffset}px`;
                sortMenu.style.left = `${sortBtn.getBoundingClientRect().left + window.pageXOffset}px`;
                sortMenu.style.background = 'white';
                sortMenu.style.border = '1px solid var(--border-medium)';
                sortMenu.style.borderRadius = 'var(--radius-small)';
                sortMenu.style.boxShadow = '0 2px 10px rgba(0,0,0,0.1)';
                sortMenu.style.zIndex = '1000';
                sortMenu.style.minWidth = '150px';
                
                // 添加排序选项
                sortOptions.forEach((option, index) => {
                    const optionItem = document.createElement('div');
                    optionItem.className = 'sort-option';
                    optionItem.style.padding = '8px 16px';
                    optionItem.style.cursor = 'pointer';
                    optionItem.style.fontSize = '0.9rem';
                    optionItem.style.borderBottom = index < sortOptions.length - 1 ? '1px solid var(--border-light)' : 'none';
                    optionItem.style.transition = 'background-color 0.1s';
                    
                    if (index === currentSortIndex) {
                        optionItem.style.background = 'var(--bg-light)';
                        optionItem.style.fontWeight = 'bold';
                    }
                    
                    optionItem.textContent = option.text;
                    
                    optionItem.addEventListener('mouseenter', function() {
                        this.style.background = 'var(--bg-light)';
                    });
                    
                    optionItem.addEventListener('mouseleave', function() {
                        if (index !== currentSortIndex) {
                            this.style.background = 'white';
                        }
                    });
                    
                    optionItem.addEventListener('click', function() {
                        currentSortIndex = index;
                        sortNotebooks(option.sortBy, option.sortOrder);
                        document.body.removeChild(sortMenu);
                        sortMenu = null;
                    });
                    
                    sortMenu.appendChild(optionItem);
                });
                
                // 添加到页面
                document.body.appendChild(sortMenu);
                
                // 点击其他地方关闭菜单
                function closeMenu(event) {
                    if (sortMenu && !sortBtn.contains(event.target) && !sortMenu.contains(event.target)) {
                        document.body.removeChild(sortMenu);
                        sortMenu = null;
                        document.removeEventListener('click', closeMenu);
                    }
                }
                
                setTimeout(() => {
                    document.addEventListener('click', closeMenu);
                }, 0);
            }
            
            // 添加点击事件监听
            sortBtn.addEventListener('click', toggleSortMenu);
        }
        
        // 设置视图切换功能
        function setupViewToggle() {
            const toggleBtn = document.getElementById('view-toggle-btn');
            const notebookList = document.getElementById('notebook-list');
            const viewText = toggleBtn.querySelector('span');
            const viewIcon = toggleBtn.querySelector('svg');
            
            // 初始化显示模式
            let isListView = true;
            
            // 切换视图的函数
            function toggleView() {
                isListView = !isListView;
                
                if (isListView) {
                    // 切换到列表视图
                    notebookList.classList.remove('icon-view');
                    notebookList.classList.remove('tile-view');
                    notebookList.classList.add('list-view');
                    viewText.textContent = '列表视图';
                    // 更新图标 - 替换为新的列表视图图标
                    viewIcon.innerHTML = '<line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="18" x2="21" y2="18"></line>';
                } else {
                    // 切换到平铺视图
                    notebookList.classList.remove('list-view');
                    notebookList.classList.remove('icon-view');
                    notebookList.classList.add('tile-view');
                    viewText.textContent = '平铺视图';
                    // 更新图标
                    viewIcon.innerHTML = '<rect x="3" y="3" width="9" height="9"></rect><rect x="15" y="3" width="9" height="9"></rect><rect x="3" y="15" width="9" height="9"></rect><rect x="15" y="15" width="9" height="9"></rect>';
                }
            }
            
            // 添加点击事件监听
            toggleBtn.addEventListener('click', toggleView);
        }
        
        // 初始化视图切换功能
        setupViewToggle();
        
        // 初始化排序功能
        setupSortToggle();
        
        // 初始化应用
        initApp();
        
        // 2秒后显示数据存储提示
        setTimeout(showDataStorageTip, 2000);
        
        // 为背景图片相关功能添加事件监听器
        document.addEventListener('DOMContentLoaded', function() {
            // 监听文件上传变化
            const bgImageUpload = document.getElementById('background-image-upload');
            const bgImagePreview = document.getElementById('background-image-preview');
            const previewImage = document.getElementById('preview-image');
            const removeBgImageBtn = document.getElementById('remove-background-image');
            const bgImageOptions = document.querySelectorAll('.bg-image-option');
            
            if (bgImageUpload) {
                bgImageUpload.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            // 更新预览
                            if (bgImagePreview) {
                                bgImagePreview.style.display = 'block';
                            }
                            if (previewImage) {
                                previewImage.src = event.target.result;
                            }
                            
                            if (removeBgImageBtn) {
                                removeBgImageBtn.style.display = 'block';
                            }
                            
                            // 重置背景图片选项的选中状态
                            bgImageOptions.forEach(option => {
                                option.classList.remove('active');
                            });
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
            
            // 监听移除背景图片按钮点击
            if (removeBgImageBtn) {
                removeBgImageBtn.addEventListener('click', function() {
                    if (bgImagePreview) {
                        bgImagePreview.src = '';
                        bgImagePreview.style.display = 'none';
                    }
                    removeBgImageBtn.style.display = 'none';
                    
                    if (bgImageUpload) {
                        bgImageUpload.value = '';
                    }
                    
                    // 选中无背景选项
                const noBgOption = document.querySelector('.bg-image-option[data-image="none"]');
                if (noBgOption) {
                    bgImageOptions.forEach(option => {
                        option.classList.remove('active');
                    });
                    noBgOption.classList.add('active');
                }
                });
            }
            
            // 监听背景图片选项点击
            bgImageOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // 更新选中状态
                    bgImageOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 隐藏预览和移除按钮
                    if (bgImagePreview) {
                        bgImagePreview.style.display = 'none';
                    }
                    if (removeBgImageBtn) {
                        removeBgImageBtn.style.display = 'none';
                    }
                    if (bgImageUpload) {
                        bgImageUpload.value = '';
                    }
                });
            });
        });
        
        // 显示简单提示的函数
        window.showToast = function(message) {
            // 创建toast计数器（如果不存在）
            if (!window.toastCounter) {
                window.toastCounter = 0;
            }
            window.toastCounter++;
            
            // 创建新的toast元素，使用唯一ID
            const toast = document.createElement('div');
            toast.id = `style-toast-${window.toastCounter}`;
            toast.textContent = message;
            
            // 获取当前已存在的toast数量，用于计算垂直位置
            const existingToasts = document.querySelectorAll('[id^="style-toast-"]');
            const verticalOffset = existingToasts.length * 45; // 每个toast间距45px
            
            toast.style.cssText = `
                position: fixed;
                bottom: calc(20% + ${verticalOffset}px);
                left: 50%;
                transform: translateX(-50%);
                background: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 8px 16px;
                border-radius: 4px;
                font-size: 1rem;
                z-index: 1002;
                pointer-events: none;
                opacity: 1;
                transition: opacity 0.3s ease, bottom 0.3s ease;
            `;
            
            document.body.appendChild(toast);
            
            // 2秒后淡出并移除toast
            setTimeout(() => {
                if (document.body.contains(toast)) {
                    toast.style.opacity = '0';
                    
                    // 淡出动画后重新计算其他toast位置
                    setTimeout(() => {
                        if (document.body.contains(toast)) {
                            document.body.removeChild(toast);
                        }
                        
                        // 更新剩余toast的位置
                        const remainingToasts = document.querySelectorAll('[id^="style-toast-"]');
                        remainingToasts.forEach((t, index) => {
                            t.style.bottom = `calc(20% + ${index * 45}px)`;
                        });
                    }, 300);
                }
            }, 2000);
        };
        // 数据存储提示模态框相关函数
        function showDataStorageTip() {
            const dataStorageModal = document.getElementById('data-storage-modal');
            if (dataStorageModal) {
                dataStorageModal.style.display = 'flex';
            }
        }
        
        function hideDataStorageTip() {
            const dataStorageModal = document.getElementById('data-storage-modal');
            if (dataStorageModal) {
                dataStorageModal.style.display = 'none';
            }
        }
    </script>
    
    <!-- 数据存储提示模态框 -->
    <div id="data-storage-modal" class="modal">
        <div class="modal-content">
            <div style="text-align: center; margin-bottom: 20px;">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" fill="#dbeafe"/>
                    <path d="M12 16V12M12 8H12.01" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <h3 style="text-align: center; margin-bottom: 15px;">数据存储提示</h3>
            <p style="text-align: center; margin-bottom: 25px;">本应用数据存于浏览器，若需清理浏览器缓存，请先备份本应用数据。</p>
            <div style="text-align: center;">
                <button onclick="hideDataStorageTip()" style="background-color: #3b82f6; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 16px;">
                    我知道了
                </button>
            </div>
        </div>
    </div>
</body>
</html>







